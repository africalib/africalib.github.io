import{d as T,g as y,c as a,b as s,F as S,r as P,t as q,u as g,o as n,_ as E,n as R,i as U,h as N,j as X,k as I,f as $,l as M,T as ae,m as Z,p as j,q as re,s as Y,v as ee,w as le,x as ce,y as ie,z as F,A as ue,B,C as H,D as K,E as te}from"./index-BQvWMD0p.js";import{u as z,M as J}from"./material-BbhXOtrS.js";import{c as x}from"./commonLib-Co9BQnS0.js";import{C as de}from"./CryptoHelper-m6j8gmxG.js";import{_ as me,a as pe,b as _e}from"./common.arrow.left-TSorRx6s.js";import{r as ve}from"./routeLib-DhAZaWiT.js";import{A as he}from"./Above-CORcjFmO.js";import"./Panel-XlNPftIU.js";const fe={class:"common-sources"},ge={class:"items"},ye=["innerHTML"],ke=T({__name:"MaterialSources",props:{sources:{}},setup(h){const t=h,l=y(()=>{const p=new Map;return t.sources.forEach((r,i)=>{p.has(r)||p.set(r,[]),p.get(r).push(i+1)}),Array.from(p.entries()).map(([r,i])=>({indexes:i,src:r}))});return(p,r)=>(n(),a("div",fe,[r[1]||(r[1]=s("div",{class:"subject"},"자료 출처",-1)),s("div",ge,[(n(!0),a(S,null,P(l.value,i=>(n(),a("div",{class:"item",key:i.src},[(n(!0),a(S,null,P(i.indexes,v=>(n(),a("span",null,"["+q(v)+"]",1))),256)),r[0]||(r[0]=s("span",null," ",-1)),s("span",{innerHTML:g(x).linkify(i.src)},null,8,ye)]))),128))])]))}}),se=E(ke,[["__scopeId","data-v-a34ac84b"]]),$e={class:"common-references"},be={class:"items"},we={class:"item"},xe=T({__name:"MaterialReferences",props:{references:{}},setup(h){const t=h;return(l,p)=>(n(),a("div",$e,[p[0]||(p[0]=s("div",{class:"subject"},"참고 자료",-1)),s("div",be,[(n(!0),a(S,null,P(t.references,r=>(n(),a("div",we,[s("span",null,q(r),1)]))),256))])]))}}),ne=E(xe,[["__scopeId","data-v-64c8b31c"]]),Me={key:0},Te=["innerHTML"],Le=T({__name:"DocumentContent",props:{document:{},skeleton:{type:Boolean}},setup(h){const t=h;return(l,p)=>(n(),a("div",{class:R(["document-content",{skeleton:t.skeleton}])},[l.skeleton?(n(),a("div",Me)):(n(),a("div",{key:1,innerHTML:t.document,ref:"contentRef"},null,8,Te))],2))}}),oe=E(Le,[["__scopeId","data-v-9c772213"]]),Se="/assets/images/component.document.presentation.slide.first.svg",Ee="/assets/images/component.material.presentation.finish.svg",O=T({__name:"DocumentPrompt",props:{content:{}},setup(h){const t=h;return U(()=>{console.info(t.content.replace(/\n{3,}/g,`

`))}),(l,p)=>null}}),Ae={class:"slides"},Ce={key:0,class:"slide start"},De={class:"container"},Ie={class:"slide-item"},qe=["innerHTML"],He={key:1,class:"slide finish"},Pe={class:"container"},Re={key:0,class:"slide"},Ne={class:"container"},Q="no-overflow",je=T({__name:"MaterialPresentation",props:{material:{},document:{},skeleton:{type:Boolean}},setup(h){const t={touchStartX:0,touchStartY:0},l=h,p=N(),r=Z(),i=`이렇게 해서 ${x.extractText(l.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,v=y(()=>l.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),o=y(()=>{const d=[l.material.desc];return c.value.length===0&&e.value.length===1&&d.push(e.value[0]),d.join("")}),c=y(()=>{const d=new DOMParser().parseFromString(l.document,"text/html");return Array.from(d.querySelectorAll(".slide-item")).map(m=>m.outerHTML)}),e=y(()=>{const d=[],m={},w=new DOMParser().parseFromString(l.document,"text/html");Array.from(w.querySelectorAll(".slide-text")).forEach(L=>{const D=L.getAttribute("data-slide-text-group");D&&(!m[D]&&(m[D]=[]),m[D].push(x.replaceAll(L.outerText,"  ","").trim()))});for(let L in m)d.push(m[L].join(`
`));return d}),u=y(()=>{var d;return window.Number.parseInt(((d=p.query.idx)==null?void 0:d.toString())||"0")}),f=y(()=>c.value.length+1),b=d=>{const m=x.renew(p.query);let w=u.value+d;w<0?w=0:w>f.value&&(w=f.value),u.value!==w&&(m.idx=w.toString(),r.push({query:m}))},_=(d,m)=>{switch(d){case"ArrowLeft":!m&&b(-1);break;case"ArrowRight":!m&&b(1);break;case"F9":case"Escape":!m&&r.push({query:void 0});break}},k=d=>{_(d.key,d.altKey)},A=d=>{const m=d.touches[0];t.touchStartX=m.clientX,t.touchStartY=m.clientY},C=d=>{const m=d.changedTouches[0],w=m.clientX,G=m.clientY,L=w-t.touchStartX,D=G-t.touchStartY;Math.abs(L)>Math.abs(D)&&Math.abs(L)>50&&(L>0?b(-1):b(1))},V=d=>{d.data.type==="keyup"&&_(d.data.key,d.data.altKey)};return U(()=>{document.addEventListener("keyup",k),document.addEventListener("touchstart",A),document.addEventListener("touchend",C),window.addEventListener("message",V),document.body.classList.add(Q)}),X(()=>{document.removeEventListener("keyup",k),document.removeEventListener("touchstart",A),document.removeEventListener("touchend",C),window.removeEventListener("message",V),document.body.classList.remove(Q)}),(d,m)=>(n(),I(ae,{to:"body"},[s("div",{class:R(["presentation",{skeleton:l.skeleton}])},[s("div",Ae,[u.value===0?(n(),a("div",Ce,[s("div",De,[s("figure",Ie,[m[0]||(m[0]=s("img",{src:Se,alt:"코딩",loading:"lazy"},null,-1)),s("figcaption",null,[s("span",{innerHTML:v.value},null,8,qe),$(O,{content:o.value},null,8,["content"])])])])])):u.value===f.value?(n(),a("div",He,[s("div",Pe,[m[1]||(m[1]=s("figure",{class:"slide-item"},[s("img",{src:Ee,alt:"하이파이브",class:"mh-400",loading:"lazy"}),s("figcaption",null,[s("b",null,"이상 끝. "),s("span",null,"수고하셨습니다!")])],-1)),l.material.sources.length?(n(),I(se,{key:0,class:"w-100 mb-3",sources:l.material.sources},null,8,["sources"])):M("",!0),l.material.references.length?(n(),I(ne,{key:1,class:"w-100",references:l.material.references},null,8,["references"])):M("",!0),$(O,{content:i})])])):(n(!0),a(S,{key:2},P(c.value.length,w=>(n(),a(S,null,[u.value===w?(n(),a("div",Re,[s("div",Ne,[$(oe,{document:c.value[w-1]},null,8,["document"]),$(O,{content:e.value[w-1]||""},null,8,["content"])])])):M("",!0)],64))),256))])],2)]))}}),Fe=E(je,[["__scopeId","data-v-328f90a8"]]);function Be(){const h=j(null),t=j(null),l=j(!1);return{data:h,error:t,loading:l,request:async({url:r,method:i="GET",body:v,contentType:o="application/json",...c})=>{l.value=!0,t.value=null;try{const e={"Content-Type":o,...c.headers||{}},u={method:i,headers:e,...c};v&&(u.body=o==="application/json"?JSON.stringify(v):v);const f=await fetch(r,u);if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);const b=f.headers.get("Content-Type");return b!=null&&b.includes("application/json")?h.value=await f.json():h.value=await f.text(),h.value}catch(e){throw t.value=e.message||"Unknown error",e}finally{l.value=!1}}}}const Oe={key:0,class:"presentation"},Ue={key:1,class:"content"},Xe={key:1,class:"empty"},Ye=T({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(h){const t=N(),l=re();Y();const p=z(t),{data:r,loading:i,request:v}=Be(),o=h,c=ee({document:"<p>PLEASE WAIT A MOMENT</p>"}),e=()=>{if(!o.material.sources.length)return;const f=new DOMParser().parseFromString(c.document,"text/html");Array.from(f.querySelectorAll("[data-bs-toggle='popover']")).forEach((_,k)=>{if(!o.material.sources[k]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}_.setAttribute("title","자료 출처"),_.setAttribute("data-bs-content",x.linkify(o.material.sources[k])),_.innerText=`[${k+1}]`}),c.document=f.body.innerHTML},u=async()=>{if(o.material){const f=p.getUrlPath(o.material);await v({url:`/assets${f}/document.html?${Date.now()}`,contentType:"text/html"});const b=ie.get(F.unlockPasswordCookieName),_=window.location.hostname==="localhost";if(o.material.locked&&b&&!_){const k=new de(b,F.salt,F.iv);r.value=await k.decrypt(r.value).catch(A=>(console.error({err:A,message:"문서를 복호화 할 수 없습니다."}),null))}c.document=x.linkify(r.value),e()}ue(()=>{o.onDocumentLoaded()}),l.updateSiteTitle(x.extractText(o.material.title))};return le(()=>{u()}),X(()=>{l.updateSiteTitle()}),ce(()=>t.path,()=>{u()}),(f,b)=>(n(),a("div",{class:R(["material-core",{skeleton:g(i)}])},[g(t).query.mode==="presentation"?(n(),a("div",Oe,[$(Fe,{material:o.material,document:c.document,skeleton:g(i)},null,8,["material","document","skeleton"])])):(n(),a("div",Ue,[c.document?(n(),I(oe,{key:0,document:c.document,skeleton:g(i)},null,8,["document","skeleton"])):(n(),a("div",Xe,"이 문서에는 내용이 없습니다."))]))],2))}}),Ke=E(Ye,[["__scopeId","data-v-dcce87a2"]]),ze={class:"wrapper"},Ve={class:"title"},Ge={class:"title"},Je=T({__name:"MaterialNavigation",props:{material:{}},setup(h){const t=h,l=N();Y(),z(l);const p=B(()=>{var o,c;const v=[];if((c=(o=t.material)==null?void 0:o.parent)!=null&&c.children){const e=ve.getTag(l);t.material.parent.children.forEach(u=>{(!e||u.tags.includes(e))&&v.push(u)})}return v}),r=B(()=>{var c;let v=null;const o=p.value;for(let e=0;e<o.length;e++)if(o[e].id===((c=t.material)==null?void 0:c.id)&&o[e-1]){v=o[e-1];break}return v}),i=B(()=>{var c;let v=null;const o=p.value;for(let e=0;e<o.length;e++)if(o[e].id===((c=t.material)==null?void 0:c.id)&&o[e+1]){v=o[e+1];break}return v});return(v,o)=>{const c=K("router-link");return n(),a("div",{class:R(["material-navigation",{both:g(r)&&g(i)}])},[s("div",ze,[g(r)?(n(),I(c,{key:0,to:g(r).url||"",class:"item prev",title:g(r).title},{default:H(()=>[o[0]||(o[0]=s("div",{class:"label"},[s("img",{src:me,alt:"이전"}),s("span",null,"이전")],-1)),s("div",Ve,q(g(x).extractText(g(r).title)),1)]),_:1},8,["to","title"])):M("",!0),g(i)?(n(),I(c,{key:1,to:g(i).url,class:"item next",title:g(i).title},{default:H(()=>[o[1]||(o[1]=s("div",{class:"label"},[s("img",{src:pe,alt:"다음"}),s("span",null,"다음")],-1)),s("div",Ge,q(g(x).extractText(g(i).title)),1)]),_:1},8,["to","title"])):M("",!0)])],2)}}}),Qe=E(Je,[["__scopeId","data-v-edc97d56"]]),We={class:"material-above"},Ze={class:"back"},et={class:"wrapper"},tt={class:"dates"},st=["title"],W="?mode=presentation",nt=T({__name:"MaterialAbove",props:{material:{}},setup(h){const t=h,l=Z(),p=(e,u)=>{e==="F9"&&!u&&l.push(W)},r=e=>{p(e.key,e.altKey)},i=y(()=>{const e={title:"강의 자료",url:"/materials"};return t.material.parent&&(e.title=t.material.parent.title,e.url=t.material.parent.url),e}),v=y(()=>t.material.created?t.material.updated?x.getHumanReadableDate(t.material.updated)+" 업데이트됨":x.getHumanReadableDate(t.material.created)+" 생성됨":"(N/A)"),o=y(()=>{if(t.material.created){const e=[`생성: ${t.material.created}`];return t.material.updated&&e.push(`업데이트: ${t.material.created}`),e.join(" | ")}}),c=e=>{e.data.type==="keyup"&&p(e.data.key,e.data.altKey)};return U(()=>{document.addEventListener("keyup",r),window.addEventListener("message",c)}),X(()=>{document.removeEventListener("keyup",r),window.removeEventListener("message",c)}),(e,u)=>{const f=K("router-link");return n(),a("div",We,[s("div",Ze,[$(f,{to:i.value.url},{default:H(()=>[u[0]||(u[0]=s("img",{src:_e,alt:"뒤로가기",title:"뒤로가기"},null,-1)),s("span",null,q(i.value.title),1)]),_:1},8,["to"])]),s("div",et,[s("div",tt,[s("span",{title:o.value},q(v.value),9,st),t.material.presentation?(n(),a(S,{key:0},[u[2]||(u[2]=s("span",{class:"bar"},null,-1)),$(f,{to:W},{default:H(()=>u[1]||(u[1]=[te("발표(F9)")])),_:1})],64)):M("",!0)]),$(he,{title:g(x).extractText(t.material.title),desc:t.material.desc},null,8,["title","desc"])])])}}}),ot=E(nt,[["__scopeId","data-v-fc9f20d5"]]),at={class:"material"},rt={class:"container"},lt={class:"above",ref:"aboveRef"},ct={key:0,class:"list"},it={key:1,class:"detail"},ut={class:"main",ref:"mainRef"},dt={class:"core",ref:"coreRef"},mt={key:0,class:"sources"},pt={key:1,class:"references"},_t={key:1,class:"empty"},vt={key:2,class:"login"},ht={class:"navigation"},ft={key:0,class:"materials",ref:"materialsRef"},gt={key:1,class:"empty"},yt=T({__name:"MaterialDetail",setup(h){const t=N(),l=Y(),p=z(t),r=ee({contentLoaded:!1}),i=y(()=>{var _;return!((_=e.value)!=null&&_.locked)||l.admin}),v=y(()=>{var _;return(_=t.params.id1)==null?void 0:_.toString()}),o=y(()=>{var _;return(_=t.params.id2)==null?void 0:_.toString()}),c=y(()=>{var _;return(_=t.params.id3)==null?void 0:_.toString()}),e=y(()=>p.get(v.value,o.value,c.value)),u=y(()=>{var _,k;return((k=(_=e.value)==null?void 0:_.parent)==null?void 0:k.children)||[]}),f=y(()=>{if(t.query.tag)return window.decodeURIComponent(t.query.tag.toString())}),b=()=>{r.contentLoaded=!0};return(_,k)=>{var C;const A=K("router-link");return n(),a("div",at,[s("div",rt,[e.value?(n(),a(S,{key:0},[s("div",lt,[$(ot,{material:e.value},null,8,["material"])],512),e.value.children.length?(n(),a("div",ct,[$(J,{materials:e.value.children,tag:f.value},null,8,["materials","tag"])])):(n(),a("div",it,[s("div",ut,[i.value?(n(),a(S,{key:0},[s("div",dt,[$(Ke,{material:e.value,onDocumentLoaded:b},null,8,["material"])],512),e.value.sources.length?(n(),a("div",mt,[$(se,{sources:e.value.sources},null,8,["sources"])])):M("",!0),(C=e.value.references)!=null&&C.length?(n(),a("div",pt,[$(ne,{references:e.value.references},null,8,["references"])])):M("",!0)],64)):e.value.children.length?(n(),a("div",vt,[$(A,{to:g(l).getLoginUrl(g(t),!0)},{default:H(()=>k[0]||(k[0]=[te("로그인")])),_:1},8,["to"]),k[1]||(k[1]=s("span",null,"이 필요합니다.",-1))])):(n(),a("div",_t," 세부 강의가 없습니다. ")),s("div",ht,[$(Qe,{material:e.value},null,8,["material"])])],512),r.contentLoaded&&u.value.length?(n(),a("div",ft,[$(J,{materials:u.value},null,8,["materials"])],512)):M("",!0)]))],64)):(n(),a("div",gt,"접근 가능한 데이터가 없습니다."))])])}}}),St=E(yt,[["__scopeId","data-v-21a6c093"]]);export{St as default};
