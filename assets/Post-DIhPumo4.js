import{d as A,i as L,q as b,s as E,n as W,l as O,c as d,x as R,g as T,u as o,j as D,F as U,e as f,m,y as B,o as n,_ as S,z as M,b as s,w as I,f as z,t as N,A as F,v as w,B as V}from"./index-r5DwQn-m.js";import{c as y}from"./commonLib-B4LiHA7t.js";import{D as q,a as H,b as j,c as G,_ as J,d as K,C as Q,e as X}from"./common.angle.right-CR6lT3Tk.js";import{p as i,P as Y}from"./Posts-vE4ZFU6f.js";const Z={key:0,class:"video"},ee={key:1,class:"content"},te=A({__name:"PostCore",props:{id:{},onContentLoaded:{type:Function}},setup(h){const u=L(),l=D(),r=h,a=b(),e=E({loaded:!1,title:"WAIT A MOMENT",desc:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",presentation:!1,created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),p=()=>{const t=new DOMParser().parseFromString(e.content,"text/html");Array.from(t.querySelectorAll("[data-bs-toggle='popover']")).forEach((v,k)=>{if(!e.sources[k]){console.warn("마크다운 파일에 입력한 출처와 차이가 있습니다.");return}v.setAttribute("title","출처"),v.setAttribute("data-bs-content",y.linkify(e.sources[k])),v.innerText=`[${k+1}]`}),e.content=t.body.innerHTML};return W(async()=>{const t=i.find(c=>c.id===r.id);if(t){const{html:c}=await t.read();e.title=t.title,e.desc=t.desc,e.videoUrl=t.videoUrl,e.content=y.linkify(c),e.presentation=t.presentation,e.created=t.created,e.updated=t.updated,e.sources=t.sources,e.references=t.references,p(),B(()=>{e.loaded=!0,r.onContentLoaded()}),u.updateSiteTitle(e.title)}}),O(()=>{u.updateSiteTitle()}),(t,c)=>(n(),d("div",{class:R(["post-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:a},[o(l).query.mode==="presentation"&&e.loaded?(n(),T(q,{key:0,title:e.title,desc:e.desc,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","desc","content","sources","references","created","updated"])):(n(),d(U,{key:1},[f(H,{title:o(y).extractText(e.title),desc:e.desc,presentation:e.presentation,created:e.created,updated:e.updated,skeleton:!e.loaded},null,8,["title","desc","presentation","created","updated","skeleton"]),e.videoUrl?(n(),d("div",Z,[f(j,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):m("",!0),e.content?(n(),d("div",ee,[f(G,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])):m("",!0)],64))],2))}}),oe=S(te,[["__scopeId","data-v-1981eec5"]]),se={class:"wrapper"},ne={class:"title"},re={class:"title"},ae=A({__name:"PostNavigation",props:{id:{}},setup(h){const u=h,l=M(()=>{let a=null;for(let e=0;e<i.length;e++)if(i[e].id===u.id){a=i[e-1];break}return a}),r=M(()=>{let a=null;for(let e=0;e<i.length;e++)if(i[e].id===u.id){a=i[e+1];break}return a});return(a,e)=>{const p=z("router-link");return n(),d("div",{class:R(["post-navigation",{both:o(l)&&o(r)}])},[s("div",se,[o(l)?(n(),T(p,{key:0,to:`/posts/${o(l).id}`,class:"item prev",title:o(l).title},{default:I(()=>[e[0]||(e[0]=s("div",{class:"label"},[s("img",{src:J,alt:"이전"}),s("span",null,"이전")],-1)),s("div",ne,N(o(y).extractText(o(l).title)),1)]),_:1},8,["to","title"])):m("",!0),o(r)?(n(),T(p,{key:1,to:`/posts/${o(r).id}`,class:"item next",title:o(r).title},{default:I(()=>[e[1]||(e[1]=s("div",{class:"label"},[s("img",{src:K,alt:"다음"}),s("span",null,"다음")],-1)),s("div",re,N(o(y).extractText(o(r).title)),1)]),_:1},8,["to","title"])):m("",!0)])],2)}}}),ce=S(ae,[["__scopeId","data-v-289f49dc"]]),le={class:"post"},de={class:"container"},ie={class:"wrapper"},ue={class:"main"},pe={key:0,class:"sources"},_e={key:1,class:"references"},fe={class:"navigation"},me=A({__name:"Post",setup(h){const u=L(),l=F(),r=D(),a=b(),e=b(),p=E({contentLoaded:!1}),t=w(()=>{var _;return((_=r.params.id)==null?void 0:_.toString())??""}),c=w(()=>i.find(_=>_.id===t.value)),v=()=>{p.contentLoaded=!0},k=_=>{var g;u.windowSize.width<=1399||(g=e.value)==null||g.scrollTo({top:_-1,behavior:"smooth"})};return(_,g)=>{var x,P,C,$;return n(),d("div",le,[s("div",de,[s("div",ie,[s("div",ue,[s("div",{class:"core",ref_key:"coreRef",ref:a},[(n(),T(oe,{id:t.value,key:t.value,onContentLoaded:v},null,8,["id"]))],512),(P=(x=c.value)==null?void 0:x.sources)!=null&&P.length?(n(),d("div",pe,[f(Q,{sources:c.value.sources},null,8,["sources"])])):m("",!0),($=(C=c.value)==null?void 0:C.references)!=null&&$.length?(n(),d("div",_e,[f(X,{references:c.value.references},null,8,["references"])])):m("",!0),s("div",fe,[f(ce,{id:t.value},null,8,["id"])])]),p.contentLoaded?(n(),d("div",{key:0,class:"posts",ref_key:"postsRef",ref:e,style:V({height:o(l).mainHeight})},[f(Y,{id:t.value,onScrollable:k},null,8,["id"])],4)):m("",!0)])])])}}}),Te=S(me,[["__scopeId","data-v-adfecbda"]]);export{Te as default};
