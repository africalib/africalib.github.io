import{d as T,g as y,c as u,b as t,F as A,r as H,t as I,u as g,o as r,_ as E,n as Y,i as U,h as R,j as K,k as D,f as k,l as M,T as ne,m as W,p as F,q as oe,s as N,v as Z,w as re,x as le,y as ce,z as B,A as ie,B as O,C as P,D as ee,E as ue}from"./index-O_wuadst.js";import{u as z,M as G}from"./Materials-oNpkv5j8.js";import{T as de}from"./Tags-DHXnQEAM.js";import{c as b}from"./commonLib-Co9BQnS0.js";import{C as me}from"./CryptoHelper-m6j8gmxG.js";import{_ as pe,a as _e,b as ve}from"./common.arrow.left-TSorRx6s.js";import{r as he}from"./routeLib-DhAZaWiT.js";import{A as fe}from"./Above-BOHcs9XS.js";import"./Panel-CHRfI_W_.js";const ge={class:"common-sources"},ye={class:"items"},ke=["innerHTML"],$e=T({__name:"MaterialSources",props:{sources:{}},setup(h){const e=h,i=y(()=>{const _=new Map;return e.sources.forEach((l,d)=>{_.has(l)||_.set(l,[]),_.get(l).push(d+1)}),Array.from(_.entries()).map(([l,d])=>({indexes:d,src:l}))});return(_,l)=>(r(),u("div",ge,[l[1]||(l[1]=t("div",{class:"subject"},"자료 출처",-1)),t("div",ye,[(r(!0),u(A,null,H(i.value,d=>(r(),u("div",{class:"item",key:d.src},[(r(!0),u(A,null,H(d.indexes,m=>(r(),u("span",null,"["+I(m)+"]",1))),256)),l[0]||(l[0]=t("span",null," ",-1)),t("span",{innerHTML:g(b).linkify(d.src)},null,8,ke)]))),128))])]))}}),te=E($e,[["__scopeId","data-v-a34ac84b"]]),we={class:"common-references"},xe={class:"items"},be={class:"item"},Me=T({__name:"MaterialReferences",props:{references:{}},setup(h){const e=h;return(i,_)=>(r(),u("div",we,[_[0]||(_[0]=t("div",{class:"subject"},"참고 자료",-1)),t("div",xe,[(r(!0),u(A,null,H(e.references,l=>(r(),u("div",be,[t("span",null,I(l),1)]))),256))])]))}}),se=E(Me,[["__scopeId","data-v-64c8b31c"]]),Te=["innerHTML"],Se=T({__name:"DocumentContent",props:{document:{},skeleton:{type:Boolean}},setup(h){const e=h;return(i,_)=>(r(),u("div",{class:Y(["document-content",{skeleton:e.skeleton}])},[t("div",{innerHTML:e.document,ref:"contentRef"},null,8,Te)],2))}}),ae=E(Se,[["__scopeId","data-v-7a52ca4e"]]),Le="/assets/images/component.document.presentation.slide.first.svg",Ee="/assets/images/component.material.presentation.finish.svg",X=T({__name:"DocumentPrompt",props:{content:{}},setup(h){const e=h;return U(()=>{console.info(e.content.replace(/\n{3,}/g,`

`))}),(i,_)=>null}}),Ae={class:"presentation"},Ce={class:"slides"},De={key:0,class:"slide start"},Ie={class:"container"},qe={class:"slide-item"},He=["innerHTML"],Pe={key:1,class:"slide finish"},Re={class:"container"},Ne={key:0,class:"slide"},je={class:"container"},J="no-overflow",Fe=T({__name:"MaterialPresentation",props:{material:{},document:{}},setup(h){const e={touchStartX:0,touchStartY:0},i=h,_=R(),l=W(),d=`이렇게 해서 ${b.extractText(i.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,m=y(()=>i.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),s=y(()=>{const p=[i.material.desc];return n.value.length===0&&a.value.length===1&&p.push(a.value[0]),p.join("")}),n=y(()=>{const p=new DOMParser().parseFromString(i.document,"text/html");return Array.from(p.querySelectorAll(".slide-item")).map(v=>v.outerHTML)}),a=y(()=>{const p=[],v={},w=new DOMParser().parseFromString(i.document,"text/html");Array.from(w.querySelectorAll(".slide-text")).forEach(L=>{const C=L.getAttribute("data-slide-text-group");C&&(!v[C]&&(v[C]=[]),v[C].push(b.replaceAll(L.outerText,"  ","").trim()))});for(let L in v)p.push(v[L].join(`
`));return p}),c=y(()=>{var p;return window.Number.parseInt(((p=_.query.idx)==null?void 0:p.toString())||"0")}),f=y(()=>n.value.length+1),o=p=>{const v=b.renew(_.query);let w=c.value+p;w<0?w=0:w>f.value&&(w=f.value),c.value!==w&&(v.idx=w.toString(),l.push({query:v}))},$=(p,v)=>{switch(p){case"ArrowLeft":!v&&o(-1);break;case"ArrowRight":!v&&o(1);break;case"F9":case"Escape":l.push({query:void 0});break}},x=p=>{$(p.key,p.altKey)},S=p=>{const v=p.touches[0];e.touchStartX=v.clientX,e.touchStartY=v.clientY},q=p=>{const v=p.changedTouches[0],w=v.clientX,V=v.clientY,L=w-e.touchStartX,C=V-e.touchStartY;Math.abs(L)>Math.abs(C)&&Math.abs(L)>50&&(L>0?o(-1):o(1))},j=p=>{p.data.type==="keyup"&&$(p.data.key,p.data.altKey)};return U(()=>{document.addEventListener("keyup",x),document.addEventListener("touchstart",S),document.addEventListener("touchend",q),window.addEventListener("message",j),document.body.classList.add(J)}),K(()=>{document.removeEventListener("keyup",x),document.removeEventListener("touchstart",S),document.removeEventListener("touchend",q),window.removeEventListener("message",j),document.body.classList.remove(J)}),(p,v)=>(r(),D(ne,{to:"body"},[t("div",Ae,[t("div",Ce,[c.value===0?(r(),u("div",De,[t("div",Ie,[t("figure",qe,[v[0]||(v[0]=t("img",{src:Le,alt:"코딩",loading:"lazy"},null,-1)),t("figcaption",null,[t("span",{innerHTML:m.value},null,8,He),k(X,{content:s.value},null,8,["content"])])])])])):c.value===f.value?(r(),u("div",Pe,[t("div",Re,[v[1]||(v[1]=t("figure",{class:"slide-item"},[t("img",{src:Ee,alt:"하이파이브",class:"mh-400",loading:"lazy"}),t("figcaption",null,[t("b",null,"이상 끝. "),t("span",null,"수고하셨습니다!")])],-1)),i.material.sources.length?(r(),D(te,{key:0,class:"w-100 mb-3",sources:i.material.sources},null,8,["sources"])):M("",!0),i.material.references.length?(r(),D(se,{key:1,class:"w-100",references:i.material.references},null,8,["references"])):M("",!0),k(X,{content:d})])])):(r(!0),u(A,{key:2},H(n.value.length,w=>(r(),u(A,null,[c.value===w?(r(),u("div",Ne,[t("div",je,[k(ae,{document:n.value[w-1]},null,8,["document"]),k(X,{content:a.value[w-1]||""},null,8,["content"])])])):M("",!0)],64))),256))])])]))}}),Be=E(Fe,[["__scopeId","data-v-6bffa037"]]);function Oe(){const h=F(null),e=F(null),i=F(!1);return{data:h,error:e,loading:i,request:async({url:l,method:d="GET",body:m,contentType:s="application/json",...n})=>{i.value=!0,e.value=null;try{const a={"Content-Type":s,...n.headers||{}},c={method:d,headers:a,...n};m&&(c.body=s==="application/json"?JSON.stringify(m):m);const f=await fetch(l,c);if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);const o=f.headers.get("Content-Type");return o!=null&&o.includes("application/json")?h.value=await f.json():h.value=await f.text(),h.value}catch(a){throw e.value=a.message||"Unknown error",a}finally{i.value=!1}}}}const Xe={key:0,class:"presentation"},Ye={class:"content"},Ue={key:1,class:"empty"},Ke=T({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(h){const e=R(),i=oe(),_=N(),l=z(e),{data:d,loading:m,request:s}=Oe(),n=h,a=Z({document:"<p>PLEASE WAIT A MOMENT</p>"}),c=()=>{if(!n.material.sources.length)return;const o=new DOMParser().parseFromString(a.document,"text/html");Array.from(o.querySelectorAll("[data-bs-toggle='popover']")).forEach((x,S)=>{if(!n.material.sources[S]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}x.setAttribute("title","자료 출처"),x.setAttribute("data-bs-content",b.linkify(n.material.sources[S])),x.innerText=`[${S+1}]`}),a.document=o.body.innerHTML},f=async()=>{if(n.material){const o=l.getUrlPath(n.material);await s({url:`/assets${o}/document.html?${Date.now()}`,contentType:"text/html"});const $=ce.get(B.unlockPasswordCookieName),x=window.location.hostname==="localhost";if(n.material.locked&&$&&!x){const S=new me($,B.salt,B.iv);d.value=await S.decrypt(d.value).catch(q=>(console.error({err:q,message:"문서를 복호화 할 수 없습니다."}),null))}a.document=b.linkify(d.value),c()}ie(()=>{n.onDocumentLoaded()}),i.updateSiteTitle(b.extractText(n.material.title))};return re(()=>{f()}),K(()=>{i.updateSiteTitle()}),le(()=>e.path,()=>{f()}),(o,$)=>(r(),u("div",{class:Y(["material-core",{skeleton:g(m)}])},[g(e).query.mode==="presentation"&&!g(m)&&g(_).admin?(r(),u("div",Xe,[k(Be,{material:n.material,document:a.document},null,8,["material","document"])])):M("",!0),t("div",Ye,[a.document?(r(),D(ae,{key:0,document:a.document,skeleton:g(m)},null,8,["document","skeleton"])):(r(),u("div",Ue,"조회 가능한 문서가 없습니다."))])],2))}}),ze=E(Ke,[["__scopeId","data-v-8f542003"]]),Ve={class:"wrapper"},Ge={class:"title"},Je={class:"title"},Qe=T({__name:"MaterialNavigation",props:{material:{}},setup(h){const e=h,i=R();N(),z(i);const _=O(()=>{var s,n;const m=[];if((n=(s=e.material)==null?void 0:s.parent)!=null&&n.children){const a=he.getTag(i);e.material.parent.children.forEach(c=>{(!a||c.tags.includes(a))&&m.push(c)})}return m}),l=O(()=>{var n;let m=null;const s=_.value;for(let a=0;a<s.length;a++)if(s[a].id===((n=e.material)==null?void 0:n.id)&&s[a-1]){m=s[a-1];break}return m}),d=O(()=>{var n;let m=null;const s=_.value;for(let a=0;a<s.length;a++)if(s[a].id===((n=e.material)==null?void 0:n.id)&&s[a+1]){m=s[a+1];break}return m});return(m,s)=>{const n=ee("router-link");return r(),u("div",{class:Y(["material-navigation",{both:g(l)&&g(d)}])},[t("div",Ve,[g(l)?(r(),D(n,{key:0,to:g(l).url||"",class:"item prev",title:g(l).title},{default:P(()=>[s[0]||(s[0]=t("div",{class:"label"},[t("img",{src:pe,alt:"이전"}),t("span",null,"이전")],-1)),t("div",Ge,I(g(b).extractText(g(l).title)),1)]),_:1},8,["to","title"])):M("",!0),g(d)?(r(),D(n,{key:1,to:g(d).url,class:"item next",title:g(d).title},{default:P(()=>[s[1]||(s[1]=t("div",{class:"label"},[t("img",{src:_e,alt:"다음"}),t("span",null,"다음")],-1)),t("div",Je,I(g(b).extractText(g(d).title)),1)]),_:1},8,["to","title"])):M("",!0)])],2)}}}),We=E(Qe,[["__scopeId","data-v-5e145af4"]]),Ze={class:"material-above"},et={class:"back"},tt={class:"wrapper"},st={class:"dates"},at=["title"],Q="?mode=presentation",nt=T({__name:"MaterialAbove",props:{material:{}},setup(h){const e=h,i=W(),_=N(),l=c=>{c==="F9"&&_.admin&&i.push(Q)},d=c=>{l(c.key)},m=y(()=>{const c={title:"강의 자료",url:"/materials"};return e.material.parent&&(c.title=e.material.parent.title,c.url=e.material.parent.url),c}),s=y(()=>e.material.created?e.material.updated?b.getHumanReadableDate(e.material.updated)+" 업데이트됨":b.getHumanReadableDate(e.material.created)+" 생성됨":"(N/A)"),n=y(()=>{if(e.material.created){const c=[`생성: ${e.material.created}`];return e.material.updated&&c.push(`업데이트: ${e.material.created}`),c.join(" | ")}}),a=c=>{c.data.type==="keyup"&&l(c.data.key)};return U(()=>{document.addEventListener("keyup",d),window.addEventListener("message",a)}),K(()=>{document.removeEventListener("keyup",d),window.removeEventListener("message",a)}),(c,f)=>{const o=ee("router-link");return r(),u("div",Ze,[t("div",et,[k(o,{to:m.value.url},{default:P(()=>[f[0]||(f[0]=t("img",{src:ve,alt:"뒤로가기",title:"뒤로가기"},null,-1)),t("span",null,I(m.value.title),1)]),_:1},8,["to"])]),t("div",tt,[t("div",st,[t("span",{title:n.value},I(s.value),9,at),e.material.presentation&&g(_).admin?(r(),u(A,{key:0},[f[2]||(f[2]=t("span",{class:"bar"},null,-1)),k(o,{to:Q},{default:P(()=>f[1]||(f[1]=[ue("발표(F9)")])),_:1})],64)):M("",!0)]),k(fe,{title:g(b).extractText(e.material.title),desc:e.material.desc},null,8,["title","desc"])])])}}}),ot=E(nt,[["__scopeId","data-v-f7a291a7"]]),rt={class:"material"},lt={class:"container"},ct={class:"above",ref:"aboveRef"},it={key:0,class:"list"},ut={class:"tags"},dt={key:1,class:"detail"},mt={class:"main",ref:"mainRef"},pt={class:"core",ref:"coreRef"},_t={key:0,class:"sources"},vt={key:1,class:"references"},ht={class:"navigation"},ft={key:0,class:"materials",ref:"materialsRef"},gt={key:1,class:"empty"},yt=T({__name:"MaterialDetail",setup(h){const e=R();N();const i=z(e),_=Z({contentLoaded:!1}),l=y(()=>{var o;return(o=e.params.id1)==null?void 0:o.toString()}),d=y(()=>{var o;return(o=e.params.id2)==null?void 0:o.toString()}),m=y(()=>{var o;return(o=e.params.id3)==null?void 0:o.toString()}),s=y(()=>i.get(l.value,d.value,m.value)),n=y(()=>{var o,$;return(($=(o=s.value)==null?void 0:o.parent)==null?void 0:$.children)||[]}),a=y(()=>{var $;const o=new Set;return o.add(void 0),($=i.get(l.value))==null||$.tags.forEach(x=>o.add(x)),o}),c=y(()=>{if(e.query.tag)return window.decodeURIComponent(e.query.tag.toString())}),f=()=>{_.contentLoaded=!0};return(o,$)=>{var x;return r(),u("div",rt,[t("div",lt,[s.value?(r(),u(A,{key:0},[t("div",ct,[k(ot,{material:s.value},null,8,["material"])],512),s.value.children.length?(r(),u("div",it,[t("div",ut,[k(de,{tags:a.value,tag:c.value},null,8,["tags","tag"])]),k(G,{materials:s.value.children,tag:c.value},null,8,["materials","tag"])])):(r(),u("div",dt,[t("div",mt,[t("div",pt,[k(ze,{material:s.value,onDocumentLoaded:f},null,8,["material"])],512),s.value.sources.length?(r(),u("div",_t,[k(te,{sources:s.value.sources},null,8,["sources"])])):M("",!0),(x=s.value.references)!=null&&x.length?(r(),u("div",vt,[k(se,{references:s.value.references},null,8,["references"])])):M("",!0),t("div",ht,[k(We,{material:s.value},null,8,["material"])])],512),_.contentLoaded&&n.value.length?(r(),u("div",ft,[k(G,{materials:n.value},null,8,["materials"])],512)):M("",!0)]))],64)):(r(),u("div",gt,"접근 가능한 데이터가 없습니다."))])])}}}),Et=E(yt,[["__scopeId","data-v-44e4ea5f"]]);export{Et as default};
