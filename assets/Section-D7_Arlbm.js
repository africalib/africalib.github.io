import{f as w,q as L,c as m,s as E,b as t,o as a,_ as T,F as R,g as P,t as $,u as I,m as y,v as te,k as q,x as b,j as O,l as J,h as x,T as oe,d as k,w as C,p as se,r as D,i as G,y as X,n as ne,z as re,A as ce,B as H,C as ae,D as le}from"./index-Bt7aCXnM.js";import{u as U}from"./useSection-DKHK66L0.js";import{C as ie}from"./Chapters-CqZYzLxT.js";import"./courses-CDDW1LE_.js";const de="/assets/images/common.home.white.svg",ue="/assets/images/component.section.core.main.svg",pe="/assets/images/component.section.core.presentation.open.svg",M={renew(r){return JSON.parse(JSON.stringify(r))},linkify(r){const o=/(\bhttps?:\/\/[^\s<>"')\]]+)/g;return r.replace(o,(_,s)=>r.includes(`<a href="${s}"`)||r.includes(`<a href='${s}'`)?_:`<a href="${s}" target="_blank" rel="noopener noreferrer">${s}</a>`)},replaceAll(r,o,_){return r.split(o).join(_)},isNumeric(r){return!isNaN(Number(r))},generateDomId(){return window.crypto.randomUUID()},getHumanReadableDate(r){const o=new Date(r.replace(" ","T")),s=new Date().getTime()-o.getTime(),l=Math.floor(s/1e3),v=Math.floor(l/60),u=Math.floor(v/60),e=Math.floor(u/24),c=Math.floor(e/30),h=Math.floor(e/365);return isNaN(o.getTime())?"(N/A)":l<60?"방금 전":v<60?`${v}분 전`:u<24?`${u}시간 전`:e<30?`${e}일 전`:c<12?`${c}개월 전`:`${h}년 전`}},me=["innerHTML"],_e=w({__name:"SectionContent",props:{content:{},skeleton:{type:Boolean}},setup(r){const o=r,_=L();return(s,l)=>(a(),m("div",{class:E(["section-core-content",{skeleton:o.skeleton}]),ref_key:"rootRef",ref:_},[t("div",{innerHTML:o.content},null,8,me)],2))}}),Y=T(_e,[["__scopeId","data-v-7741b346"]]),fe=w({__name:"SectionVideo",props:{url:{},skeleton:{type:Boolean}},setup(r){const o=r;return(_,s)=>(a(),m("div",{class:E(["section-core-video",{skeleton:o.skeleton}])},s[0]||(s[0]=[t("div",{class:"wrapper"},[t("div",{class:"inner"})],-1)]),2))}}),ve=T(fe,[["__scopeId","data-v-eea266e5"]]),he="/assets/images/component.section.core.presentation.position.svg",ge="/assets/images/component.section.core.presentation.close.svg",ke="/assets/images/component.section.core.presentation.finish.svg",Ie={class:"section-sources"},Se={class:"items"},ye={class:"item"},$e=["innerHTML"],be=w({__name:"SectionSources",props:{sources:{}},setup(r){const o=r;return(_,s)=>(a(),m("div",Ie,[s[0]||(s[0]=t("div",{class:"subject"},"자료 출처",-1)),t("div",Se,[(a(!0),m(R,null,P(o.sources,(l,v)=>(a(),m("div",ye,[t("span",null,"["+$(v+1)+"] ",1),t("span",{innerHTML:I(M).linkify(l)},null,8,$e)]))),256))])]))}}),Q=T(be,[["__scopeId","data-v-788a8476"]]),we={class:"section-references"},Te={class:"items"},Ce={class:"item"},xe=w({__name:"SectionReferences",props:{references:{}},setup(r){const o=r;return(_,s)=>(a(),m("div",we,[s[0]||(s[0]=t("div",{class:"subject"},"참고 자료",-1)),t("div",Te,[(a(!0),m(R,null,P(o.references,l=>(a(),m("div",Ce,[t("span",null,$(l),1)]))),256))])]))}}),Z=T(xe,[["__scopeId","data-v-032f39d2"]]),Me={class:"wrapper"},Ae={class:"title"},Le={class:"date"},Re=["title"],Ne=["title"],Ee={class:"side"},De=w({__name:"SectionHeader",props:{title:{},created:{},updated:{},skeleton:{type:Boolean}},setup(r){const o=r;return(_,s)=>(a(),m("div",{class:E(["section-header",{skeleton:o.skeleton}])},[t("div",Me,[t("div",Ae,[t("span",null,$(o.title),1)]),t("div",Le,[t("span",{title:o.created}," 생성: "+$(I(M).getHumanReadableDate(o.created)),9,Re),o.created!==o.updated?(a(),m(R,{key:0},[s[0]||(s[0]=t("span",{class:"bar"},null,-1)),t("span",{title:o.updated}," 수정: "+$(I(M).getHumanReadableDate(o.updated)),9,Ne)],64)):y("",!0)])]),t("div",Ee,[te(_.$slots,"default",{},void 0)])],2))}}),ee=T(De,[["__scopeId","data-v-5a67f70b"]]),V=w({__name:"SectionPrompt",props:{content:{}},setup(r){const o=r;return q(()=>{console.info(o.content)}),(_,s)=>null}}),He={class:"hide-sm",title:"슬라이드 번호"},Pe={class:"container"},qe={key:0,class:"slide"},Oe={key:0,class:"slide finish"},Ue="이상 끝. 수고하셨습니다!",K="no-overflow",Be=w({__name:"SectionPresentation",props:{title:{},created:{},updated:{},content:{},sources:{},references:{}},setup(r){const o=r,_=O(),s=se(),l=L(null),v=`이렇게 해서 ${o.title}에 대해 알아봤습니다. 수고하셨습니다!`,u=b(()=>{const i=new DOMParser().parseFromString(o.content,"text/html");return Array.from(i.querySelectorAll(".slide-item")).map(f=>f.outerHTML)}),e=b(()=>{const i=new DOMParser().parseFromString(o.content,"text/html");return Array.from(i.querySelectorAll(".slide-text")).map(f=>M.replaceAll(f.outerText,"  ","").trim())}),c=b(()=>{var i;return window.Number.parseInt(((i=_.query.idx)==null?void 0:i.toString())||"0")}),h=()=>{const i=[];return u.value.length<e.value.length?i.unshift(e.value[e.value.length-1]):i.push(v),i.join(" ")},g=i=>{const f=M.renew(_.query);let n=c.value+i;n<0?n=0:n>u.value.length&&(n=u.value.length),c.value!==n&&(f.idx=n.toString(),s.push({query:f}))},S=i=>{switch(i.key){case"ArrowLeft":!i.altKey&&g(-1);break;case"ArrowRight":!i.altKey&&g(1);break;case"Escape":s.push({query:void 0});break}},N=i=>{const f=window.innerWidth,n=i.target;n.closest("[data-bs-toggle]")||n.closest("[href]")||(i.clientX<f/2?g(-1):g(1))};return q(()=>{document.addEventListener("keyup",S),document.body.classList.add(K)}),J(()=>{document.removeEventListener("keyup",S),document.body.classList.remove(K)}),(i,f)=>{const n=D("router-link");return a(),x(oe,{to:"body"},[t("div",{class:"presentation",ref_key:"rootRef",ref:l},[k(ee,{title:o.title,created:o.created,updated:o.updated},{default:C(()=>[t("div",He,[f[0]||(f[0]=t("img",{src:he,alt:"슬라이드 번호"},null,-1)),t("div",null,$(c.value+1)+" / "+$(u.value.length+1),1)]),k(n,{to:"?"},{default:C(()=>f[1]||(f[1]=[t("img",{src:ge,alt:"닫기"},null,-1),t("div",null,"닫기",-1)])),_:1})]),_:1},8,["title","created","updated"]),t("div",{class:"slides",onClick:N},[t("div",Pe,[(a(!0),m(R,null,P(u.value,(p,d)=>(a(),m(R,null,[c.value===d?(a(),m("div",qe,[k(Y,{content:p},null,8,["content"]),k(V,{content:e.value[d]||""},null,8,["content"])])):y("",!0)],64))),256)),c.value===u.value.length?(a(),m("div",Oe,[f[2]||(f[2]=t("img",{src:ke,loading:"lazy"},null,-1)),t("div",{class:"text"},$(Ue)),o.sources.length?(a(),x(Q,{key:0,class:"w-100",sources:o.sources},null,8,["sources"])):y("",!0),o.references.length?(a(),x(Z,{key:1,class:"w-100",references:o.references},null,8,["references"])):y("",!0),k(V,{content:h()},null,8,["content"])])):y("",!0)])])],512)])}}}),We=T(Be,[["__scopeId","data-v-3ee1adf6"]]),Fe={key:0,class:"video"},je={class:"content"},ze=w({__name:"SectionCore",props:{courseId:{},chapterId:{},sectionId:{},onContentLoaded:{type:Function}},setup(r){const o=G(),_=O(),s=U(),l=r,v=L(),u=window.bootstrap,e=X({loaded:!1,title:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),c=b(()=>s.getSection(l.courseId,l.chapterId,l.sectionId)),h=b(()=>_.query.mode||"post"),g=()=>{const n=new DOMParser().parseFromString(e.content,"text/html");Array.from(n.querySelectorAll("[data-bs-toggle='popover']")).forEach((d,A)=>{d.setAttribute("title","출처"),d.setAttribute("data-bs-content",M.linkify(e.sources[A])),d.innerText=`[${A+1}]`}),e.content=n.body.innerHTML},S=n=>{n!=null&&n.closest(".popover")||document.querySelectorAll('[data-bs-toggle="popover"]').forEach(p=>{const d=u.Popover.getInstance(p);d&&d.dispose()})},N=n=>{n.getAttribute("data-bs-toggle")&&new u.Popover(n,{html:!0}).show()},i=n=>{N(n.target)},f=n=>{S(n.target)};return ne(async()=>{const n=s.getCourse(l.courseId);if(n){const p=s.getChapter(l.courseId,l.chapterId);if(p){const d=c.value;if(d){const{html:A}=await d.read();e.title=d.title,e.videoUrl=d.videoUrl,e.content=M.linkify(A),e.created=d.created,e.updated=d.updated,e.courseTitle=n.title,e.chapterTitle=p.title,e.sources=d.sources,e.references=d.references,g(),ce(()=>{e.loaded=!0,l.onContentLoaded()}),o.updateSiteTitle(e.title)}}}}),q(()=>{S(),document.addEventListener("click",i),document.addEventListener("mousedown",f)}),re(()=>{S()}),J(()=>{o.updateSiteTitle(),document.removeEventListener("click",i),document.removeEventListener("mousedown",f)}),(n,p)=>{const d=D("router-link");return a(),m("div",{class:E(["section-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:v},[h.value==="presentation"&&e.loaded?(a(),x(We,{key:0,title:e.title,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","content","sources","references","created","updated"])):(a(),m(R,{key:1},[k(ee,{title:e.title,created:e.created,updated:e.updated,skeleton:!e.loaded},{default:C(()=>[k(d,{to:`/courses/${l.courseId}`,class:"d-none d-md-flex"},{default:C(()=>p[0]||(p[0]=[t("img",{src:ue,alt:"이전"},null,-1),t("div",null,"이전",-1)])),_:1},8,["to"]),k(d,{to:"?mode=presentation"},{default:C(()=>p[1]||(p[1]=[t("img",{src:pe,alt:"발표"},null,-1),t("div",null,"발표",-1)])),_:1})]),_:1},8,["title","created","updated","skeleton"]),e.videoUrl!==null?(a(),m("div",Fe,[k(ve,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):y("",!0),t("div",je,[k(Y,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])],64))],2)}}}),Ve=T(ze,[["__scopeId","data-v-7cfbaae4"]]),Ke="/assets/images/common.angle.left.svg",Je="/assets/images/common.angle.right.svg",Ge={class:"wrapper"},Xe={class:"title"},Ye={class:"title"},Qe=w({__name:"SectionNavigation",props:{courseId:{},chapterId:{},sectionId:{}},setup(r){const o=r,_=U(),s=H(()=>{var c;const u=[];return(((c=_.getCourse(o.courseId))==null?void 0:c.chapters)||[]).forEach(h=>{h.sections.forEach(g=>{u.push({id:g.id,title:g.title,url:`/courses/${o.courseId}/${h.id}/${g.id}`})})}),u}),l=H(()=>{let u=null;const e=s.value;for(let c=0;c<e.length;c++)e[c].id===o.sectionId&&(u=e[c-1]);return u}),v=H(()=>{let u=null;const e=s.value;for(let c=0;c<e.length;c++)e[c].id===o.sectionId&&(u=e[c+1]);return u});return(u,e)=>{const c=D("router-link");return a(),m("div",{class:E(["section-navigation",{both:I(l)&&I(v)}])},[t("div",Ge,[I(l)?(a(),x(c,{key:0,to:I(l).url||"",class:"item prev",title:I(l).title},{default:C(()=>[e[0]||(e[0]=t("div",{class:"label"},[t("img",{src:Ke,alt:"이전"}),t("span",null,"이전")],-1)),t("div",Xe,$(I(l).title),1)]),_:1},8,["to","title"])):y("",!0),I(v)?(a(),x(c,{key:1,to:I(v).url,class:"item next",title:I(v).title},{default:C(()=>[e[1]||(e[1]=t("div",{class:"label"},[t("img",{src:Je,alt:"다음"}),t("span",null,"다음")],-1)),t("div",Ye,$(I(v).title),1)]),_:1},8,["to","title"])):y("",!0)])],2)}}}),Ze=T(Qe,[["__scopeId","data-v-40bf161a"]]),et={class:"section"},tt={class:"container"},ot={class:"wrapper"},st={class:"main"},nt={key:0,class:"sources"},rt={key:1,class:"references"},ct={class:"navigation"},at=w({__name:"Section",setup(r){const o=G(),_=ae(),s=U(),l=O(),v=L(),u=L(),e=L(),c=X({contentLoaded:!1}),h=b(()=>{var p;return(p=l.params.courseId)==null?void 0:p.toString()}),g=b(()=>{var p;return(p=l.params.chapterId)==null?void 0:p.toString()}),S=b(()=>{var p;return(p=l.params.sectionId)==null?void 0:p.toString()}),N=b(()=>s.getCourse(h.value)),i=b(()=>s.getSection(h.value,g.value,S.value)),f=p=>{var d;o.windowSize.width<=1399||e.value&&e.value.scrollTo({top:p-e.value.offsetTop-(((d=u.value)==null?void 0:d.offsetHeight)||0),behavior:"smooth"})},n=()=>{c.contentLoaded=!0};return(p,d)=>{var B,W,F,j;const A=D("router-link");return a(),m("div",et,[t("div",tt,[t("div",ot,[t("div",st,[t("div",{class:"core",ref_key:"coreRef",ref:v},[(a(),x(Ve,{courseId:h.value,chapterId:g.value,sectionId:S.value,key:S.value,onContentLoaded:n},null,8,["courseId","chapterId","sectionId"]))],512),(W=(B=i.value)==null?void 0:B.sources)!=null&&W.length?(a(),m("div",nt,[k(Q,{sources:i.value.sources},null,8,["sources"])])):y("",!0),(j=(F=i.value)==null?void 0:F.references)!=null&&j.length?(a(),m("div",rt,[k(Z,{references:i.value.references},null,8,["references"])])):y("",!0),t("div",ct,[k(Ze,{courseId:h.value,chapterId:g.value,sectionId:S.value},null,8,["courseId","chapterId","sectionId"])])]),c.contentLoaded?(a(),m("div",{key:0,class:"chapters",ref_key:"chaptersRef",ref:e,style:le({height:I(_).mainHeight})},[t("div",{class:"top",ref_key:"chaptersTopRef",ref:u},[k(A,{to:`/courses/${h.value}`,class:"btn"},{default:C(()=>{var z;return[d[0]||(d[0]=t("img",{src:de},null,-1)),t("span",null,$((z=N.value)==null?void 0:z.title),1)]}),_:1},8,["to"])],512),k(ie,{courseId:h.value,chapterId:g.value,sectionId:S.value,theme:"light",onScrollable:f},null,8,["courseId","chapterId","sectionId"])],4)):y("",!0)])])])}}}),pt=T(at,[["__scopeId","data-v-df1f0cf0"]]);export{pt as default};
