import{d as T,c as u,b as t,F as D,r as X,t as I,u as g,o as l,_ as E,n as Y,i as U,g as k,h as P,j as K,k as C,f as y,l as M,T as ne,m as W,p as j,q as oe,s as R,v as Z,w as re,x as le,y as ce,z as F,A as ie,B,C as H,D as ee,E as ue}from"./index-Bnk3CsjK.js";import{u as z,M as G}from"./Materials-DRXQXD5h.js";import{T as de}from"./Tags-DM3M6nED.js";import{c as b}from"./commonLib-B4LiHA7t.js";import{C as me}from"./CryptoHelper-m6j8gmxG.js";import{_ as pe,a as _e,b as ve}from"./common.arrow.left-TSorRx6s.js";import{r as he}from"./routeLib-DhAZaWiT.js";import{A as fe}from"./Above-g55vErPn.js";import"./Panel-B4-aYavZ.js";const ge={class:"common-sources"},ye={class:"items"},ke={class:"item"},$e=["innerHTML"],we=T({__name:"MaterialSources",props:{sources:{}},setup(v){const e=v;return(c,p)=>(l(),u("div",ge,[p[0]||(p[0]=t("div",{class:"subject"},"자료 출처",-1)),t("div",ye,[(l(!0),u(D,null,X(e.sources,(_,f)=>(l(),u("div",ke,[t("span",null,"["+I(f+1)+"] ",1),t("span",{innerHTML:g(b).linkify(_)},null,8,$e)]))),256))])]))}}),te=E(we,[["__scopeId","data-v-e2850f27"]]),xe={class:"common-references"},be={class:"items"},Me={class:"item"},Te=T({__name:"MaterialReferences",props:{references:{}},setup(v){const e=v;return(c,p)=>(l(),u("div",xe,[p[0]||(p[0]=t("div",{class:"subject"},"참고 자료",-1)),t("div",be,[(l(!0),u(D,null,X(e.references,_=>(l(),u("div",Me,[t("span",null,I(_),1)]))),256))])]))}}),se=E(Te,[["__scopeId","data-v-64c8b31c"]]),Se=["innerHTML"],Le=T({__name:"DocumentContent",props:{document:{},skeleton:{type:Boolean}},setup(v){const e=v;return(c,p)=>(l(),u("div",{class:Y(["document-content",{skeleton:e.skeleton}])},[t("div",{innerHTML:e.document,ref:"contentRef"},null,8,Se)],2))}}),ae=E(Le,[["__scopeId","data-v-7a52ca4e"]]),Ee="/assets/images/component.document.presentation.slide.first.svg",Ae="/assets/images/component.material.presentation.finish.svg",O=T({__name:"DocumentPrompt",props:{content:{}},setup(v){const e=v;return U(()=>{console.info(e.content.replace(/\n{3,}/g,`

`))}),(c,p)=>null}}),Ce={class:"presentation"},De={class:"slides"},Ie={key:0,class:"slide start"},qe={class:"container"},He={class:"slide-item"},Pe=["innerHTML"],Re={key:1,class:"slide finish"},Ne={class:"container"},je={key:0,class:"slide"},Fe={class:"container"},J="no-overflow",Be=T({__name:"MaterialPresentation",props:{material:{},document:{}},setup(v){const e={touchStartX:0,touchStartY:0},c=v,p=P(),_=W(),f=`이렇게 해서 ${b.extractText(c.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,d=k(()=>c.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),s=k(()=>{const i=[c.material.desc];return n.value.length===0&&a.value.length===1&&i.push(a.value[0]),i.join("")}),n=k(()=>{const i=new DOMParser().parseFromString(c.document,"text/html");return Array.from(i.querySelectorAll(".slide-item")).map(m=>m.outerHTML)}),a=k(()=>{const i=[],m={},w=new DOMParser().parseFromString(c.document,"text/html");Array.from(w.querySelectorAll(".slide-text")).forEach(L=>{const A=L.getAttribute("data-slide-text-group");A&&(!m[A]&&(m[A]=[]),m[A].push(b.replaceAll(L.outerText,"  ","").trim()))});for(let L in m)i.push(m[L].join(`
`));return i}),r=k(()=>{var i;return window.Number.parseInt(((i=p.query.idx)==null?void 0:i.toString())||"0")}),h=k(()=>n.value.length+1),o=i=>{const m=b.renew(p.query);let w=r.value+i;w<0?w=0:w>h.value&&(w=h.value),r.value!==w&&(m.idx=w.toString(),_.push({query:m}))},$=(i,m)=>{switch(i){case"ArrowLeft":!m&&o(-1);break;case"ArrowRight":!m&&o(1);break;case"F9":case"Escape":_.push({query:void 0});break}},x=i=>{$(i.key,i.altKey)},S=i=>{const m=i.touches[0];e.touchStartX=m.clientX,e.touchStartY=m.clientY},q=i=>{const m=i.changedTouches[0],w=m.clientX,V=m.clientY,L=w-e.touchStartX,A=V-e.touchStartY;Math.abs(L)>Math.abs(A)&&Math.abs(L)>50&&(L>0?o(-1):o(1))},N=i=>{i.data.type==="keyup"&&$(i.data.key,i.data.altKey)};return U(()=>{document.addEventListener("keyup",x),document.addEventListener("touchstart",S),document.addEventListener("touchend",q),window.addEventListener("message",N),document.body.classList.add(J)}),K(()=>{document.removeEventListener("keyup",x),document.removeEventListener("touchstart",S),document.removeEventListener("touchend",q),window.removeEventListener("message",N),document.body.classList.remove(J)}),(i,m)=>(l(),C(ne,{to:"body"},[t("div",Ce,[t("div",De,[r.value===0?(l(),u("div",Ie,[t("div",qe,[t("figure",He,[m[0]||(m[0]=t("img",{src:Ee,alt:"코딩",loading:"lazy"},null,-1)),t("figcaption",null,[t("span",{innerHTML:d.value},null,8,Pe),y(O,{content:s.value},null,8,["content"])])])])])):r.value===h.value?(l(),u("div",Re,[t("div",Ne,[m[1]||(m[1]=t("figure",{class:"slide-item"},[t("img",{src:Ae,alt:"하이파이브",class:"mh-400",loading:"lazy"}),t("figcaption",null,[t("b",null,"이상 끝. "),t("span",null,"수고하셨습니다!")])],-1)),c.material.sources.length?(l(),C(te,{key:0,class:"w-100 mb-3",sources:c.material.sources},null,8,["sources"])):M("",!0),c.material.references.length?(l(),C(se,{key:1,class:"w-100",references:c.material.references},null,8,["references"])):M("",!0),y(O,{content:f})])])):(l(!0),u(D,{key:2},X(n.value.length,w=>(l(),u(D,null,[r.value===w?(l(),u("div",je,[t("div",Fe,[y(ae,{document:n.value[w-1]},null,8,["document"]),y(O,{content:a.value[w-1]||""},null,8,["content"])])])):M("",!0)],64))),256))])])]))}}),Oe=E(Be,[["__scopeId","data-v-6bffa037"]]);function Xe(){const v=j(null),e=j(null),c=j(!1);return{data:v,error:e,loading:c,request:async({url:_,method:f="GET",body:d,contentType:s="application/json",...n})=>{c.value=!0,e.value=null;try{const a={"Content-Type":s,...n.headers||{}},r={method:f,headers:a,...n};d&&(r.body=s==="application/json"?JSON.stringify(d):d);const h=await fetch(_,r);if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const o=h.headers.get("Content-Type");return o!=null&&o.includes("application/json")?v.value=await h.json():v.value=await h.text(),v.value}catch(a){throw e.value=a.message||"Unknown error",a}finally{c.value=!1}}}}const Ye={key:0,class:"presentation"},Ue={class:"content"},Ke={key:1,class:"empty"},ze=T({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(v){const e=P(),c=oe(),p=R(),_=z(e),{data:f,loading:d,request:s}=Xe(),n=v,a=Z({document:"<p>PLEASE WAIT A MOMENT</p>"}),r=()=>{if(!n.material.sources.length)return;const o=new DOMParser().parseFromString(a.document,"text/html");Array.from(o.querySelectorAll("[data-bs-toggle='popover']")).forEach((x,S)=>{if(!n.material.sources[S]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}x.setAttribute("title","자료 출처"),x.setAttribute("data-bs-content",b.linkify(n.material.sources[S])),x.innerText=`[${S+1}]`}),a.document=o.body.innerHTML},h=async()=>{if(n.material){const o=_.getUrlPath(n.material);await s({url:`/assets${o}/document.html?${Date.now()}`,contentType:"text/html"});const $=ce.get(F.unlockPasswordCookieName),x=window.location.hostname==="localhost";if(n.material.locked&&$&&!x){const S=new me($,F.salt,F.iv);f.value=await S.decrypt(f.value).catch(q=>(console.error({err:q,message:"문서를 복호화 할 수 없습니다."}),null))}a.document=b.linkify(f.value),r()}ie(()=>{n.onDocumentLoaded()}),c.updateSiteTitle(b.extractText(n.material.title))};return re(()=>{h()}),K(()=>{c.updateSiteTitle()}),le(()=>e.path,()=>{h()}),(o,$)=>(l(),u("div",{class:Y(["material-core",{skeleton:g(d)}])},[g(e).query.mode==="presentation"&&!g(d)&&g(p).admin?(l(),u("div",Ye,[y(Oe,{material:n.material,document:a.document},null,8,["material","document"])])):M("",!0),t("div",Ue,[a.document?(l(),C(ae,{key:0,document:a.document,skeleton:g(d)},null,8,["document","skeleton"])):(l(),u("div",Ke,"조회 가능한 문서가 없습니다."))])],2))}}),Ve=E(ze,[["__scopeId","data-v-8f542003"]]),Ge={class:"wrapper"},Je={class:"title"},Qe={class:"title"},We=T({__name:"MaterialNavigation",props:{material:{}},setup(v){const e=v,c=P();R(),z(c);const p=B(()=>{var s,n;const d=[];if((n=(s=e.material)==null?void 0:s.parent)!=null&&n.children){const a=he.getTag(c);e.material.parent.children.forEach(r=>{(!a||r.tags.includes(a))&&d.push(r)})}return d}),_=B(()=>{var n;let d=null;const s=p.value;for(let a=0;a<s.length;a++)if(s[a].id===((n=e.material)==null?void 0:n.id)&&s[a-1]){d=s[a-1];break}return d}),f=B(()=>{var n;let d=null;const s=p.value;for(let a=0;a<s.length;a++)if(s[a].id===((n=e.material)==null?void 0:n.id)&&s[a+1]){d=s[a+1];break}return d});return(d,s)=>{const n=ee("router-link");return l(),u("div",{class:Y(["material-navigation",{both:g(_)&&g(f)}])},[t("div",Ge,[g(_)?(l(),C(n,{key:0,to:g(_).url||"",class:"item prev",title:g(_).title},{default:H(()=>[s[0]||(s[0]=t("div",{class:"label"},[t("img",{src:pe,alt:"이전"}),t("span",null,"이전")],-1)),t("div",Je,I(g(b).extractText(g(_).title)),1)]),_:1},8,["to","title"])):M("",!0),g(f)?(l(),C(n,{key:1,to:g(f).url,class:"item next",title:g(f).title},{default:H(()=>[s[1]||(s[1]=t("div",{class:"label"},[t("img",{src:_e,alt:"다음"}),t("span",null,"다음")],-1)),t("div",Qe,I(g(b).extractText(g(f).title)),1)]),_:1},8,["to","title"])):M("",!0)])],2)}}}),Ze=E(We,[["__scopeId","data-v-5e145af4"]]),et={class:"material-above"},tt={class:"back"},st={class:"wrapper"},at={class:"dates"},nt=["title"],Q="?mode=presentation",ot=T({__name:"MaterialAbove",props:{material:{}},setup(v){const e=v,c=W(),p=R(),_=r=>{r==="F9"&&p.admin&&c.push(Q)},f=r=>{_(r.key)},d=k(()=>{const r={title:"강의 자료",url:"/materials"};return e.material.parent&&(r.title=e.material.parent.title,r.url=e.material.parent.url),r}),s=k(()=>e.material.created?e.material.updated?b.getHumanReadableDate(e.material.updated)+" 업데이트됨":b.getHumanReadableDate(e.material.created)+" 생성됨":"(N/A)"),n=k(()=>{if(e.material.created){const r=[`생성: ${e.material.created}`];return e.material.updated&&r.push(`업데이트: ${e.material.created}`),r.join(" | ")}}),a=r=>{r.data.type==="keyup"&&_(r.data.key)};return U(()=>{document.addEventListener("keyup",f),window.addEventListener("message",a)}),K(()=>{document.removeEventListener("keyup",f),window.removeEventListener("message",a)}),(r,h)=>{const o=ee("router-link");return l(),u("div",et,[t("div",tt,[y(o,{to:d.value.url},{default:H(()=>[h[0]||(h[0]=t("img",{src:ve,alt:"뒤로가기",title:"뒤로가기"},null,-1)),t("span",null,I(d.value.title),1)]),_:1},8,["to"])]),t("div",st,[t("div",at,[t("span",{title:n.value},I(s.value),9,nt),e.material.presentation&&g(p).admin?(l(),u(D,{key:0},[h[2]||(h[2]=t("span",{class:"bar"},null,-1)),y(o,{to:Q},{default:H(()=>h[1]||(h[1]=[ue("발표(F9)")])),_:1})],64)):M("",!0)]),y(fe,{title:g(b).extractText(e.material.title),desc:e.material.desc},null,8,["title","desc"])])])}}}),rt=E(ot,[["__scopeId","data-v-f7a291a7"]]),lt={class:"material"},ct={class:"container"},it={class:"above",ref:"aboveRef"},ut={key:0,class:"list"},dt={class:"tags"},mt={key:1,class:"detail"},pt={class:"main",ref:"mainRef"},_t={class:"core",ref:"coreRef"},vt={key:0,class:"sources"},ht={key:1,class:"references"},ft={class:"navigation"},gt={key:0,class:"materials",ref:"materialsRef"},yt=T({__name:"MaterialDetail",setup(v){const e=P();R();const c=z(e),p=Z({contentLoaded:!1}),_=k(()=>{var o;return(o=e.params.id1)==null?void 0:o.toString()}),f=k(()=>{var o;return(o=e.params.id2)==null?void 0:o.toString()}),d=k(()=>{var o;return(o=e.params.id3)==null?void 0:o.toString()}),s=k(()=>c.get(_.value,f.value,d.value)),n=k(()=>{var o,$;return(($=(o=s.value)==null?void 0:o.parent)==null?void 0:$.children)||[]}),a=k(()=>{var $;const o=new Set;return o.add(void 0),($=c.get(_.value))==null||$.tags.forEach(x=>o.add(x)),o}),r=k(()=>{if(e.query.tag)return window.decodeURIComponent(e.query.tag.toString())}),h=()=>{p.contentLoaded=!0};return(o,$)=>{var x;return l(),u("div",lt,[t("div",ct,[s.value?(l(),u(D,{key:0},[t("div",it,[y(rt,{material:s.value},null,8,["material"])],512),s.value.children.length?(l(),u("div",ut,[t("div",dt,[y(de,{tags:a.value,tag:r.value},null,8,["tags","tag"])]),y(G,{materials:s.value.children,tag:r.value},null,8,["materials","tag"])])):(l(),u("div",mt,[t("div",pt,[t("div",_t,[y(Ve,{material:s.value,onDocumentLoaded:h},null,8,["material"])],512),s.value.sources.length?(l(),u("div",vt,[y(te,{sources:s.value.sources},null,8,["sources"])])):M("",!0),(x=s.value.references)!=null&&x.length?(l(),u("div",ht,[y(se,{references:s.value.references},null,8,["references"])])):M("",!0),t("div",ft,[y(Ze,{material:s.value},null,8,["material"])])],512),p.contentLoaded&&n.value.length?(l(),u("div",gt,[y(G,{materials:n.value},null,8,["materials"])],512)):M("",!0)]))],64)):M("",!0)])])}}}),Et=E(yt,[["__scopeId","data-v-2faa2a20"]]);export{Et as default};
