import{f as b,m as L,c as f,n as D,b as e,o as r,_ as C,F as A,g as U,t as $,j as w,u as k,p as te,q as y,i as q,s as G,v as K,h as x,T as se,d as S,w as M,x as F,y as j,l as oe,r as H,z as X,k as ne,A as P,B as re,C as ce,D as ae}from"./index-Byw_xxun.js";import{u as B}from"./useSection-CAz_Ci2n.js";import{C as ie}from"./Chapters-CRIMuxiN.js";import"./courses-DOF9gmCn.js";const le="/assets/images/common.home.white.svg",de="/assets/images/component.section.core.main.svg",ue="/assets/images/component.section.core.presentation.open.svg",R={renew(c){return JSON.parse(JSON.stringify(c))},linkify(c){const s=/(\bhttps?:\/\/[^\s<>"')\]]+)/g;return c.replace(s,(p,o)=>c.includes(`<a href="${o}"`)||c.includes(`<a href='${o}'`)?p:`<a href="${o}" target="_blank" rel="noopener noreferrer">${o}</a>`)},isNumeric(c){return!isNaN(Number(c))},generateDomId(){return window.crypto.randomUUID()},getHumanReadableDate(c){const s=new Date(c.replace(" ","T")),o=new Date().getTime()-s.getTime(),u=Math.floor(o/1e3),d=Math.floor(u/60),t=Math.floor(d/60),n=Math.floor(t/24),a=Math.floor(n/30),I=Math.floor(n/365);return isNaN(s.getTime())?"(N/A)":u<60?"방금 전":d<60?`${d}분 전`:t<24?`${t}시간 전`:n<30?`${n}일 전`:a<12?`${a}개월 전`:`${I}년 전`}},pe=["innerHTML"],fe=b({__name:"SectionCoreContent",props:{content:{},skeleton:{type:Boolean}},setup(c){const s=c,p=L();return(o,u)=>(r(),f("div",{class:D(["section-core-content",{skeleton:s.skeleton}]),ref_key:"rootRef",ref:p},[e("div",{innerHTML:s.content},null,8,pe)],2))}}),Y=C(fe,[["__scopeId","data-v-ff04c593"]]),me=b({__name:"SectionCoreVideo",props:{url:{},skeleton:{type:Boolean}},setup(c){const s=c;return(p,o)=>(r(),f("div",{class:D(["section-core-video",{skeleton:s.skeleton}])},o[0]||(o[0]=[e("div",{class:"wrapper"},[e("div",{class:"inner"})],-1)]),2))}}),_e=C(me,[["__scopeId","data-v-6d707307"]]),ve="/assets/images/component.section.core.presentation.position.svg",he="/assets/images/component.section.core.presentation.close.svg",ge="/assets/images/component.section.core.presentation.finish.svg",Ie={class:"section-sources"},ke={class:"items"},Se={class:"item"},$e=b({__name:"SectionSources",props:{sources:{}},setup(c){const s=c;return(p,o)=>(r(),f("div",Ie,[o[0]||(o[0]=e("div",{class:"subject"},"내용 출처",-1)),e("div",ke,[(r(!0),f(A,null,U(s.sources,(u,d)=>(r(),f("div",Se,[e("span",null,"["+$(d+1)+"] "+$(u),1)]))),256))])]))}}),Q=C($e,[["__scopeId","data-v-dadd46de"]]),ye={class:"section-references"},we={class:"items"},be={class:"item"},Ce=b({__name:"SectionReferences",props:{references:{}},setup(c){const s=c;return(p,o)=>(r(),f("div",ye,[o[0]||(o[0]=e("div",{class:"subject"},"참고 자료",-1)),e("div",we,[(r(!0),f(A,null,U(s.references,u=>(r(),f("div",be,[e("span",null,$(u),1)]))),256))])]))}}),Z=C(Ce,[["__scopeId","data-v-032f39d2"]]),Te={class:"section-header"},Me={class:"wrapper"},xe={class:"title"},Le={class:"date"},Ne=["title"],Re=["title"],Ae={class:"side"},Ee=b({__name:"SectionHeader",props:{title:{},created:{},updated:{}},setup(c){const s=c;return(p,o)=>(r(),f("div",Te,[e("div",Me,[e("div",xe,[e("span",null,$(s.title),1)]),e("div",Le,[e("span",{title:s.created}," 생성: "+$(k(R).getHumanReadableDate(s.created)),9,Ne),s.created!==s.updated?(r(),f(A,{key:0},[o[0]||(o[0]=e("span",{class:"bar"},null,-1)),e("span",{title:s.updated}," 수정: "+$(k(R).getHumanReadableDate(s.updated)),9,Re)],64)):w("",!0)])]),e("div",Ae,[te(p.$slots,"default",{},void 0)])]))}}),ee=C(Ee,[["__scopeId","data-v-b404f3b0"]]),De={class:"hide-sm"},He={class:"container"},Pe={class:"slide"},Ue={class:"slide end"},J="no-overflow",qe=b({__name:"SectionPresentation",props:{title:{},created:{},updated:{},content:{},sources:{},references:{},skeleton:{type:Boolean}},setup(c){const s=c,p=q(),o=oe(),u=L(null),d=y(()=>{const i=new DOMParser().parseFromString(s.content,"text/html");return Array.from(i.querySelectorAll(".slide")).map(l=>l.outerHTML)}),t=y(()=>{var i;return window.Number.parseInt(((i=p.query.idx)==null?void 0:i.toString())||"0")}),n=i=>{const l=R.renew(p.query);let h=t.value+i;h<0?h=0:h>d.value.length&&(h=d.value.length),t.value!==h&&(l.idx=h.toString(),o.push({query:l}))},a=i=>{i.key==="ArrowLeft"?n(-1):i.key==="ArrowRight"?n(1):i.key==="Escape"&&o.push({query:void 0})},I=i=>{const l=window.innerWidth,h=i.target;h.closest("[data-bs-toggle]")||h.closest("[href]")||(i.clientX<l/2?n(-1):n(1))};return G(()=>{document.addEventListener("keyup",a),document.body.classList.add(J)}),K(()=>{document.removeEventListener("keyup",a),document.body.classList.remove(J)}),(i,l)=>{const h=H("router-link");return r(),x(se,{to:"body"},[e("div",{class:"presentation",ref_key:"rootRef",ref:u},[S(ee,{title:s.title,created:s.created,updated:s.updated},{default:M(()=>[e("div",De,[l[0]||(l[0]=e("img",{src:ve,alt:"슬라이드 번호"},null,-1)),e("div",null,$(t.value+1)+" / "+$(d.value.length+1),1)]),S(h,{to:"?"},{default:M(()=>l[1]||(l[1]=[e("img",{src:he,alt:"발표 닫기"},null,-1),e("div",null,"발표 닫기",-1)])),_:1})]),_:1},8,["title","created","updated"]),e("div",{class:"slides",onClick:I},[e("div",He,[(r(!0),f(A,null,U(d.value,(m,v)=>F((r(),f("div",Pe,[S(Y,{content:m,skeleton:i.skeleton},null,8,["content","skeleton"])],512)),[[j,t.value===v]])),256)),F(e("div",Ue,[l[2]||(l[2]=e("img",{src:ge,loading:"lazy"},null,-1)),l[3]||(l[3]=e("div",{class:"text"},"이상 끝. 수고하셨습니다!",-1)),s.sources.length?(r(),x(Q,{key:0,class:"w-100",sources:s.sources},null,8,["sources"])):w("",!0),s.references.length?(r(),x(Z,{key:1,class:"w-100",references:s.references},null,8,["references"])):w("",!0)],512),[[j,t.value===d.value.length]])])])],512)])}}}),Be=C(qe,[["__scopeId","data-v-c0a34791"]]),Oe={key:0,class:"video"},We={class:"content"},ze=b({__name:"SectionCore",props:{courseId:{},chapterId:{},sectionId:{},onContentLoaded:{type:Function}},setup(c){const s=q(),p=B(),o=c,u=L(),d=window.bootstrap,t=X({loaded:!1,title:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),n=y(()=>p.getSection(o.courseId,o.chapterId,o.sectionId)),a=y(()=>s.query.mode||"post"),I=()=>{document.querySelectorAll('[data-bs-toggle="popover"]').forEach(m=>{const v=d.Popover.getInstance(m);v&&v.dispose()})},i=m=>{var v;if(m.tagName.toLowerCase()==="a"){const _=m;if(_.getAttribute("data-bs-toggle")){const g=_.textContent;if(g){const T=g.replace("[","").replace("]","");if(R.isNumeric(T)){const E=window.Number.parseInt(T)-1,N=(v=n.value)==null?void 0:v.sources[E];N&&(_.setAttribute("data-bs-content",N),new d.Popover(_).show())}}}}},l=m=>{i(m.target)},h=m=>{I()};return ne(async()=>{const m=p.getCourse(o.courseId);if(m){const v=p.getChapter(o.courseId,o.chapterId);if(v){const _=n.value;if(_){const{html:g}=await _.read();t.loaded=!0,t.title=_.title,t.videoUrl=_.videoUrl,t.content=R.linkify(g),t.created=_.created,t.updated=_.updated,t.courseTitle=m.title,t.chapterTitle=v.title,t.sources=_.sources,t.references=_.references,o.onContentLoaded()}}}}),G(()=>{document.addEventListener("click",l),document.addEventListener("mousedown",h)}),K(()=>{document.removeEventListener("click",l),document.removeEventListener("mousedown",h)}),(m,v)=>{const _=H("router-link");return r(),f("div",{class:D(["section-core",{skeleton:!t.loaded}]),ref_key:"rootRef",ref:u},[a.value==="presentation"?(r(),x(Be,{key:0,title:t.title,content:t.content,sources:t.sources,references:t.references,created:t.created,updated:t.updated,skeleton:!t.loaded},null,8,["title","content","sources","references","created","updated","skeleton"])):(r(),f(A,{key:1},[S(ee,{title:t.title,created:t.created,updated:t.updated},{default:M(()=>[S(_,{to:`/courses/${o.courseId}`,class:"d-none d-md-flex"},{default:M(()=>v[0]||(v[0]=[e("img",{src:de,alt:"강의 메인"},null,-1),e("div",null,"강의 메인",-1)])),_:1},8,["to"]),S(_,{to:"?mode=presentation"},{default:M(()=>v[1]||(v[1]=[e("img",{src:ue,alt:"발표 열기"},null,-1),e("div",null,"발표 화면",-1)])),_:1})]),_:1},8,["title","created","updated"]),t.videoUrl!==null?(r(),f("div",Oe,[S(_e,{url:t.videoUrl,skeleton:!t.loaded},null,8,["url","skeleton"])])):w("",!0),e("div",We,[S(Y,{content:t.content,skeleton:!t.loaded},null,8,["content","skeleton"])])],64))],2)}}}),Ve=C(ze,[["__scopeId","data-v-3cf731ef"]]),Fe="/assets/images/common.angle.left.svg",je="/assets/images/common.angle.right.svg",Je={class:"wrapper"},Ge={class:"title"},Ke={class:"title"},Xe=b({__name:"SectionNavigation",props:{courseId:{},chapterId:{},sectionId:{}},setup(c){const s=c,p=B(),o=P(()=>{var a;const t=[];return(((a=p.getCourse(s.courseId))==null?void 0:a.chapters)||[]).forEach(I=>{I.sections.forEach(i=>{t.push({id:i.id,title:i.title,url:`/courses/${s.courseId}/${I.id}/${i.id}`})})}),t}),u=P(()=>{let t=null;const n=o.value;for(let a=0;a<n.length;a++)n[a].id===s.sectionId&&(t=n[a-1]);return t}),d=P(()=>{let t=null;const n=o.value;for(let a=0;a<n.length;a++)n[a].id===s.sectionId&&(t=n[a+1]);return t});return(t,n)=>{const a=H("router-link");return r(),f("div",{class:D(["section-navigation",{both:k(u)&&k(d)}])},[e("div",Je,[k(u)?(r(),x(a,{key:0,to:k(u).url||"",class:"item prev",title:k(u).title},{default:M(()=>[n[0]||(n[0]=e("div",{class:"label"},[e("img",{src:Fe,alt:"이전"}),e("span",null,"이전")],-1)),e("div",Ge,$(k(u).title),1)]),_:1},8,["to","title"])):w("",!0),k(d)?(r(),x(a,{key:1,to:k(d).url,class:"item next",title:k(d).title},{default:M(()=>[n[1]||(n[1]=e("div",{class:"label"},[e("img",{src:je,alt:"다음"}),e("span",null,"다음")],-1)),e("div",Ke,$(k(d).title),1)]),_:1},8,["to","title"])):w("",!0)])],2)}}}),Ye=C(Xe,[["__scopeId","data-v-40bf161a"]]),Qe={class:"section"},Ze={class:"container"},et={class:"wrapper"},tt={class:"main"},st={key:0,class:"sources"},ot={key:1,class:"references"},nt={class:"navigation"},rt=b({__name:"Section",setup(c){const s=re(),p=ce(),o=B(),u=q(),d=L(),t=L(),n=L(),a=X({contentLoaded:!1}),I=y(()=>{var g;return(g=u.params.courseId)==null?void 0:g.toString()}),i=y(()=>{var g;return(g=u.params.chapterId)==null?void 0:g.toString()}),l=y(()=>{var g;return(g=u.params.sectionId)==null?void 0:g.toString()}),h=y(()=>o.getCourse(I.value)),m=y(()=>o.getSection(I.value,i.value,l.value)),v=g=>{var T;s.windowSize.width<=1399||n.value&&n.value.scrollTo({top:g-n.value.offsetTop-(((T=t.value)==null?void 0:T.offsetHeight)||0),behavior:"smooth"})},_=()=>{a.contentLoaded=!0};return(g,T)=>{var E,N,W,z;const O=H("router-link");return r(),f("div",Qe,[e("div",Ze,[e("div",et,[e("div",tt,[e("div",{class:"core",ref_key:"coreRef",ref:d},[(r(),x(Ve,{courseId:I.value,chapterId:i.value,sectionId:l.value,key:l.value,onContentLoaded:_},null,8,["courseId","chapterId","sectionId"]))],512),(N=(E=m.value)==null?void 0:E.sources)!=null&&N.length?(r(),f("div",st,[S(Q,{sources:m.value.sources},null,8,["sources"])])):w("",!0),(z=(W=m.value)==null?void 0:W.references)!=null&&z.length?(r(),f("div",ot,[S(Z,{references:m.value.references},null,8,["references"])])):w("",!0),e("div",nt,[S(Ye,{courseId:I.value,chapterId:i.value,sectionId:l.value},null,8,["courseId","chapterId","sectionId"])])]),a.contentLoaded?(r(),f("div",{key:0,class:"chapters",ref_key:"chaptersRef",ref:n,style:ae({height:k(p).mainHeight})},[e("div",{class:"top",ref_key:"chaptersTopRef",ref:t},[S(O,{to:`/courses/${I.value}`,class:"btn"},{default:M(()=>{var V;return[T[0]||(T[0]=e("img",{src:le},null,-1)),e("span",null,$((V=h.value)==null?void 0:V.title),1)]}),_:1},8,["to"])],512),S(ie,{courseId:I.value,chapterId:i.value,sectionId:l.value,theme:"light",onScrollable:v},null,8,["courseId","chapterId","sectionId"])],4)):w("",!0)])])])}}}),dt=C(rt,[["__scopeId","data-v-df1f0cf0"]]);export{dt as default};
