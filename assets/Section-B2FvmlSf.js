import{f as w,m as L,c as _,n as N,b as t,o as l,_ as T,F as R,g as H,t as S,u as I,j as k,p as ee,q as P,s as b,i as q,v as K,h as x,T as te,d as g,w as C,l as oe,r as E,x as J,k as se,y as ne,z as D,A as re,B as ce,C as ae}from"./index-DjD7XN-s.js";import{u as O}from"./useSection-DwyXahoM.js";import{C as ie}from"./Chapters-D1_EgBD5.js";import"./courses-DX4LenKA.js";const le="/assets/images/common.home.white.svg",de="/assets/images/component.section.core.main.svg",ue="/assets/images/component.section.core.presentation.open.svg",M={renew(c){return JSON.parse(JSON.stringify(c))},linkify(c){const o=/(\bhttps?:\/\/[^\s<>"')\]]+)/g;return c.replace(o,(p,s)=>c.includes(`<a href="${s}"`)||c.includes(`<a href='${s}'`)?p:`<a href="${s}" target="_blank" rel="noopener noreferrer">${s}</a>`)},replaceAll(c,o,p){return c.split(o).join(p)},isNumeric(c){return!isNaN(Number(c))},generateDomId(){return window.crypto.randomUUID()},getHumanReadableDate(c){const o=new Date(c.replace(" ","T")),s=new Date().getTime()-o.getTime(),m=Math.floor(s/1e3),f=Math.floor(m/60),e=Math.floor(f/60),a=Math.floor(e/24),i=Math.floor(a/30),v=Math.floor(a/365);return isNaN(o.getTime())?"(N/A)":m<60?"방금 전":f<60?`${f}분 전`:e<24?`${e}시간 전`:a<30?`${a}일 전`:i<12?`${i}개월 전`:`${v}년 전`}},pe=["innerHTML"],_e=w({__name:"SectionContent",props:{content:{},skeleton:{type:Boolean}},setup(c){const o=c,p=L();return(s,m)=>(l(),_("div",{class:N(["section-core-content",{skeleton:o.skeleton}]),ref_key:"rootRef",ref:p},[t("div",{innerHTML:o.content},null,8,pe)],2))}}),G=T(_e,[["__scopeId","data-v-7741b346"]]),me=w({__name:"SectionVideo",props:{url:{},skeleton:{type:Boolean}},setup(c){const o=c;return(p,s)=>(l(),_("div",{class:N(["section-core-video",{skeleton:o.skeleton}])},s[0]||(s[0]=[t("div",{class:"wrapper"},[t("div",{class:"inner"})],-1)]),2))}}),fe=T(me,[["__scopeId","data-v-eea266e5"]]),ve="/assets/images/component.section.core.presentation.position.svg",he="/assets/images/component.section.core.presentation.close.svg",ge="/assets/images/component.section.core.presentation.finish.svg",Ie={class:"section-sources"},ye={class:"items"},ke={class:"item"},Se=["innerHTML"],$e=w({__name:"SectionSources",props:{sources:{}},setup(c){const o=c;return(p,s)=>(l(),_("div",Ie,[s[0]||(s[0]=t("div",{class:"subject"},"콘텐츠 출처",-1)),t("div",ye,[(l(!0),_(R,null,H(o.sources,(m,f)=>(l(),_("div",ke,[t("span",null,"["+S(f+1)+"] ",1),t("span",{innerHTML:I(M).linkify(m)},null,8,Se)]))),256))])]))}}),X=T($e,[["__scopeId","data-v-663e43b7"]]),be={class:"section-references"},we={class:"items"},Te={class:"item"},Ce=w({__name:"SectionReferences",props:{references:{}},setup(c){const o=c;return(p,s)=>(l(),_("div",be,[s[0]||(s[0]=t("div",{class:"subject"},"참고 자료",-1)),t("div",we,[(l(!0),_(R,null,H(o.references,m=>(l(),_("div",Te,[t("span",null,S(m),1)]))),256))])]))}}),Y=T(Ce,[["__scopeId","data-v-032f39d2"]]),xe={class:"section-header"},Me={class:"wrapper"},Ae={class:"title"},Le={class:"date"},Re=["title"],Ne=["title"],Ee={class:"side"},De=w({__name:"SectionHeader",props:{title:{},created:{},updated:{}},setup(c){const o=c;return(p,s)=>(l(),_("div",xe,[t("div",Me,[t("div",Ae,[t("span",null,S(o.title),1)]),t("div",Le,[t("span",{title:o.created}," 생성: "+S(I(M).getHumanReadableDate(o.created)),9,Re),o.created!==o.updated?(l(),_(R,{key:0},[s[0]||(s[0]=t("span",{class:"bar"},null,-1)),t("span",{title:o.updated}," 수정: "+S(I(M).getHumanReadableDate(o.updated)),9,Ne)],64)):k("",!0)])]),t("div",Ee,[ee(p.$slots,"default",{},void 0)])]))}}),Q=T(De,[["__scopeId","data-v-b404f3b0"]]),z=w({__name:"SectionPrompt",props:{content:{}},setup(c){const o=c;return P(()=>{console.info(o.content)}),(p,s)=>null}}),He={class:"hide-sm"},Pe={class:"container"},qe={key:0,class:"slide"},Oe={key:0,class:"slide finish"},Ue="이상 끝. 수고하셨습니다!",V="no-overflow",We=w({__name:"SectionPresentation",props:{title:{},created:{},updated:{},content:{},sources:{},references:{}},setup(c){const o=c,p=q(),s=oe(),m=L(null),f=`이렇게 해서 ${o.title}에 대해 알아봤습니다. 수고하셨습니다!`,e=b(()=>{const d=new DOMParser().parseFromString(o.content,"text/html");return Array.from(d.querySelectorAll(".slide-item")).map(n=>n.outerHTML)}),a=b(()=>{const d=new DOMParser().parseFromString(o.content,"text/html");return Array.from(d.querySelectorAll(".slide-text")).map(n=>M.replaceAll(n.outerText,"  ","").trim())}),i=b(()=>{var d;return window.Number.parseInt(((d=p.query.idx)==null?void 0:d.toString())||"0")}),v=()=>{const d=[];return e.value.length<a.value.length?d.unshift(a.value[a.value.length-1]):d.push(f),d.join(" ")},h=d=>{const n=M.renew(p.query);let u=i.value+d;u<0?u=0:u>e.value.length&&(u=e.value.length),i.value!==u&&(n.idx=u.toString(),s.push({query:n}))},$=d=>{switch(d.key){case"ArrowLeft":!d.altKey&&h(-1);break;case"ArrowRight":!d.altKey&&h(1);break;case"Escape":s.push({query:void 0});break}},A=d=>{const n=window.innerWidth,u=d.target;u.closest("[data-bs-toggle]")||u.closest("[href]")||(d.clientX<n/2?h(-1):h(1))};return P(()=>{document.addEventListener("keyup",$),document.body.classList.add(V)}),K(()=>{document.removeEventListener("keyup",$),document.body.classList.remove(V)}),(d,n)=>{const u=E("router-link");return l(),x(te,{to:"body"},[t("div",{class:"presentation",ref_key:"rootRef",ref:m},[g(Q,{title:o.title,created:o.created,updated:o.updated},{default:C(()=>[t("div",He,[n[0]||(n[0]=t("img",{src:ve,alt:"슬라이드 번호"},null,-1)),t("div",null,S(i.value+1)+" / "+S(e.value.length+1),1)]),g(u,{to:"?"},{default:C(()=>n[1]||(n[1]=[t("img",{src:he,alt:"발표 닫기"},null,-1),t("div",null,"발표 닫기",-1)])),_:1})]),_:1},8,["title","created","updated"]),t("div",{class:"slides",onClick:A},[t("div",Pe,[(l(!0),_(R,null,H(e.value,(r,y)=>(l(),_(R,null,[i.value===y?(l(),_("div",qe,[g(G,{content:r},null,8,["content"]),g(z,{content:a.value[y]||""},null,8,["content"])])):k("",!0)],64))),256)),i.value===e.value.length?(l(),_("div",Oe,[n[2]||(n[2]=t("img",{src:ge,loading:"lazy"},null,-1)),t("div",{class:"text"},S(Ue)),o.sources.length?(l(),x(X,{key:0,class:"w-100",sources:o.sources},null,8,["sources"])):k("",!0),o.references.length?(l(),x(Y,{key:1,class:"w-100",references:o.references},null,8,["references"])):k("",!0),g(z,{content:v()},null,8,["content"])])):k("",!0)])])],512)])}}}),Be=T(We,[["__scopeId","data-v-5b39971f"]]),Fe={key:0,class:"video"},je={class:"content"},ze=w({__name:"SectionCore",props:{courseId:{},chapterId:{},sectionId:{},onContentLoaded:{type:Function}},setup(c){const o=q(),p=O(),s=c,m=L(),f=window.bootstrap,e=J({loaded:!1,title:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),a=b(()=>p.getSection(s.courseId,s.chapterId,s.sectionId)),i=b(()=>o.query.mode||"post"),v=()=>{const n=new DOMParser().parseFromString(e.content,"text/html");Array.from(n.querySelectorAll("[data-bs-toggle='popover']")).forEach((r,y)=>{r.setAttribute("title","출처"),r.setAttribute("data-bs-content",M.linkify(e.sources[y])),r.innerText=`[${y+1}]`}),e.content=n.body.innerHTML},h=n=>{n.closest(".popover")||document.querySelectorAll('[data-bs-toggle="popover"]').forEach(u=>{const r=f.Popover.getInstance(u);r&&r.dispose()})},$=n=>{n.getAttribute("data-bs-toggle")&&new f.Popover(n,{html:!0}).show()},A=n=>{$(n.target)},d=n=>{h(n.target)};return se(async()=>{const n=p.getCourse(s.courseId);if(n){const u=p.getChapter(s.courseId,s.chapterId);if(u){const r=a.value;if(r){const{html:y}=await r.read();e.title=r.title,e.videoUrl=r.videoUrl,e.content=M.linkify(y),e.created=r.created,e.updated=r.updated,e.courseTitle=n.title,e.chapterTitle=u.title,e.sources=r.sources,e.references=r.references,v(),ne(()=>{e.loaded=!0,s.onContentLoaded()})}}}}),P(()=>{document.addEventListener("click",A),document.addEventListener("mousedown",d)}),K(()=>{document.removeEventListener("click",A),document.removeEventListener("mousedown",d)}),(n,u)=>{const r=E("router-link");return l(),_("div",{class:N(["section-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:m},[i.value==="presentation"&&e.loaded?(l(),x(Be,{key:0,title:e.title,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","content","sources","references","created","updated"])):(l(),_(R,{key:1},[g(Q,{title:e.title,created:e.created,updated:e.updated},{default:C(()=>[g(r,{to:`/courses/${s.courseId}`,class:"d-none d-md-flex"},{default:C(()=>u[0]||(u[0]=[t("img",{src:de,alt:"강의 메인"},null,-1),t("div",null,"강의 메인",-1)])),_:1},8,["to"]),g(r,{to:"?mode=presentation"},{default:C(()=>u[1]||(u[1]=[t("img",{src:ue,alt:"발표 열기"},null,-1),t("div",null,"발표 화면",-1)])),_:1})]),_:1},8,["title","created","updated"]),e.videoUrl!==null?(l(),_("div",Fe,[g(fe,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):k("",!0),t("div",je,[g(G,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])],64))],2)}}}),Ve=T(ze,[["__scopeId","data-v-8684d806"]]),Ke="/assets/images/common.angle.left.svg",Je="/assets/images/common.angle.right.svg",Ge={class:"wrapper"},Xe={class:"title"},Ye={class:"title"},Qe=w({__name:"SectionNavigation",props:{courseId:{},chapterId:{},sectionId:{}},setup(c){const o=c,p=O(),s=D(()=>{var i;const e=[];return(((i=p.getCourse(o.courseId))==null?void 0:i.chapters)||[]).forEach(v=>{v.sections.forEach(h=>{e.push({id:h.id,title:h.title,url:`/courses/${o.courseId}/${v.id}/${h.id}`})})}),e}),m=D(()=>{let e=null;const a=s.value;for(let i=0;i<a.length;i++)a[i].id===o.sectionId&&(e=a[i-1]);return e}),f=D(()=>{let e=null;const a=s.value;for(let i=0;i<a.length;i++)a[i].id===o.sectionId&&(e=a[i+1]);return e});return(e,a)=>{const i=E("router-link");return l(),_("div",{class:N(["section-navigation",{both:I(m)&&I(f)}])},[t("div",Ge,[I(m)?(l(),x(i,{key:0,to:I(m).url||"",class:"item prev",title:I(m).title},{default:C(()=>[a[0]||(a[0]=t("div",{class:"label"},[t("img",{src:Ke,alt:"이전"}),t("span",null,"이전")],-1)),t("div",Xe,S(I(m).title),1)]),_:1},8,["to","title"])):k("",!0),I(f)?(l(),x(i,{key:1,to:I(f).url,class:"item next",title:I(f).title},{default:C(()=>[a[1]||(a[1]=t("div",{class:"label"},[t("img",{src:Je,alt:"다음"}),t("span",null,"다음")],-1)),t("div",Ye,S(I(f).title),1)]),_:1},8,["to","title"])):k("",!0)])],2)}}}),Ze=T(Qe,[["__scopeId","data-v-40bf161a"]]),et={class:"section"},tt={class:"container"},ot={class:"wrapper"},st={class:"main"},nt={key:0,class:"sources"},rt={key:1,class:"references"},ct={class:"navigation"},at=w({__name:"Section",setup(c){const o=re(),p=ce(),s=O(),m=q(),f=L(),e=L(),a=L(),i=J({contentLoaded:!1}),v=b(()=>{var r;return(r=m.params.courseId)==null?void 0:r.toString()}),h=b(()=>{var r;return(r=m.params.chapterId)==null?void 0:r.toString()}),$=b(()=>{var r;return(r=m.params.sectionId)==null?void 0:r.toString()}),A=b(()=>s.getCourse(v.value)),d=b(()=>s.getSection(v.value,h.value,$.value)),n=r=>{var y;o.windowSize.width<=1399||a.value&&a.value.scrollTo({top:r-a.value.offsetTop-(((y=e.value)==null?void 0:y.offsetHeight)||0),behavior:"smooth"})},u=()=>{i.contentLoaded=!0};return(r,y)=>{var U,W,B,F;const Z=E("router-link");return l(),_("div",et,[t("div",tt,[t("div",ot,[t("div",st,[t("div",{class:"core",ref_key:"coreRef",ref:f},[(l(),x(Ve,{courseId:v.value,chapterId:h.value,sectionId:$.value,key:$.value,onContentLoaded:u},null,8,["courseId","chapterId","sectionId"]))],512),(W=(U=d.value)==null?void 0:U.sources)!=null&&W.length?(l(),_("div",nt,[g(X,{sources:d.value.sources},null,8,["sources"])])):k("",!0),(F=(B=d.value)==null?void 0:B.references)!=null&&F.length?(l(),_("div",rt,[g(Y,{references:d.value.references},null,8,["references"])])):k("",!0),t("div",ct,[g(Ze,{courseId:v.value,chapterId:h.value,sectionId:$.value},null,8,["courseId","chapterId","sectionId"])])]),i.contentLoaded?(l(),_("div",{key:0,class:"chapters",ref_key:"chaptersRef",ref:a,style:ae({height:I(p).mainHeight})},[t("div",{class:"top",ref_key:"chaptersTopRef",ref:e},[g(Z,{to:`/courses/${v.value}`,class:"btn"},{default:C(()=>{var j;return[y[0]||(y[0]=t("img",{src:le},null,-1)),t("span",null,S((j=A.value)==null?void 0:j.title),1)]}),_:1},8,["to"])],512),g(ie,{courseId:v.value,chapterId:h.value,sectionId:$.value,theme:"light",onScrollable:n},null,8,["courseId","chapterId","sectionId"])],4)):k("",!0)])])])}}}),pt=T(at,[["__scopeId","data-v-df1f0cf0"]]);export{pt as default};
