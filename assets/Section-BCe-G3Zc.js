import{f as w,q as L,c as m,s as E,b as t,o as a,_ as T,F as R,g as P,t as $,u as S,m as k,v as te,k as q,x as b,j as O,l as J,h as x,T as oe,d as I,w as C,p as se,r as D,i as G,y as X,n as ne,z as re,A as ce,B as H,C as ae,D as ie}from"./index-DzQTO5n7.js";import{u as U}from"./useSection-CnSCw0KP.js";import{C as le}from"./Chapters-W6rP79Wk.js";import"./courses-DCptgTIH.js";const de="/assets/images/common.home.white.svg",ue="/assets/images/component.section.core.main.svg",pe="/assets/images/component.section.core.presentation.open.svg",M={renew(r){return JSON.parse(JSON.stringify(r))},linkify(r){const o=/(\bhttps?:\/\/[^\s<>"')\]]+)/g;return r.replace(o,(_,s)=>r.includes(`<a href="${s}"`)||r.includes(`<a href='${s}'`)?_:`<a href="${s}" target="_blank" rel="noopener noreferrer">${s}</a>`)},replaceAll(r,o,_){return r.split(o).join(_)},isNumeric(r){return!isNaN(Number(r))},generateDomId(){return window.crypto.randomUUID()},getHumanReadableDate(r){const o=new Date(r.replace(" ","T")),s=new Date().getTime()-o.getTime(),i=Math.floor(s/1e3),v=Math.floor(i/60),u=Math.floor(v/60),e=Math.floor(u/24),c=Math.floor(e/30),h=Math.floor(e/365);return isNaN(o.getTime())?"(N/A)":i<60?"방금 전":v<60?`${v}분 전`:u<24?`${u}시간 전`:e<30?`${e}일 전`:c<12?`${c}개월 전`:`${h}년 전`}},me=["innerHTML"],_e=w({__name:"SectionContent",props:{content:{},skeleton:{type:Boolean}},setup(r){const o=r,_=L();return(s,i)=>(a(),m("div",{class:E(["section-core-content",{skeleton:o.skeleton}]),ref_key:"rootRef",ref:_},[t("div",{innerHTML:o.content},null,8,me)],2))}}),Y=T(_e,[["__scopeId","data-v-7741b346"]]),fe=w({__name:"SectionVideo",props:{url:{},skeleton:{type:Boolean}},setup(r){const o=r;return(_,s)=>(a(),m("div",{class:E(["section-core-video",{skeleton:o.skeleton}])},s[0]||(s[0]=[t("div",{class:"wrapper"},[t("div",{class:"inner"})],-1)]),2))}}),ve=T(fe,[["__scopeId","data-v-eea266e5"]]),he="/assets/images/component.section.core.presentation.position.svg",ge="/assets/images/component.section.core.presentation.close.svg",Ie="/assets/images/component.section.core.presentation.finish.svg",Se={class:"section-sources"},ye={class:"items"},ke={class:"item"},$e=["innerHTML"],be=w({__name:"SectionSources",props:{sources:{}},setup(r){const o=r;return(_,s)=>(a(),m("div",Se,[s[0]||(s[0]=t("div",{class:"subject"},"자료 출처",-1)),t("div",ye,[(a(!0),m(R,null,P(o.sources,(i,v)=>(a(),m("div",ke,[t("span",null,"["+$(v+1)+"] ",1),t("span",{innerHTML:S(M).linkify(i)},null,8,$e)]))),256))])]))}}),Q=T(be,[["__scopeId","data-v-788a8476"]]),we={class:"section-references"},Te={class:"items"},Ce={class:"item"},xe=w({__name:"SectionReferences",props:{references:{}},setup(r){const o=r;return(_,s)=>(a(),m("div",we,[s[0]||(s[0]=t("div",{class:"subject"},"참고 자료",-1)),t("div",Te,[(a(!0),m(R,null,P(o.references,i=>(a(),m("div",Ce,[t("span",null,$(i),1)]))),256))])]))}}),Z=T(xe,[["__scopeId","data-v-032f39d2"]]),Me={class:"section-header"},Ae={class:"wrapper"},Le={class:"title"},Re={class:"date"},Ne=["title"],Ee=["title"],De={class:"side"},He=w({__name:"SectionHeader",props:{title:{},created:{},updated:{}},setup(r){const o=r;return(_,s)=>(a(),m("div",Me,[t("div",Ae,[t("div",Le,[t("span",null,$(o.title),1)]),t("div",Re,[t("span",{title:o.created}," 생성: "+$(S(M).getHumanReadableDate(o.created)),9,Ne),o.created!==o.updated?(a(),m(R,{key:0},[s[0]||(s[0]=t("span",{class:"bar"},null,-1)),t("span",{title:o.updated}," 수정: "+$(S(M).getHumanReadableDate(o.updated)),9,Ee)],64)):k("",!0)])]),t("div",De,[te(_.$slots,"default",{},void 0)])]))}}),ee=T(He,[["__scopeId","data-v-abc48255"]]),V=w({__name:"SectionPrompt",props:{content:{}},setup(r){const o=r;return q(()=>{console.info(o.content)}),(_,s)=>null}}),Pe={class:"hide-sm",title:"슬라이드 번호"},qe={class:"container"},Oe={key:0,class:"slide"},Ue={key:0,class:"slide finish"},Be="이상 끝. 수고하셨습니다!",K="no-overflow",We=w({__name:"SectionPresentation",props:{title:{},created:{},updated:{},content:{},sources:{},references:{}},setup(r){const o=r,_=O(),s=se(),i=L(null),v=`이렇게 해서 ${o.title}에 대해 알아봤습니다. 수고하셨습니다!`,u=b(()=>{const l=new DOMParser().parseFromString(o.content,"text/html");return Array.from(l.querySelectorAll(".slide-item")).map(f=>f.outerHTML)}),e=b(()=>{const l=new DOMParser().parseFromString(o.content,"text/html");return Array.from(l.querySelectorAll(".slide-text")).map(f=>M.replaceAll(f.outerText,"  ","").trim())}),c=b(()=>{var l;return window.Number.parseInt(((l=_.query.idx)==null?void 0:l.toString())||"0")}),h=()=>{const l=[];return u.value.length<e.value.length?l.unshift(e.value[e.value.length-1]):l.push(v),l.join(" ")},g=l=>{const f=M.renew(_.query);let n=c.value+l;n<0?n=0:n>u.value.length&&(n=u.value.length),c.value!==n&&(f.idx=n.toString(),s.push({query:f}))},y=l=>{switch(l.key){case"ArrowLeft":!l.altKey&&g(-1);break;case"ArrowRight":!l.altKey&&g(1);break;case"Escape":s.push({query:void 0});break}},N=l=>{const f=window.innerWidth,n=l.target;n.closest("[data-bs-toggle]")||n.closest("[href]")||(l.clientX<f/2?g(-1):g(1))};return q(()=>{document.addEventListener("keyup",y),document.body.classList.add(K)}),J(()=>{document.removeEventListener("keyup",y),document.body.classList.remove(K)}),(l,f)=>{const n=D("router-link");return a(),x(oe,{to:"body"},[t("div",{class:"presentation",ref_key:"rootRef",ref:i},[I(ee,{title:o.title,created:o.created,updated:o.updated},{default:C(()=>[t("div",Pe,[f[0]||(f[0]=t("img",{src:he,alt:"슬라이드 번호"},null,-1)),t("div",null,$(c.value+1)+" / "+$(u.value.length+1),1)]),I(n,{to:"?"},{default:C(()=>f[1]||(f[1]=[t("img",{src:ge,alt:"닫기"},null,-1),t("div",null,"닫기",-1)])),_:1})]),_:1},8,["title","created","updated"]),t("div",{class:"slides",onClick:N},[t("div",qe,[(a(!0),m(R,null,P(u.value,(p,d)=>(a(),m(R,null,[c.value===d?(a(),m("div",Oe,[I(Y,{content:p},null,8,["content"]),I(V,{content:e.value[d]||""},null,8,["content"])])):k("",!0)],64))),256)),c.value===u.value.length?(a(),m("div",Ue,[f[2]||(f[2]=t("img",{src:Ie,loading:"lazy"},null,-1)),t("div",{class:"text"},$(Be)),o.sources.length?(a(),x(Q,{key:0,class:"w-100",sources:o.sources},null,8,["sources"])):k("",!0),o.references.length?(a(),x(Z,{key:1,class:"w-100",references:o.references},null,8,["references"])):k("",!0),I(V,{content:h()},null,8,["content"])])):k("",!0)])])],512)])}}}),Fe=T(We,[["__scopeId","data-v-3ee1adf6"]]),je={key:0,class:"video"},ze={class:"content"},Ve=w({__name:"SectionCore",props:{courseId:{},chapterId:{},sectionId:{},onContentLoaded:{type:Function}},setup(r){const o=G(),_=O(),s=U(),i=r,v=L(),u=window.bootstrap,e=X({loaded:!1,title:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),c=b(()=>s.getSection(i.courseId,i.chapterId,i.sectionId)),h=b(()=>_.query.mode||"post"),g=()=>{const n=new DOMParser().parseFromString(e.content,"text/html");Array.from(n.querySelectorAll("[data-bs-toggle='popover']")).forEach((d,A)=>{d.setAttribute("title","출처"),d.setAttribute("data-bs-content",M.linkify(e.sources[A])),d.innerText=`[${A+1}]`}),e.content=n.body.innerHTML},y=n=>{n!=null&&n.closest(".popover")||document.querySelectorAll('[data-bs-toggle="popover"]').forEach(p=>{const d=u.Popover.getInstance(p);d&&d.dispose()})},N=n=>{n.getAttribute("data-bs-toggle")&&new u.Popover(n,{html:!0}).show()},l=n=>{N(n.target)},f=n=>{y(n.target)};return ne(async()=>{const n=s.getCourse(i.courseId);if(n){const p=s.getChapter(i.courseId,i.chapterId);if(p){const d=c.value;if(d){const{html:A}=await d.read();e.title=d.title,e.videoUrl=d.videoUrl,e.content=M.linkify(A),e.created=d.created,e.updated=d.updated,e.courseTitle=n.title,e.chapterTitle=p.title,e.sources=d.sources,e.references=d.references,g(),ce(()=>{e.loaded=!0,i.onContentLoaded()}),o.updateSiteTitle(e.title)}}}}),q(()=>{y(),document.addEventListener("click",l),document.addEventListener("mousedown",f)}),re(()=>{y()}),J(()=>{o.updateSiteTitle(),document.removeEventListener("click",l),document.removeEventListener("mousedown",f)}),(n,p)=>{const d=D("router-link");return a(),m("div",{class:E(["section-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:v},[h.value==="presentation"&&e.loaded?(a(),x(Fe,{key:0,title:e.title,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","content","sources","references","created","updated"])):(a(),m(R,{key:1},[I(ee,{title:e.title,created:e.created,updated:e.updated},{default:C(()=>[I(d,{to:`/courses/${i.courseId}`,class:"d-none d-md-flex"},{default:C(()=>p[0]||(p[0]=[t("img",{src:ue,alt:"이전"},null,-1),t("div",null,"이전",-1)])),_:1},8,["to"]),I(d,{to:"?mode=presentation"},{default:C(()=>p[1]||(p[1]=[t("img",{src:pe,alt:"발표"},null,-1),t("div",null,"발표",-1)])),_:1})]),_:1},8,["title","created","updated"]),e.videoUrl!==null?(a(),m("div",je,[I(ve,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):k("",!0),t("div",ze,[I(Y,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])],64))],2)}}}),Ke=T(Ve,[["__scopeId","data-v-55b5a939"]]),Je="/assets/images/common.angle.left.svg",Ge="/assets/images/common.angle.right.svg",Xe={class:"wrapper"},Ye={class:"title"},Qe={class:"title"},Ze=w({__name:"SectionNavigation",props:{courseId:{},chapterId:{},sectionId:{}},setup(r){const o=r,_=U(),s=H(()=>{var c;const u=[];return(((c=_.getCourse(o.courseId))==null?void 0:c.chapters)||[]).forEach(h=>{h.sections.forEach(g=>{u.push({id:g.id,title:g.title,url:`/courses/${o.courseId}/${h.id}/${g.id}`})})}),u}),i=H(()=>{let u=null;const e=s.value;for(let c=0;c<e.length;c++)e[c].id===o.sectionId&&(u=e[c-1]);return u}),v=H(()=>{let u=null;const e=s.value;for(let c=0;c<e.length;c++)e[c].id===o.sectionId&&(u=e[c+1]);return u});return(u,e)=>{const c=D("router-link");return a(),m("div",{class:E(["section-navigation",{both:S(i)&&S(v)}])},[t("div",Xe,[S(i)?(a(),x(c,{key:0,to:S(i).url||"",class:"item prev",title:S(i).title},{default:C(()=>[e[0]||(e[0]=t("div",{class:"label"},[t("img",{src:Je,alt:"이전"}),t("span",null,"이전")],-1)),t("div",Ye,$(S(i).title),1)]),_:1},8,["to","title"])):k("",!0),S(v)?(a(),x(c,{key:1,to:S(v).url,class:"item next",title:S(v).title},{default:C(()=>[e[1]||(e[1]=t("div",{class:"label"},[t("img",{src:Ge,alt:"다음"}),t("span",null,"다음")],-1)),t("div",Qe,$(S(v).title),1)]),_:1},8,["to","title"])):k("",!0)])],2)}}}),et=T(Ze,[["__scopeId","data-v-40bf161a"]]),tt={class:"section"},ot={class:"container"},st={class:"wrapper"},nt={class:"main"},rt={key:0,class:"sources"},ct={key:1,class:"references"},at={class:"navigation"},it=w({__name:"Section",setup(r){const o=G(),_=ae(),s=U(),i=O(),v=L(),u=L(),e=L(),c=X({contentLoaded:!1}),h=b(()=>{var p;return(p=i.params.courseId)==null?void 0:p.toString()}),g=b(()=>{var p;return(p=i.params.chapterId)==null?void 0:p.toString()}),y=b(()=>{var p;return(p=i.params.sectionId)==null?void 0:p.toString()}),N=b(()=>s.getCourse(h.value)),l=b(()=>s.getSection(h.value,g.value,y.value)),f=p=>{var d;o.windowSize.width<=1399||e.value&&e.value.scrollTo({top:p-e.value.offsetTop-(((d=u.value)==null?void 0:d.offsetHeight)||0),behavior:"smooth"})},n=()=>{c.contentLoaded=!0};return(p,d)=>{var B,W,F,j;const A=D("router-link");return a(),m("div",tt,[t("div",ot,[t("div",st,[t("div",nt,[t("div",{class:"core",ref_key:"coreRef",ref:v},[(a(),x(Ke,{courseId:h.value,chapterId:g.value,sectionId:y.value,key:y.value,onContentLoaded:n},null,8,["courseId","chapterId","sectionId"]))],512),(W=(B=l.value)==null?void 0:B.sources)!=null&&W.length?(a(),m("div",rt,[I(Q,{sources:l.value.sources},null,8,["sources"])])):k("",!0),(j=(F=l.value)==null?void 0:F.references)!=null&&j.length?(a(),m("div",ct,[I(Z,{references:l.value.references},null,8,["references"])])):k("",!0),t("div",at,[I(et,{courseId:h.value,chapterId:g.value,sectionId:y.value},null,8,["courseId","chapterId","sectionId"])])]),c.contentLoaded?(a(),m("div",{key:0,class:"chapters",ref_key:"chaptersRef",ref:e,style:ie({height:S(_).mainHeight})},[t("div",{class:"top",ref_key:"chaptersTopRef",ref:u},[I(A,{to:`/courses/${h.value}`,class:"btn"},{default:C(()=>{var z;return[d[0]||(d[0]=t("img",{src:de},null,-1)),t("span",null,$((z=N.value)==null?void 0:z.title),1)]}),_:1},8,["to"])],512),I(le,{courseId:h.value,chapterId:g.value,sectionId:y.value,theme:"light",onScrollable:f},null,8,["courseId","chapterId","sectionId"])],4)):k("",!0)])])])}}}),mt=T(it,[["__scopeId","data-v-df1f0cf0"]]);export{mt as default};
