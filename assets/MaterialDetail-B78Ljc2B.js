import{d as T,g as y,c as r,b as s,F as S,r as P,t as q,u as g,o as n,_ as E,n as O,i as U,h as R,j as X,k as I,f as $,l as M,T as oe,m as Z,p as N,q as re,s as Y,v as ee,w as le,x as ce,y as ie,z as j,A as ue,B as F,C as H,D as K,E as te}from"./index-CAWFZN0U.js";import{u as z,M as J}from"./material-6FQO-4fg.js";import{c as x}from"./commonLib-Co9BQnS0.js";import{C as de}from"./CryptoHelper-m6j8gmxG.js";import{_ as me,a as pe,b as _e}from"./common.arrow.left-TSorRx6s.js";import{r as ve}from"./routeLib-DhAZaWiT.js";import{A as he}from"./Above-BEnbSoSw.js";import"./Panel-DEGzabwS.js";const fe={class:"common-sources"},ge={class:"items"},ye=["innerHTML"],ke=T({__name:"MaterialSources",props:{sources:{}},setup(h){const t=h,c=y(()=>{const p=new Map;return t.sources.forEach((o,i)=>{p.has(o)||p.set(o,[]),p.get(o).push(i+1)}),Array.from(p.entries()).map(([o,i])=>({indexes:i,src:o}))});return(p,o)=>(n(),r("div",fe,[o[1]||(o[1]=s("div",{class:"subject"},"자료 출처",-1)),s("div",ge,[(n(!0),r(S,null,P(c.value,i=>(n(),r("div",{class:"item",key:i.src},[(n(!0),r(S,null,P(i.indexes,v=>(n(),r("span",null,"["+q(v)+"]",1))),256)),o[0]||(o[0]=s("span",null," ",-1)),s("span",{innerHTML:g(x).linkify(i.src)},null,8,ye)]))),128))])]))}}),se=E(ke,[["__scopeId","data-v-a34ac84b"]]),$e={class:"common-references"},be={class:"items"},we={class:"item"},xe=T({__name:"MaterialReferences",props:{references:{}},setup(h){const t=h;return(c,p)=>(n(),r("div",$e,[p[0]||(p[0]=s("div",{class:"subject"},"참고 자료",-1)),s("div",be,[(n(!0),r(S,null,P(t.references,o=>(n(),r("div",we,[s("span",null,q(o),1)]))),256))])]))}}),ne=E(xe,[["__scopeId","data-v-64c8b31c"]]),Me={key:0},Te=["innerHTML"],Le=T({__name:"DocumentContent",props:{document:{},skeleton:{type:Boolean}},setup(h){const t=h;return(c,p)=>(n(),r("div",{class:O(["document-content",{skeleton:t.skeleton}])},[c.skeleton?(n(),r("div",Me)):(n(),r("div",{key:1,innerHTML:t.document,ref:"contentRef"},null,8,Te))],2))}}),ae=E(Le,[["__scopeId","data-v-9c772213"]]),Se="/assets/images/component.document.presentation.slide.first.svg",Ee="/assets/images/component.material.presentation.finish.svg",B=T({__name:"DocumentPrompt",props:{content:{}},setup(h){const t=h;return U(()=>{console.info(t.content.replace(/\n{3,}/g,`

`))}),(c,p)=>null}}),Ae={class:"presentation"},Ce={class:"slides"},De={key:0,class:"slide start"},Ie={class:"container"},qe={class:"slide-item"},He=["innerHTML"],Pe={key:1,class:"slide finish"},Re={class:"container"},Ne={key:0,class:"slide"},je={class:"container"},Q="no-overflow",Fe=T({__name:"MaterialPresentation",props:{material:{},document:{}},setup(h){const t={touchStartX:0,touchStartY:0},c=h,p=R(),o=Z(),i=`이렇게 해서 ${x.extractText(c.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,v=y(()=>c.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),a=y(()=>{const d=[c.material.desc];return l.value.length===0&&e.value.length===1&&d.push(e.value[0]),d.join("")}),l=y(()=>{const d=new DOMParser().parseFromString(c.document,"text/html");return Array.from(d.querySelectorAll(".slide-item")).map(m=>m.outerHTML)}),e=y(()=>{const d=[],m={},w=new DOMParser().parseFromString(c.document,"text/html");Array.from(w.querySelectorAll(".slide-text")).forEach(L=>{const D=L.getAttribute("data-slide-text-group");D&&(!m[D]&&(m[D]=[]),m[D].push(x.replaceAll(L.outerText,"  ","").trim()))});for(let L in m)d.push(m[L].join(`
`));return d}),u=y(()=>{var d;return window.Number.parseInt(((d=p.query.idx)==null?void 0:d.toString())||"0")}),f=y(()=>l.value.length+1),b=d=>{const m=x.renew(p.query);let w=u.value+d;w<0?w=0:w>f.value&&(w=f.value),u.value!==w&&(m.idx=w.toString(),o.push({query:m}))},_=(d,m)=>{switch(d){case"ArrowLeft":!m&&b(-1);break;case"ArrowRight":!m&&b(1);break;case"F9":case"Escape":!m&&o.push({query:void 0});break}},k=d=>{_(d.key,d.altKey)},A=d=>{const m=d.touches[0];t.touchStartX=m.clientX,t.touchStartY=m.clientY},C=d=>{const m=d.changedTouches[0],w=m.clientX,G=m.clientY,L=w-t.touchStartX,D=G-t.touchStartY;Math.abs(L)>Math.abs(D)&&Math.abs(L)>50&&(L>0?b(-1):b(1))},V=d=>{d.data.type==="keyup"&&_(d.data.key,d.data.altKey)};return U(()=>{document.addEventListener("keyup",k),document.addEventListener("touchstart",A),document.addEventListener("touchend",C),window.addEventListener("message",V),document.body.classList.add(Q)}),X(()=>{document.removeEventListener("keyup",k),document.removeEventListener("touchstart",A),document.removeEventListener("touchend",C),window.removeEventListener("message",V),document.body.classList.remove(Q)}),(d,m)=>(n(),I(oe,{to:"body"},[s("div",Ae,[s("div",Ce,[u.value===0?(n(),r("div",De,[s("div",Ie,[s("figure",qe,[m[0]||(m[0]=s("img",{src:Se,alt:"코딩",loading:"lazy"},null,-1)),s("figcaption",null,[s("span",{innerHTML:v.value},null,8,He),$(B,{content:a.value},null,8,["content"])])])])])):u.value===f.value?(n(),r("div",Pe,[s("div",Re,[m[1]||(m[1]=s("figure",{class:"slide-item"},[s("img",{src:Ee,alt:"하이파이브",class:"mh-400",loading:"lazy"}),s("figcaption",null,[s("b",null,"이상 끝. "),s("span",null,"수고하셨습니다!")])],-1)),c.material.sources.length?(n(),I(se,{key:0,class:"w-100 mb-3",sources:c.material.sources},null,8,["sources"])):M("",!0),c.material.references.length?(n(),I(ne,{key:1,class:"w-100",references:c.material.references},null,8,["references"])):M("",!0),$(B,{content:i})])])):(n(!0),r(S,{key:2},P(l.value.length,w=>(n(),r(S,null,[u.value===w?(n(),r("div",Ne,[s("div",je,[$(ae,{document:l.value[w-1]},null,8,["document"]),$(B,{content:e.value[w-1]||""},null,8,["content"])])])):M("",!0)],64))),256))])])]))}}),Be=E(Fe,[["__scopeId","data-v-29a055a6"]]);function Oe(){const h=N(null),t=N(null),c=N(!1);return{data:h,error:t,loading:c,request:async({url:o,method:i="GET",body:v,contentType:a="application/json",...l})=>{c.value=!0,t.value=null;try{const e={"Content-Type":a,...l.headers||{}},u={method:i,headers:e,...l};v&&(u.body=a==="application/json"?JSON.stringify(v):v);const f=await fetch(o,u);if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);const b=f.headers.get("Content-Type");return b!=null&&b.includes("application/json")?h.value=await f.json():h.value=await f.text(),h.value}catch(e){throw t.value=e.message||"Unknown error",e}finally{c.value=!1}}}}const Ue={key:0,class:"presentation"},Xe={class:"content"},Ye={key:1,class:"empty"},Ke=T({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(h){const t=R(),c=re();Y();const p=z(t),{data:o,loading:i,request:v}=Oe(),a=h,l=ee({document:"<p>PLEASE WAIT A MOMENT</p>"}),e=()=>{if(!a.material.sources.length)return;const f=new DOMParser().parseFromString(l.document,"text/html");Array.from(f.querySelectorAll("[data-bs-toggle='popover']")).forEach((_,k)=>{if(!a.material.sources[k]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}_.setAttribute("title","자료 출처"),_.setAttribute("data-bs-content",x.linkify(a.material.sources[k])),_.innerText=`[${k+1}]`}),l.document=f.body.innerHTML},u=async()=>{if(a.material){const f=p.getUrlPath(a.material);await v({url:`/assets${f}/document.html?${Date.now()}`,contentType:"text/html"});const b=ie.get(j.unlockPasswordCookieName),_=window.location.hostname==="localhost";if(a.material.locked&&b&&!_){const k=new de(b,j.salt,j.iv);o.value=await k.decrypt(o.value).catch(A=>(console.error({err:A,message:"문서를 복호화 할 수 없습니다."}),null))}l.document=x.linkify(o.value),e()}ue(()=>{a.onDocumentLoaded()}),c.updateSiteTitle(x.extractText(a.material.title))};return le(()=>{u()}),X(()=>{c.updateSiteTitle()}),ce(()=>t.path,()=>{u()}),(f,b)=>(n(),r("div",{class:O(["material-core",{skeleton:g(i)}])},[g(t).query.mode==="presentation"&&!g(i)?(n(),r("div",Ue,[$(Be,{material:a.material,document:l.document},null,8,["material","document"])])):M("",!0),s("div",Xe,[l.document?(n(),I(ae,{key:0,document:l.document,skeleton:g(i)},null,8,["document","skeleton"])):(n(),r("div",Ye,"이 문서에는 내용이 없습니다."))])],2))}}),ze=E(Ke,[["__scopeId","data-v-0fbc9696"]]),Ve={class:"wrapper"},Ge={class:"title"},Je={class:"title"},Qe=T({__name:"MaterialNavigation",props:{material:{}},setup(h){const t=h,c=R();Y(),z(c);const p=F(()=>{var a,l;const v=[];if((l=(a=t.material)==null?void 0:a.parent)!=null&&l.children){const e=ve.getTag(c);t.material.parent.children.forEach(u=>{(!e||u.tags.includes(e))&&v.push(u)})}return v}),o=F(()=>{var l;let v=null;const a=p.value;for(let e=0;e<a.length;e++)if(a[e].id===((l=t.material)==null?void 0:l.id)&&a[e-1]){v=a[e-1];break}return v}),i=F(()=>{var l;let v=null;const a=p.value;for(let e=0;e<a.length;e++)if(a[e].id===((l=t.material)==null?void 0:l.id)&&a[e+1]){v=a[e+1];break}return v});return(v,a)=>{const l=K("router-link");return n(),r("div",{class:O(["material-navigation",{both:g(o)&&g(i)}])},[s("div",Ve,[g(o)?(n(),I(l,{key:0,to:g(o).url||"",class:"item prev",title:g(o).title},{default:H(()=>[a[0]||(a[0]=s("div",{class:"label"},[s("img",{src:me,alt:"이전"}),s("span",null,"이전")],-1)),s("div",Ge,q(g(x).extractText(g(o).title)),1)]),_:1},8,["to","title"])):M("",!0),g(i)?(n(),I(l,{key:1,to:g(i).url,class:"item next",title:g(i).title},{default:H(()=>[a[1]||(a[1]=s("div",{class:"label"},[s("img",{src:pe,alt:"다음"}),s("span",null,"다음")],-1)),s("div",Je,q(g(x).extractText(g(i).title)),1)]),_:1},8,["to","title"])):M("",!0)])],2)}}}),We=E(Qe,[["__scopeId","data-v-edc97d56"]]),Ze={class:"material-above"},et={class:"back"},tt={class:"wrapper"},st={class:"dates"},nt=["title"],W="?mode=presentation",at=T({__name:"MaterialAbove",props:{material:{}},setup(h){const t=h,c=Z(),p=(e,u)=>{e==="F9"&&!u&&c.push(W)},o=e=>{p(e.key,e.altKey)},i=y(()=>{const e={title:"강의 자료",url:"/materials"};return t.material.parent&&(e.title=t.material.parent.title,e.url=t.material.parent.url),e}),v=y(()=>t.material.created?t.material.updated?x.getHumanReadableDate(t.material.updated)+" 업데이트됨":x.getHumanReadableDate(t.material.created)+" 생성됨":"(N/A)"),a=y(()=>{if(t.material.created){const e=[`생성: ${t.material.created}`];return t.material.updated&&e.push(`업데이트: ${t.material.created}`),e.join(" | ")}}),l=e=>{e.data.type==="keyup"&&p(e.data.key,e.data.altKey)};return U(()=>{document.addEventListener("keyup",o),window.addEventListener("message",l)}),X(()=>{document.removeEventListener("keyup",o),window.removeEventListener("message",l)}),(e,u)=>{const f=K("router-link");return n(),r("div",Ze,[s("div",et,[$(f,{to:i.value.url},{default:H(()=>[u[0]||(u[0]=s("img",{src:_e,alt:"뒤로가기",title:"뒤로가기"},null,-1)),s("span",null,q(i.value.title),1)]),_:1},8,["to"])]),s("div",tt,[s("div",st,[s("span",{title:a.value},q(v.value),9,nt),t.material.presentation?(n(),r(S,{key:0},[u[2]||(u[2]=s("span",{class:"bar"},null,-1)),$(f,{to:W},{default:H(()=>u[1]||(u[1]=[te("발표(F9)")])),_:1})],64)):M("",!0)]),$(he,{title:g(x).extractText(t.material.title),desc:t.material.desc},null,8,["title","desc"])])])}}}),ot=E(at,[["__scopeId","data-v-89bf0324"]]),rt={class:"material"},lt={class:"container"},ct={class:"above",ref:"aboveRef"},it={key:0,class:"list"},ut={key:1,class:"detail"},dt={class:"main",ref:"mainRef"},mt={class:"core",ref:"coreRef"},pt={key:0,class:"sources"},_t={key:1,class:"references"},vt={key:1,class:"empty"},ht={key:2,class:"login"},ft={class:"navigation"},gt={key:0,class:"materials",ref:"materialsRef"},yt={key:1,class:"empty"},kt=T({__name:"MaterialDetail",setup(h){const t=R(),c=Y(),p=z(t),o=ee({contentLoaded:!1}),i=y(()=>{var _;return!((_=e.value)!=null&&_.locked)||c.admin}),v=y(()=>{var _;return(_=t.params.id1)==null?void 0:_.toString()}),a=y(()=>{var _;return(_=t.params.id2)==null?void 0:_.toString()}),l=y(()=>{var _;return(_=t.params.id3)==null?void 0:_.toString()}),e=y(()=>p.get(v.value,a.value,l.value)),u=y(()=>{var _,k;return((k=(_=e.value)==null?void 0:_.parent)==null?void 0:k.children)||[]}),f=y(()=>{if(t.query.tag)return window.decodeURIComponent(t.query.tag.toString())}),b=()=>{o.contentLoaded=!0};return(_,k)=>{var C;const A=K("router-link");return n(),r("div",rt,[s("div",lt,[e.value?(n(),r(S,{key:0},[s("div",ct,[$(ot,{material:e.value},null,8,["material"])],512),e.value.children.length?(n(),r("div",it,[$(J,{materials:e.value.children,tag:f.value},null,8,["materials","tag"])])):(n(),r("div",ut,[s("div",dt,[i.value?(n(),r(S,{key:0},[s("div",mt,[$(ze,{material:e.value,onDocumentLoaded:b},null,8,["material"])],512),e.value.sources.length?(n(),r("div",pt,[$(se,{sources:e.value.sources},null,8,["sources"])])):M("",!0),(C=e.value.references)!=null&&C.length?(n(),r("div",_t,[$(ne,{references:e.value.references},null,8,["references"])])):M("",!0)],64)):e.value.children.length?(n(),r("div",ht,[$(A,{to:g(c).getLoginUrl(g(t),!0)},{default:H(()=>k[0]||(k[0]=[te("로그인")])),_:1},8,["to"]),k[1]||(k[1]=s("span",null,"이 필요합니다.",-1))])):(n(),r("div",vt," 세부 강의가 없습니다. ")),s("div",ft,[$(We,{material:e.value},null,8,["material"])])],512),o.contentLoaded&&u.value.length?(n(),r("div",gt,[$(J,{materials:u.value},null,8,["materials"])],512)):M("",!0)]))],64)):(n(),r("div",yt,"접근 가능한 데이터가 없습니다."))])])}}}),Et=E(kt,[["__scopeId","data-v-21a6c093"]]);export{Et as default};
