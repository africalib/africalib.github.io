import{d as x,i as U,q as T,s as B,v as h,n as q,l as j,c as f,x as z,g as b,u as l,j as F,F as G,e as v,m as I,b as n,y as J,o as i,_ as E,z as A,w as $,f as H,t as M,A as K,B as Q}from"./index-BMBiNQBt.js";import{c as O}from"./commonLib-DGe6iNju.js";import{u as N}from"./useSection-Bii42e52.js";import{D as X,a as Y,b as Z,c as ee,C as te,d as oe}from"./DocumentHeader-gnu-fAvc.js";import{C as se}from"./Chapters-B0ImG-ZK.js";import"./courses-DVo_-Olu.js";const ne="/assets/images/common.home.white.svg",ce={key:0,class:"video"},re={class:"content"},ae=x({__name:"SectionCore",props:{courseId:{},chapterId:{},sectionId:{},onContentLoaded:{type:Function}},setup(k){const u=U(),g=F(),p=N(),c=k,m=T(),e=B({loaded:!1,title:"WAIT A MOMENT",desc:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",presentation:!1,created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),s=h(()=>p.getSection(c.courseId,c.chapterId,c.sectionId)),t=()=>{const r=new DOMParser().parseFromString(e.content,"text/html");Array.from(r.querySelectorAll("[data-bs-toggle='popover']")).forEach((o,_)=>{o.setAttribute("title","출처"),o.setAttribute("data-bs-content",O.linkify(e.sources[_])),o.innerText=`[${_+1}]`}),e.content=r.body.innerHTML};return q(async()=>{const r=p.getCourse(c.courseId);if(r){const a=p.getChapter(c.courseId,c.chapterId);if(a){const o=s.value;if(o){const{html:_}=await o.read();e.title=o.title,e.desc=o.desc,e.videoUrl=o.videoUrl,e.sources=o.sources,e.references=o.references,e.content=O.linkify(_),e.presentation=o.presentation,e.created=o.created,e.updated=o.updated,e.courseTitle=r.title,e.chapterTitle=a.title,t(),J(()=>{e.loaded=!0,c.onContentLoaded()}),u.updateSiteTitle(e.title)}}}}),j(()=>{u.updateSiteTitle()}),(r,a)=>(i(),f("div",{class:z(["section-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:m},[l(g).query.mode==="presentation"&&e.loaded?(i(),b(X,{key:0,title:e.title,desc:e.desc,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","desc","content","sources","references","created","updated"])):(i(),f(G,{key:1},[v(Y,{title:e.title,desc:e.desc,presentation:e.presentation,created:e.created,updated:e.updated,skeleton:!e.loaded},null,8,["title","desc","presentation","created","updated","skeleton"]),e.videoUrl?(i(),f("div",ce,[v(Z,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):I("",!0),n("div",re,[v(ee,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])],64))],2))}}),le=E(ae,[["__scopeId","data-v-e889a570"]]),ie="/assets/images/common.angle.left.svg",de="/assets/images/common.angle.right.svg",ue={class:"wrapper"},pe={class:"title"},me={class:"title"},ve=x({__name:"SectionNavigation",props:{courseId:{},chapterId:{},sectionId:{}},setup(k){const u=k,g=N(),p=A(()=>{var t;const e=[];return(((t=g.getCourse(u.courseId))==null?void 0:t.chapters)||[]).forEach(r=>{r.sections.forEach(a=>{e.push({id:a.id,title:a.title,url:`/courses/${u.courseId}/${r.id}/${a.id}`})})}),e}),c=A(()=>{let e=null;const s=p.value;for(let t=0;t<s.length;t++)s[t].id===u.sectionId&&(e=s[t-1]);return e}),m=A(()=>{let e=null;const s=p.value;for(let t=0;t<s.length;t++)s[t].id===u.sectionId&&(e=s[t+1]);return e});return(e,s)=>{const t=H("router-link");return i(),f("div",{class:z(["section-navigation",{both:l(c)&&l(m)}])},[n("div",ue,[l(c)?(i(),b(t,{key:0,to:l(c).url||"",class:"item prev",title:l(c).title},{default:$(()=>[s[0]||(s[0]=n("div",{class:"label"},[n("img",{src:ie,alt:"이전"}),n("span",null,"이전")],-1)),n("div",pe,M(l(c).title),1)]),_:1},8,["to","title"])):I("",!0),l(m)?(i(),b(t,{key:1,to:l(m).url,class:"item next",title:l(m).title},{default:$(()=>[s[1]||(s[1]=n("div",{class:"label"},[n("img",{src:de,alt:"다음"}),n("span",null,"다음")],-1)),n("div",me,M(l(m).title),1)]),_:1},8,["to","title"])):I("",!0)])],2)}}}),fe=E(ve,[["__scopeId","data-v-91ef5a4d"]]),_e={class:"section"},he={class:"container"},Ie={class:"wrapper"},ge={class:"main"},Se={key:0,class:"sources"},ke={key:1,class:"references"},ye={class:"navigation"},Ce=x({__name:"Section",setup(k){const u=U(),g=K(),p=N(),c=F(),m=T(),e=T(),s=T(),t=B({contentLoaded:!1}),r=h(()=>{var d;return(d=c.params.courseId)==null?void 0:d.toString()}),a=h(()=>{var d;return(d=c.params.chapterId)==null?void 0:d.toString()}),o=h(()=>{var d;return(d=c.params.sectionId)==null?void 0:d.toString()}),_=h(()=>p.getCourse(r.value)),y=h(()=>p.getSection(r.value,a.value,o.value)),P=d=>{var S,C;u.windowSize.width<=1399||(C=s.value)==null||C.scrollTo({top:d-s.value.offsetTop-(((S=e.value)==null?void 0:S.offsetHeight)||0),behavior:"smooth"})},V=()=>{t.contentLoaded=!0};return(d,S)=>{var w,L,R,D;const C=H("router-link");return i(),f("div",_e,[n("div",he,[n("div",Ie,[n("div",ge,[n("div",{class:"core",ref_key:"coreRef",ref:m},[(i(),b(le,{courseId:r.value,chapterId:a.value,sectionId:o.value,key:o.value,onContentLoaded:V},null,8,["courseId","chapterId","sectionId"]))],512),(L=(w=y.value)==null?void 0:w.sources)!=null&&L.length?(i(),f("div",Se,[v(te,{sources:y.value.sources},null,8,["sources"])])):I("",!0),(D=(R=y.value)==null?void 0:R.references)!=null&&D.length?(i(),f("div",ke,[v(oe,{references:y.value.references},null,8,["references"])])):I("",!0),n("div",ye,[v(fe,{courseId:r.value,chapterId:a.value,sectionId:o.value},null,8,["courseId","chapterId","sectionId"])])]),t.contentLoaded?(i(),f("div",{key:0,class:"chapters",ref_key:"chaptersRef",ref:s,style:Q({height:l(g).mainHeight})},[n("div",{class:"top",ref_key:"chaptersTopRef",ref:e},[v(C,{to:`/courses/${r.value}`,class:"btn"},{default:$(()=>{var W;return[S[0]||(S[0]=n("img",{src:ne},null,-1)),n("span",null,M((W=_.value)==null?void 0:W.title),1)]}),_:1},8,["to"])],512),v(se,{courseId:r.value,chapterId:a.value,sectionId:o.value,theme:"light",onScrollable:P},null,8,["courseId","chapterId","sectionId"])],4)):I("",!0)])])])}}}),Ee=E(Ce,[["__scopeId","data-v-a98f26a6"]]);export{Ee as default};
