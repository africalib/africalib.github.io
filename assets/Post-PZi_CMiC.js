import{d as b,i as D,v as I,n as E,l as R,c as p,y as N,u as t,g as T,m,e as f,j as L,z as W,o as c,_ as A,A as $,b as a,w as C,f as O,t as M,B as U,q,x as w,C as B}from"./index-DUZ0vi-t.js";import{c as k}from"./commonLib-B4LiHA7t.js";import{u as z,D as H,a as V,b as F,c as G,_ as j,d as J,C as K,e as Q}from"./common.angle.right-B8SE-h1K.js";import{p as u,P as X}from"./Posts-zSB529X9.js";const Y={key:1,class:"video"},Z={key:2,class:"content"},ee=b({__name:"PostCore",props:{id:{},onDocumentLoaded:{type:Function}},setup(y){const _=D(),l=L(),{data:i,loading:o,request:s}=z(),r=y,e=I({title:"WAIT A MOMENT",desc:"WAIT A MOMENT",videoUrl:null,document:"<p>PLEASE WAIT A MOMENT</p>",presentation:!1,created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),g=()=>{const n=new DOMParser().parseFromString(e.document,"text/html");Array.from(n.querySelectorAll("[data-bs-toggle='popover']")).forEach((v,h)=>{if(!e.sources[h]){console.warn("마크다운 파일에 입력한 출처와 차이가 있습니다.");return}v.setAttribute("title","자료 출처"),v.setAttribute("data-bs-content",k.linkify(e.sources[h])),v.innerText=`[${h+1}]`}),e.document=n.body.innerHTML};return E(async()=>{const n=u.find(d=>d.id===r.id);n&&(await s({url:`/assets/posts/${r.id}/document.html?${Date.now()}`,contentType:"text/html"}),e.title=n.title,e.desc=n.desc,e.videoUrl=n.videoUrl,e.document=k.linkify(i.value),e.presentation=n.presentation,e.created=n.created,e.updated=n.updated,e.sources=n.sources,e.references=n.references,g(),W(()=>{r.onDocumentLoaded()}),_.updateSiteTitle(e.title))}),R(()=>{_.updateSiteTitle()}),(n,d)=>(c(),p("div",{class:N(["post-core",{skeleton:t(o)}])},[t(l).query.mode==="presentation"&&!t(o)?(c(),T(H,{key:0,title:e.title,desc:e.desc,document:e.document,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","desc","document","sources","references","created","updated"])):m("",!0),f(V,{title:t(k).extractText(e.title),desc:e.desc,presentation:e.presentation,created:e.created,updated:e.updated,skeleton:t(o)},null,8,["title","desc","presentation","created","updated","skeleton"]),e.videoUrl?(c(),p("div",Y,[f(F,{url:e.videoUrl,skeleton:t(o)},null,8,["url","skeleton"])])):m("",!0),e.document?(c(),p("div",Z,[f(G,{document:e.document,skeleton:t(o)},null,8,["document","skeleton"])])):m("",!0)],2))}}),te=A(ee,[["__scopeId","data-v-da1c5603"]]),se={class:"wrapper"},oe={class:"title"},ne={class:"title"},ae=b({__name:"PostNavigation",props:{id:{}},setup(y){const _=y,l=$(()=>{let o=null;for(let s=0;s<u.length;s++)if(u[s].id===_.id){o=u[s-1];break}return o}),i=$(()=>{let o=null;for(let s=0;s<u.length;s++)if(u[s].id===_.id){o=u[s+1];break}return o});return(o,s)=>{const r=O("router-link");return c(),p("div",{class:N(["post-navigation",{both:t(l)&&t(i)}])},[a("div",se,[t(l)?(c(),T(r,{key:0,to:`/posts/${t(l).id}`,class:"item prev",title:t(l).title},{default:C(()=>[s[0]||(s[0]=a("div",{class:"label"},[a("img",{src:j,alt:"이전"}),a("span",null,"이전")],-1)),a("div",oe,M(t(k).extractText(t(l).title)),1)]),_:1},8,["to","title"])):m("",!0),t(i)?(c(),T(r,{key:1,to:`/posts/${t(i).id}`,class:"item next",title:t(i).title},{default:C(()=>[s[1]||(s[1]=a("div",{class:"label"},[a("img",{src:J,alt:"다음"}),a("span",null,"다음")],-1)),a("div",ne,M(t(k).extractText(t(i).title)),1)]),_:1},8,["to","title"])):m("",!0)])],2)}}}),re=A(ae,[["__scopeId","data-v-289f49dc"]]),ce={class:"post"},de={class:"container"},le={class:"wrapper"},ie={class:"main"},ue={class:"core"},pe={key:0,class:"sources"},me={key:1,class:"references"},_e={class:"navigation"},ve=b({__name:"Post",setup(y){const _=D(),l=U(),i=L(),o=q("postsRef"),s=I({contentLoaded:!1}),r=w(()=>{var d;return((d=i.params.id)==null?void 0:d.toString())??""}),e=w(()=>u.find(d=>d.id===r.value)),g=()=>{s.contentLoaded=!0},n=d=>{var v;_.windowSize.width<=1399||(v=o.value)==null||v.scrollTo({top:d-1,behavior:"smooth"})};return(d,v)=>{var h,S,x,P;return c(),p("div",ce,[a("div",de,[a("div",le,[a("div",ie,[a("div",ue,[(c(),T(te,{id:r.value,key:r.value,onDocumentLoaded:g},null,8,["id"]))]),(S=(h=e.value)==null?void 0:h.sources)!=null&&S.length?(c(),p("div",pe,[f(K,{sources:e.value.sources},null,8,["sources"])])):m("",!0),(P=(x=e.value)==null?void 0:x.references)!=null&&P.length?(c(),p("div",me,[f(Q,{references:e.value.references},null,8,["references"])])):m("",!0),a("div",_e,[f(re,{id:r.value},null,8,["id"])])]),s.contentLoaded?(c(),p("div",{key:0,class:"posts",ref_key:"postsRef",ref:o,style:B({height:t(l).mainHeight})},[f(X,{id:r.value,onScrollable:n},null,8,["id"])],4)):m("",!0)])])])}}}),Te=A(ve,[["__scopeId","data-v-c14b6edd"]]);export{Te as default};
