import{d as w,c,e as a,F as D,r as V,t as I,g as u,o,_ as E,n as B,h as O,b as $,u as H,i as X,j as C,f as k,k as M,T as se,l as J,m as R,p as ae,q as P,s as Q,v as ne,w as oe,x as re,y as N,z as le,A as j,B as q,C as W,D as ie}from"./index-CpYqn24L.js";import{u as Y,M as z}from"./Materials-DvOf3Xfw.js";import{T as ce}from"./Tags-CAWdA7c1.js";import{c as T}from"./commonLib-B4LiHA7t.js";import{C as ue}from"./CryptoHelper-m6j8gmxG.js";import{_ as de,a as me,b as pe}from"./common.arrow.left-TSorRx6s.js";import{r as _e}from"./routeLib-DhAZaWiT.js";import{A as ve}from"./Above-CSvwRU8o.js";import"./Panel-CRsQOjOD.js";const he={class:"common-sources"},fe={class:"items"},ge={class:"item"},ye=["innerHTML"],be=w({__name:"MaterialSources",props:{sources:{}},setup(_){const s=_;return(r,i)=>(o(),c("div",he,[i[0]||(i[0]=a("div",{class:"subject"},"자료 출처",-1)),a("div",fe,[(o(!0),c(D,null,V(s.sources,(v,g)=>(o(),c("div",ge,[a("span",null,"["+I(g+1)+"] ",1),a("span",{innerHTML:u(T).linkify(v)},null,8,ye)]))),256))])]))}}),Z=E(be,[["__scopeId","data-v-3b532ca9"]]),ke={class:"common-references"},$e={class:"items"},xe={class:"item"},Se=w({__name:"MaterialReferences",props:{references:{}},setup(_){const s=_;return(r,i)=>(o(),c("div",ke,[i[0]||(i[0]=a("div",{class:"subject"},"참고 자료",-1)),a("div",$e,[(o(!0),c(D,null,V(s.references,v=>(o(),c("div",xe,[a("span",null,I(v),1)]))),256))])]))}}),ee=E(Se,[["__scopeId","data-v-9a0696c5"]]),Te=["innerHTML"],Me=w({__name:"DocumentContent",props:{document:{},skeleton:{type:Boolean}},setup(_){const s=_;return(r,i)=>(o(),c("div",{class:B(["document-content",{skeleton:s.skeleton}])},[a("div",{innerHTML:s.document,ref:"contentRef"},null,8,Te)],2))}}),te=E(Me,[["__scopeId","data-v-ab08b7b9"]]),we="/assets/images/component.document.presentation.slide.first.svg",Le="/assets/images/component.material.presentation.finish.svg",F=w({__name:"DocumentPrompt",props:{content:{}},setup(_){const s=_;return O(()=>{console.info(s.content.replace(/\n{3,}/g,`

`))}),(r,i)=>null}}),Ee={class:"presentation"},Ae={class:"slides"},Ce={key:0,class:"slide start"},De={class:"container"},Ie={class:"slide-item"},qe=["innerHTML"],He={key:1,class:"slide finish"},Pe={class:"container"},Re={key:0,class:"slide"},Ne={class:"container"},K="no-overflow",je=w({__name:"MaterialPresentation",props:{material:{},document:{}},setup(_){const s={touchStartX:0,touchStartY:0},r=_,i=H(),v=J(),g=`이렇게 해서 ${T.extractText(r.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,h=$(()=>r.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),y=$(()=>{const m=[r.material.desc];return e.value.length===0&&t.value.length===1&&m.push(t.value[0]),m.join("")}),e=$(()=>{const m=new DOMParser().parseFromString(r.document,"text/html");return Array.from(m.querySelectorAll(".slide-item")).map(p=>p.outerHTML)}),t=$(()=>{const m=[],p={},S=new DOMParser().parseFromString(r.document,"text/html");Array.from(S.querySelectorAll(".slide-text")).forEach(L=>{const A=L.getAttribute("data-slide-text-group");A&&(!p[A]&&(p[A]=[]),p[A].push(T.replaceAll(L.outerText,"  ","").trim()))});for(let L in p)m.push(p[L].join(`
`));return m}),l=$(()=>{var m;return window.Number.parseInt(((m=i.query.idx)==null?void 0:m.toString())||"0")}),n=$(()=>e.value.length+1),f=m=>{const p=T.renew(i.query);let S=l.value+m;S<0?S=0:S>n.value&&(S=n.value),l.value!==S&&(p.idx=S.toString(),v.push({query:p}))},d=m=>{switch(m.key){case"ArrowLeft":!m.altKey&&f(-1);break;case"ArrowRight":!m.altKey&&f(1);break;case"F9":case"Escape":v.push({query:void 0});break}},b=m=>{const p=m.touches[0];s.touchStartX=p.clientX,s.touchStartY=p.clientY},x=m=>{const p=m.changedTouches[0],S=p.clientX,U=p.clientY,L=S-s.touchStartX,A=U-s.touchStartY;Math.abs(L)>Math.abs(A)&&Math.abs(L)>50&&(L>0?f(-1):f(1))};return O(()=>{document.addEventListener("keyup",d),document.addEventListener("touchstart",b),document.addEventListener("touchend",x),document.body.classList.add(K)}),X(()=>{document.removeEventListener("keyup",d),document.removeEventListener("touchstart",b),document.removeEventListener("touchend",x),document.body.classList.remove(K)}),(m,p)=>(o(),C(se,{to:"body"},[a("div",Ee,[a("div",Ae,[l.value===0?(o(),c("div",Ce,[a("div",De,[a("figure",Ie,[p[0]||(p[0]=a("img",{src:we,alt:"코딩",loading:"lazy"},null,-1)),a("figcaption",null,[a("span",{innerHTML:h.value},null,8,qe),k(F,{content:y.value},null,8,["content"])])])])])):l.value===n.value?(o(),c("div",He,[a("div",Pe,[p[1]||(p[1]=a("figure",{class:"slide-item"},[a("img",{src:Le,alt:"하이파이브",class:"mh-400",loading:"lazy"}),a("figcaption",null,[a("b",null,"이상 끝. "),a("span",null,"수고하셨습니다!")])],-1)),r.material.sources.length?(o(),C(Z,{key:0,class:"w-100 mb-3",sources:r.material.sources},null,8,["sources"])):M("",!0),r.material.references.length?(o(),C(ee,{key:1,class:"w-100",references:r.material.references},null,8,["references"])):M("",!0),k(F,{content:g})])])):(o(!0),c(D,{key:2},V(e.value.length,S=>(o(),c(D,null,[l.value===S?(o(),c("div",Re,[a("div",Ne,[k(te,{document:e.value[S-1]},null,8,["document"]),k(F,{content:t.value[S-1]||""},null,8,["content"])])])):M("",!0)],64))),256))])])]))}}),Fe=E(je,[["__scopeId","data-v-56f6ed8a"]]);function Ve(){const _=R(null),s=R(null),r=R(!1);return{data:_,error:s,loading:r,request:async({url:v,method:g="GET",body:h,contentType:y="application/json",...e})=>{r.value=!0,s.value=null;try{const t={"Content-Type":y,...e.headers||{}},l={method:g,headers:t,...e};h&&(l.body=y==="application/json"?JSON.stringify(h):h);const n=await fetch(v,l);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const f=n.headers.get("Content-Type");return f!=null&&f.includes("application/json")?_.value=await n.json():_.value=await n.text(),_.value}catch(t){throw s.value=t.message||"Unknown error",t}finally{r.value=!1}}}}const Be={key:0,class:"presentation"},Oe={class:"content"},Xe={key:1,class:"empty"},Ye=w({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(_){const s=H(),r=ae(),i=P(),v=Y(s),{data:g,loading:h,request:y}=Ve(),e=_,t=Q({document:"<p>PLEASE WAIT A MOMENT</p>",accessible:!1}),l=()=>{if(!e.material.sources.length)return;const f=new DOMParser().parseFromString(t.document,"text/html");Array.from(f.querySelectorAll("[data-bs-toggle='popover']")).forEach((b,x)=>{if(!e.material.sources[x]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}b.setAttribute("title","자료 출처"),b.setAttribute("data-bs-content",T.linkify(e.material.sources[x])),b.innerText=`[${x+1}]`}),t.document=f.body.innerHTML},n=async()=>{const f=window.location.hostname==="localhost";if(t.accessible=e.material.locked?i.admin:!0,t.accessible){const d=v.getUrlPath(e.material);await y({url:`/assets${d}/document.html?${Date.now()}`,contentType:"text/html"});const b=re.get(N.unlockPasswordCookieName);if(e.material.locked&&b&&!f){const x=new ue(b,N.salt,N.iv);g.value=await x.decrypt(g.value).catch(m=>(console.error({err:m,message:"문서를 복호화 할 수 없습니다."}),null))}t.document=T.linkify(g.value),l()}le(()=>{e.onDocumentLoaded()}),r.updateSiteTitle(T.extractText(e.material.title))};return ne(()=>{n()}),X(()=>{r.updateSiteTitle()}),oe(()=>s.path,()=>{n()}),(f,d)=>(o(),c("div",{class:B(["material-core",{skeleton:u(h)}])},[u(s).query.mode==="presentation"&&!u(h)&&t.accessible&&u(i).admin?(o(),c("div",Be,[k(Fe,{material:e.material,document:t.document},null,8,["material","document"])])):M("",!0),a("div",Oe,[t.accessible&&t.document?(o(),C(te,{key:0,document:t.document,skeleton:u(h)},null,8,["document","skeleton"])):(o(),c("div",Xe,"조회 가능한 문서가 없습니다."))])],2))}}),Ue=E(Ye,[["__scopeId","data-v-5f387f22"]]),ze={class:"wrapper"},Ke={class:"title"},Ge={class:"title"},Je=w({__name:"MaterialNavigation",props:{material:{}},setup(_){const s=_,r=H(),i=P(),v=Y(r),g=j(()=>{var t,l;const e=[];if((l=(t=s.material)==null?void 0:t.parent)!=null&&l.children){const n=_e.getTag(r);s.material.parent.children.forEach(f=>{(!n||f.tags.includes(n))&&e.push(f)})}return e}),h=j(()=>{var l;let e=null;const t=g.value;for(let n=0;n<t.length;n++)if(t[n].id===((l=s.material)==null?void 0:l.id)&&t[n-1]&&v.isVisible(t[n-1],i.admin)){e=t[n-1];break}return e}),y=j(()=>{var l;let e=null;const t=g.value;for(let n=0;n<t.length;n++)if(t[n].id===((l=s.material)==null?void 0:l.id)&&t[n+1]&&v.isVisible(t[n+1],i.admin)){e=t[n+1];break}return e});return(e,t)=>{const l=W("router-link");return o(),c("div",{class:B(["material-navigation",{both:u(h)&&u(y)}])},[a("div",ze,[u(h)?(o(),C(l,{key:0,to:u(h).url||"",class:"item prev",title:u(h).title},{default:q(()=>[t[0]||(t[0]=a("div",{class:"label"},[a("img",{src:de,alt:"이전"}),a("span",null,"이전")],-1)),a("div",Ke,I(u(T).extractText(u(h).title)),1)]),_:1},8,["to","title"])):M("",!0),u(y)?(o(),C(l,{key:1,to:u(y).url,class:"item next",title:u(y).title},{default:q(()=>[t[1]||(t[1]=a("div",{class:"label"},[a("img",{src:me,alt:"다음"}),a("span",null,"다음")],-1)),a("div",Ge,I(u(T).extractText(u(y).title)),1)]),_:1},8,["to","title"])):M("",!0)])],2)}}}),Qe=E(Je,[["__scopeId","data-v-a593699b"]]),We={class:"material-above"},Ze={class:"back"},et={class:"wrapper"},tt={class:"dates"},st=["title"],G="?mode=presentation",at=w({__name:"MaterialAbove",props:{material:{}},setup(_){const s=_,r=J(),i=P(),v=e=>{e.key==="F9"&&i.admin&&r.push(G)},g=$(()=>{const e={title:"강의 자료",url:"/materials"};return s.material.parent&&(e.title=s.material.parent.title,e.url=s.material.parent.url),e}),h=$(()=>s.material.created?s.material.updated?T.getHumanReadableDate(s.material.updated)+" 업데이트":T.getHumanReadableDate(s.material.created)+" 생성":"(N/A)"),y=$(()=>{if(s.material.created){const e=[`생성: ${s.material.created}`];return s.material.updated&&e.push(`업데이트: ${s.material.created}`),e.join(" | ")}});return O(()=>{document.addEventListener("keyup",v)}),X(()=>{document.removeEventListener("keyup",v)}),(e,t)=>{const l=W("router-link");return o(),c("div",We,[a("div",Ze,[k(l,{to:g.value.url},{default:q(()=>[t[0]||(t[0]=a("img",{src:pe,alt:"뒤로가기",title:"뒤로가기"},null,-1)),a("span",null,I(g.value.title),1)]),_:1},8,["to"])]),a("div",et,[a("div",tt,[a("span",{title:y.value},I(h.value),9,st),s.material.presentation&&u(i).admin?(o(),c(D,{key:0},[t[2]||(t[2]=a("span",{class:"bar"},null,-1)),k(l,{to:G},{default:q(()=>t[1]||(t[1]=[ie("발표(F9)")])),_:1})],64)):M("",!0)]),k(ve,{title:u(T).extractText(s.material.title),desc:s.material.desc},null,8,["title","desc"])])])}}}),nt=E(at,[["__scopeId","data-v-f86ab5ed"]]),ot={class:"material"},rt={class:"container"},lt={class:"above",ref:"aboveRef"},it={key:0,class:"list"},ct={class:"tags"},ut={key:1,class:"detail"},dt={class:"main",ref:"mainRef"},mt={class:"core",ref:"coreRef"},pt={key:0,class:"sources"},_t={key:1,class:"references"},vt={class:"navigation"},ht={key:0,class:"materials",ref:"materialsRef"},ft=w({__name:"MaterialDetail",setup(_){const s=H(),r=P(),i=Y(s),v=Q({contentLoaded:!1}),g=$(()=>{var d;return(d=s.params.id1)==null?void 0:d.toString()}),h=$(()=>{var d;return(d=s.params.id2)==null?void 0:d.toString()}),y=$(()=>{var d;return(d=s.params.id3)==null?void 0:d.toString()}),e=$(()=>i.get(g.value,h.value,y.value)),t=$(()=>{var d,b;return((b=(d=e.value)==null?void 0:d.parent)==null?void 0:b.children.filter(x=>i.isVisible(x,r.admin)))||[]}),l=$(()=>{var b;const d=new Set;return d.add(void 0),(b=i.get(g.value))==null||b.tags.forEach(x=>d.add(x)),d}),n=$(()=>{if(s.query.tag)return window.decodeURIComponent(s.query.tag.toString())}),f=()=>{v.contentLoaded=!0};return(d,b)=>{var x;return o(),c("div",ot,[a("div",rt,[e.value?(o(),c(D,{key:0},[a("div",lt,[k(nt,{material:e.value},null,8,["material"])],512),e.value.children.length?(o(),c("div",it,[a("div",ct,[k(ce,{tags:l.value,tag:n.value},null,8,["tags","tag"])]),k(z,{materials:e.value.children,tag:n.value},null,8,["materials","tag"])])):(o(),c("div",ut,[a("div",dt,[a("div",mt,[k(Ue,{material:e.value,onDocumentLoaded:f},null,8,["material"])],512),u(i).isVisible(e.value,u(r).admin)&&e.value.sources.length?(o(),c("div",pt,[k(Z,{sources:e.value.sources},null,8,["sources"])])):M("",!0),u(i).isVisible(e.value,u(r).admin)&&((x=e.value.references)!=null&&x.length)?(o(),c("div",_t,[k(ee,{references:e.value.references},null,8,["references"])])):M("",!0),a("div",vt,[k(Qe,{material:e.value},null,8,["material"])])],512),v.contentLoaded&&t.value.length?(o(),c("div",ht,[k(z,{materials:t.value},null,8,["materials"])],512)):M("",!0)]))],64)):M("",!0)])])}}}),wt=E(ft,[["__scopeId","data-v-312a7eab"]]);export{wt as default};
