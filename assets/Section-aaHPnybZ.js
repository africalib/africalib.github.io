import{d as E,i as U,q as b,s as B,v as h,n as q,l as j,c as f,x as z,g as A,u as l,j as F,F as G,e as v,m as I,b as n,y as J,o as i,_ as N,z as x,w as $,f as H,t as M,A as K,B as Q}from"./index-B3HcCPYI.js";import{c as k}from"./commonLib-B4LiHA7t.js";import{u as w}from"./useSection-CGJifkPR.js";import{D as X,a as Y,b as Z,c as ee,_ as te,d as oe,C as se,e as ne}from"./common.angle.right-DvCu4as3.js";import{C as ce}from"./Chapters-C3JCVSg4.js";import"./courses-C3-NreUK.js";const re="/assets/images/common.home.white.svg",ae={key:0,class:"video"},le={class:"content"},ie=E({__name:"SectionCore",props:{courseId:{},chapterId:{},sectionId:{},onContentLoaded:{type:Function}},setup(y){const u=U(),S=F(),p=w(),c=y,m=b(),e=B({loaded:!1,title:"WAIT A MOMENT",desc:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",presentation:!1,created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),s=h(()=>p.getSection(c.courseId,c.chapterId,c.sectionId)),t=()=>{const r=new DOMParser().parseFromString(e.content,"text/html");Array.from(r.querySelectorAll("[data-bs-toggle='popover']")).forEach((o,_)=>{o.setAttribute("title","출처"),o.setAttribute("data-bs-content",k.linkify(e.sources[_])),o.innerText=`[${_+1}]`}),e.content=r.body.innerHTML};return q(async()=>{const r=p.getCourse(c.courseId);if(r){const a=p.getChapter(c.courseId,c.chapterId);if(a){const o=s.value;if(o){const{html:_}=await o.read();e.title=o.title,e.desc=o.desc,e.videoUrl=o.videoUrl,e.sources=o.sources,e.references=o.references,e.content=k.linkify(_),e.presentation=o.presentation,e.created=o.created,e.updated=o.updated,e.courseTitle=r.title,e.chapterTitle=a.title,t(),J(()=>{e.loaded=!0,c.onContentLoaded()}),u.updateSiteTitle(k.extractText(e.title))}}}}),j(()=>{u.updateSiteTitle()}),(r,a)=>(i(),f("div",{class:z(["section-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:m},[l(S).query.mode==="presentation"&&e.loaded?(i(),A(X,{key:0,title:e.title,desc:e.desc,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","desc","content","sources","references","created","updated"])):(i(),f(G,{key:1},[v(Y,{title:l(k).extractText(e.title),desc:e.desc,presentation:e.presentation,created:e.created,updated:e.updated,skeleton:!e.loaded},null,8,["title","desc","presentation","created","updated","skeleton"]),e.videoUrl?(i(),f("div",ae,[v(Z,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):I("",!0),n("div",le,[v(ee,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])],64))],2))}}),de=N(ie,[["__scopeId","data-v-9d372417"]]),ue={class:"wrapper"},pe={class:"title"},me={class:"title"},ve=E({__name:"SectionNavigation",props:{courseId:{},chapterId:{},sectionId:{}},setup(y){const u=y,S=w(),p=x(()=>{var t;const e=[];return(((t=S.getCourse(u.courseId))==null?void 0:t.chapters)||[]).forEach(r=>{r.sections.forEach(a=>{e.push({id:a.id,title:k.extractText(a.title),url:`/courses/${u.courseId}/${r.id}/${a.id}`})})}),e}),c=x(()=>{let e=null;const s=p.value;for(let t=0;t<s.length;t++)if(s[t].id===u.sectionId){e=s[t-1];break}return e}),m=x(()=>{let e=null;const s=p.value;for(let t=0;t<s.length;t++)if(s[t].id===u.sectionId){e=s[t+1];break}return e});return(e,s)=>{const t=H("router-link");return i(),f("div",{class:z(["section-navigation",{both:l(c)&&l(m)}])},[n("div",ue,[l(c)?(i(),A(t,{key:0,to:l(c).url||"",class:"item prev",title:l(c).title},{default:$(()=>[s[0]||(s[0]=n("div",{class:"label"},[n("img",{src:te,alt:"이전"}),n("span",null,"이전")],-1)),n("div",pe,M(l(c).title),1)]),_:1},8,["to","title"])):I("",!0),l(m)?(i(),A(t,{key:1,to:l(m).url,class:"item next",title:l(m).title},{default:$(()=>[s[1]||(s[1]=n("div",{class:"label"},[n("img",{src:oe,alt:"다음"}),n("span",null,"다음")],-1)),n("div",me,M(l(m).title),1)]),_:1},8,["to","title"])):I("",!0)])],2)}}}),fe=N(ve,[["__scopeId","data-v-086a2450"]]),_e={class:"section"},he={class:"container"},Ie={class:"wrapper"},Se={class:"main"},ge={key:0,class:"sources"},ke={key:1,class:"references"},ye={class:"navigation"},Ce=E({__name:"Section",setup(y){const u=U(),S=K(),p=w(),c=F(),m=b(),e=b(),s=b(),t=B({contentLoaded:!1}),r=h(()=>{var d;return(d=c.params.courseId)==null?void 0:d.toString()}),a=h(()=>{var d;return(d=c.params.chapterId)==null?void 0:d.toString()}),o=h(()=>{var d;return(d=c.params.sectionId)==null?void 0:d.toString()}),_=h(()=>p.getCourse(r.value)),C=h(()=>p.getSection(r.value,a.value,o.value)),P=d=>{var g,T;u.windowSize.width<=1399||(T=s.value)==null||T.scrollTo({top:d-s.value.offsetTop-(((g=e.value)==null?void 0:g.offsetHeight)||0),behavior:"smooth"})},V=()=>{t.contentLoaded=!0};return(d,g)=>{var L,R,D,W;const T=H("router-link");return i(),f("div",_e,[n("div",he,[n("div",Ie,[n("div",Se,[n("div",{class:"core",ref_key:"coreRef",ref:m},[(i(),A(de,{courseId:r.value,chapterId:a.value,sectionId:o.value,key:o.value,onContentLoaded:V},null,8,["courseId","chapterId","sectionId"]))],512),(R=(L=C.value)==null?void 0:L.sources)!=null&&R.length?(i(),f("div",ge,[v(se,{sources:C.value.sources},null,8,["sources"])])):I("",!0),(W=(D=C.value)==null?void 0:D.references)!=null&&W.length?(i(),f("div",ke,[v(ne,{references:C.value.references},null,8,["references"])])):I("",!0),n("div",ye,[v(fe,{courseId:r.value,chapterId:a.value,sectionId:o.value},null,8,["courseId","chapterId","sectionId"])])]),t.contentLoaded?(i(),f("div",{key:0,class:"chapters",ref_key:"chaptersRef",ref:s,style:Q({height:l(S).mainHeight})},[n("div",{class:"top",ref_key:"chaptersTopRef",ref:e},[v(T,{to:`/courses/${r.value}`,class:"btn"},{default:$(()=>{var O;return[g[0]||(g[0]=n("img",{src:re},null,-1)),n("span",null,M((O=_.value)==null?void 0:O.title),1)]}),_:1},8,["to"])],512),v(ce,{courseId:r.value,chapterId:a.value,sectionId:o.value,theme:"light",onScrollable:P},null,8,["courseId","chapterId","sectionId"])],4)):I("",!0)])])])}}}),Ee=N(Ce,[["__scopeId","data-v-f4e9a0ea"]]);export{Ee as default};
