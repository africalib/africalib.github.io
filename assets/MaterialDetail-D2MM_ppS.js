import{d as L,c as d,e,F as H,r as Y,t as C,g,o,_ as R,n as U,h as q,b as $,u as N,i as j,j as A,T as re,f as b,k as w,l as Q,m as B,p as W,q as Z,s as ee,v as le,w as ie,x as ce,y as F,z as ue,A as z,B as P,C as te,D as de,E as me,G as O}from"./index-IiTKwq4W.js";import{u as V,M as G}from"./material-CaP2SmlL.js";import{T as pe}from"./Tags-BmwCL14B.js";import{c as T}from"./commonLib-B4LiHA7t.js";import{C as ve}from"./CryptoHelper-m6j8gmxG.js";import{_ as _e,a as he,b as fe}from"./common.arrow.left-TSorRx6s.js";import{A as ge}from"./Above-Bvn0yyOb.js";import"./Panel-D4meor01.js";const ye={class:"common-sources"},ke={class:"items"},be={class:"item"},Se=["innerHTML"],$e=L({__name:"MaterialSources",props:{sources:{}},setup(_){const t=_;return(l,h)=>(o(),d("div",ye,[h[0]||(h[0]=e("div",{class:"subject"},"자료 출처",-1)),e("div",ke,[(o(!0),d(H,null,Y(t.sources,(f,v)=>(o(),d("div",be,[e("span",null,"["+C(v+1)+"] ",1),e("span",{innerHTML:g(T).linkify(f)},null,8,Se)]))),256))])]))}}),se=R($e,[["__scopeId","data-v-3b532ca9"]]),we={class:"common-references"},xe={class:"items"},Me={class:"item"},Te=L({__name:"MaterialReferences",props:{references:{}},setup(_){const t=_;return(l,h)=>(o(),d("div",we,[h[0]||(h[0]=e("div",{class:"subject"},"참고 자료",-1)),e("div",xe,[(o(!0),d(H,null,Y(t.references,f=>(o(),d("div",Me,[e("span",null,C(f),1)]))),256))])]))}}),ae=R(Te,[["__scopeId","data-v-9a0696c5"]]),Le=["innerHTML"],Ee=L({__name:"DocumentContent",props:{document:{},skeleton:{type:Boolean}},setup(_){const t=_;return(l,h)=>(o(),d("div",{class:U(["document-content",{skeleton:t.skeleton}])},[e("div",{innerHTML:t.document,ref:"contentRef"},null,8,Le)],2))}}),oe=R(Ee,[["__scopeId","data-v-af73dc37"]]),Re="/assets/images/component.document.presentation.slide.first.svg",Ce="/assets/images/component.material.presentation.finish.svg",X=L({__name:"DocumentPrompt",props:{content:{}},setup(_){const t=_;return q(()=>{console.info(t.content.replace(/\n{3,}/g,`

`))}),(l,h)=>null}}),Ae={class:"presentation"},He={class:"slides"},Ie={key:0,class:"slide start"},De={class:"container"},Pe={class:"slide-item"},qe=["innerHTML"],Ne={key:1,class:"slide finish"},je={class:"container"},Be={key:0,class:"slide"},Fe={class:"container"},K="no-overflow",ze=L({__name:"MaterialPresentation",props:{material:{},document:{}},setup(_){const t={touchStartX:0,touchStartY:0},l=_,h=N(),f=Q(),v=`이렇게 해서 ${T.extractText(l.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,c=$(()=>l.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),n=$(()=>{const u=[l.material.desc];return s.value.length===0&&a.value.length===1&&u.push(a.value[0]),u.join("")}),s=$(()=>{const u=new DOMParser().parseFromString(l.document,"text/html");return Array.from(u.querySelectorAll(".slide-item")).map(p=>p.outerHTML)}),a=$(()=>{const u=[],p={},k=new DOMParser().parseFromString(l.document,"text/html");Array.from(k.querySelectorAll(".slide-text")).forEach(r=>{const y=r.getAttribute("data-slide-text-group");y&&(!p[y]&&(p[y]=[]),p[y].push(T.replaceAll(r.outerText,"  ","").trim()))});for(let r in p)u.push(p[r].join(`
`));return u}),m=$(()=>{var u;return window.Number.parseInt(((u=h.query.idx)==null?void 0:u.toString())||"0")}),S=$(()=>s.value.length+1),i=u=>{const p=T.renew(h.query);let k=m.value+u;k<0?k=0:k>S.value&&(k=S.value),m.value!==k&&(p.idx=k.toString(),f.push({query:p}))},E=u=>{switch(u.key){case"ArrowLeft":!u.altKey&&i(-1);break;case"ArrowRight":!u.altKey&&i(1);break;case"F9":case"Escape":f.push({query:void 0});break}},x=u=>{const p=u.touches[0];t.touchStartX=p.clientX,t.touchStartY=p.clientY},M=u=>{const p=u.changedTouches[0],k=p.clientX,D=p.clientY,r=k-t.touchStartX,y=D-t.touchStartY;Math.abs(r)>Math.abs(y)&&Math.abs(r)>50&&(r>0?i(-1):i(1))};return q(()=>{document.addEventListener("keyup",E),document.addEventListener("touchstart",x),document.addEventListener("touchend",M),document.body.classList.add(K)}),j(()=>{document.removeEventListener("keyup",E),document.removeEventListener("touchstart",x),document.removeEventListener("touchend",M),document.body.classList.remove(K)}),(u,p)=>(o(),A(re,{to:"body"},[e("div",Ae,[e("div",He,[m.value===0?(o(),d("div",Ie,[e("div",De,[e("figure",Pe,[p[0]||(p[0]=e("img",{src:Re,alt:"코딩",loading:"lazy"},null,-1)),e("figcaption",null,[e("span",{innerHTML:c.value},null,8,qe),b(X,{content:n.value},null,8,["content"])])])])])):m.value===S.value?(o(),d("div",Ne,[e("div",je,[p[1]||(p[1]=e("figure",{class:"slide-item"},[e("img",{src:Ce,alt:"하이파이브",class:"mh-400",loading:"lazy"}),e("figcaption",null,[e("b",null,"이상 끝. "),e("span",null,"수고하셨습니다!")])],-1)),l.material.sources.length?(o(),A(se,{key:0,class:"w-100 mb-3",sources:l.material.sources},null,8,["sources"])):w("",!0),l.material.references.length?(o(),A(ae,{key:1,class:"w-100",references:l.material.references},null,8,["references"])):w("",!0),b(X,{content:v})])])):(o(!0),d(H,{key:2},Y(s.value.length,k=>(o(),d(H,null,[m.value===k?(o(),d("div",Be,[e("div",Fe,[b(oe,{document:s.value[k-1]},null,8,["document"]),b(X,{content:a.value[k-1]||""},null,8,["content"])])])):w("",!0)],64))),256))])])]))}}),Oe=R(ze,[["__scopeId","data-v-56f6ed8a"]]);function Xe(){const _=B(null),t=B(null),l=B(!1);return{data:_,error:t,loading:l,request:async({url:f,method:v="GET",body:c,contentType:n="application/json",...s})=>{l.value=!0,t.value=null;try{const a={"Content-Type":n,...s.headers||{}},m={method:v,headers:a,...s};c&&(m.body=n==="application/json"?JSON.stringify(c):c);const S=await fetch(f,m);if(!S.ok)throw new Error(`HTTP error! status: ${S.status}`);const i=S.headers.get("Content-Type");return i!=null&&i.includes("application/json")?_.value=await S.json():_.value=await S.text(),_.value}catch(a){throw t.value=a.message||"Unknown error",a}finally{l.value=!1}}}}const Ye={class:"presentation"},Ue={class:"content"},Ve={key:1},Ge=L({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(_){const t=N(),l=W(),h=Z(),f=V(t),{data:v,loading:c,request:n}=Xe(),s=_,a=ee({document:"<p>PLEASE WAIT A MOMENT</p>",accessible:!1}),m=()=>{if(!s.material.sources.length)return;const i=new DOMParser().parseFromString(a.document,"text/html");Array.from(i.querySelectorAll("[data-bs-toggle='popover']")).forEach((x,M)=>{if(!s.material.sources[M]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}x.setAttribute("title","자료 출처"),x.setAttribute("data-bs-content",T.linkify(s.material.sources[M])),x.innerText=`[${M+1}]`}),a.document=i.body.innerHTML},S=async()=>{const i=window.location.hostname==="localhost";if(a.accessible=s.material.locked?h.admin:!0,a.accessible){const E=f.getUrlPath(s.material);await n({url:`/assets${E}/document.html?${Date.now()}`,contentType:"text/html"});const x=ce.get(F.unlockPasswordCookieName);if(s.material.locked&&x&&!i){const M=new ve(x,F.salt,F.iv);v.value=await M.decrypt(v.value).catch(u=>(console.error({err:u,message:"문서를 복호화 할 수 없습니다."}),null))}a.document=T.linkify(v.value),m()}ue(()=>{s.onDocumentLoaded()}),l.updateSiteTitle(T.extractText(s.material.title))};return le(()=>{S()}),j(()=>{l.updateSiteTitle()}),ie(()=>t.path,()=>{S()}),(i,E)=>(o(),d("div",{class:U(["material-core",{skeleton:g(c)}])},[e("div",Ye,[g(t).query.mode==="presentation"&&!g(c)&&a.accessible?(o(),A(Oe,{key:0,material:s.material,document:a.document},null,8,["material","document"])):w("",!0)]),e("div",Ue,[a.accessible?(o(),A(oe,{key:0,document:a.document,skeleton:g(c)},null,8,["document","skeleton"])):(o(),d("div",Ve,"조회 가능한 문서가 없습니다."))])],2))}}),Ke=R(Ge,[["__scopeId","data-v-62f8a174"]]),Je={class:"wrapper"},Qe={class:"title"},We={class:"title"},Ze=L({__name:"MaterialNavigation",props:{material:{}},setup(_){const t=_,l=N(),h=V(l),f=z(()=>{var s;const n=[];return t.material&&((s=t.material.parent)==null||s.children.forEach(a=>{const m=h.getUrlPath(a);n.push({id:a.id,title:T.extractText(a.title),url:m})})),n}),v=z(()=>{var a;let n=null;const s=f.value;for(let m=0;m<s.length;m++)if(s[m].id===((a=t.material)==null?void 0:a.id)){n=s[m-1];break}return n}),c=z(()=>{var a;let n=null;const s=f.value;for(let m=0;m<s.length;m++)if(s[m].id===((a=t.material)==null?void 0:a.id)){n=s[m+1];break}return n});return(n,s)=>{const a=te("router-link");return o(),d("div",{class:U(["material-navigation",{both:g(v)&&g(c)}])},[e("div",Je,[g(v)?(o(),A(a,{key:0,to:g(v).url||"",class:"item prev",title:g(v).title},{default:P(()=>[s[0]||(s[0]=e("div",{class:"label"},[e("img",{src:_e,alt:"이전"}),e("span",null,"이전")],-1)),e("div",Qe,C(g(v).title),1)]),_:1},8,["to","title"])):w("",!0),g(c)?(o(),A(a,{key:1,to:g(c).url,class:"item next",title:g(c).title},{default:P(()=>[s[1]||(s[1]=e("div",{class:"label"},[e("img",{src:he,alt:"다음"}),e("span",null,"다음")],-1)),e("div",We,C(g(c).title),1)]),_:1},8,["to","title"])):w("",!0)])],2)}}}),et=R(Ze,[["__scopeId","data-v-1831093f"]]),tt={class:"material-above"},st={class:"back"},at={class:"bottom"},ot=["title"],nt=["title"],J="?mode=presentation",rt=L({__name:"MaterialAbove",props:{material:{}},setup(_){const t=_,l=Q(),h=Z(),f=c=>{c.key==="F9"&&l.push(J)},v=$(()=>{const c={title:"강의 자료",url:"/materials"};return t.material.parent&&(c.title=t.material.parent.title,c.url=t.material.parent.url),c});return q(()=>{document.addEventListener("keyup",f)}),j(()=>{document.removeEventListener("keyup",f)}),(c,n)=>{const s=te("router-link");return o(),d("div",tt,[e("div",st,[b(s,{to:v.value.url},{default:P(()=>[n[0]||(n[0]=e("img",{src:fe,alt:"뒤로가기",title:"뒤로가기"},null,-1)),e("span",null,C(v.value.title),1)]),_:1},8,["to"])]),b(ge,{title:g(T).extractText(t.material.title),desc:t.material.desc},null,8,["title","desc"]),e("div",at,[e("span",{title:t.material.created}," 생성: "+C(g(T).getHumanReadableDate(t.material.created)),9,ot),t.material.created!==t.material.updated?(o(),d(H,{key:0},[n[1]||(n[1]=e("span",{class:"bar"},null,-1)),e("span",{title:t.material.updated}," 수정: "+C(g(T).getHumanReadableDate(t.material.updated)),9,nt)],64)):w("",!0),t.material.presentation&&g(h).admin?(o(),d(H,{key:1},[n[3]||(n[3]=e("span",{class:"bar"},null,-1)),b(s,{to:J},{default:P(()=>n[2]||(n[2]=[de("발표(F9)")])),_:1})],64)):w("",!0)])])}}}),lt=R(rt,[["__scopeId","data-v-05ffdba9"]]),it={class:"material"},ct={class:"container"},ut={key:0,class:"list"},dt={class:"tags"},mt={key:1,class:"detail"},pt={class:"core",ref:"coreRef"},vt={key:0,class:"sources"},_t={key:1,class:"references"},ht={class:"navigation"},ft=L({__name:"MaterialDetail",setup(_){const t=N(),l=W(),h=me(),f=V(t),v=O("aboveRef"),c=O("mainRef"),n=O("materialsRef"),s=ee({contentLoaded:!1}),a=$(()=>{var r;return(r=t.params.id1)==null?void 0:r.toString()}),m=$(()=>{var r;return(r=t.params.id2)==null?void 0:r.toString()}),S=$(()=>{var r;return(r=t.params.id3)==null?void 0:r.toString()}),i=$(()=>f.get(a.value,m.value,S.value)),E=$(()=>{var r,y;return((y=(r=i.value)==null?void 0:r.parent)==null?void 0:y.children)||[]}),x=$(()=>{var y;const r=new Set;return r.add(void 0),(y=f.get(a.value))==null||y.tags.forEach(I=>r.add(I)),r}),M=$(()=>{if(t.query.tag)return window.decodeURIComponent(t.query.tag.toString())}),u=r=>{var y;l.windowSize.width<=1399||(k(),(y=n.value)==null||y.scrollTo({top:r-n.value.offsetTop,behavior:"smooth"}))},p=()=>{s.contentLoaded=!0},k=()=>{if(!v.value||!c.value||!n.value||l.windowSize.width<=1399)return;const r=v.value.getBoundingClientRect(),y=c.value.getBoundingClientRect(),I=Math.max(Math.min(r.bottom,l.windowSize.height)-Math.max(r.top,0),0),ne=h.mainHeight-I;n.value.style.maxHeight=Math.min(y.height,ne)+"px"},D=()=>{k()};return q(()=>{window.addEventListener("scroll",D)}),j(()=>{window.removeEventListener("scroll",D)}),(r,y)=>{var I;return o(),d("div",it,[e("div",ct,[i.value?(o(),d(H,{key:0},[e("div",{class:"above",ref_key:"aboveRef",ref:v},[b(lt,{material:i.value},null,8,["material"])],512),i.value.children.length?(o(),d("div",ut,[e("div",dt,[b(pe,{tags:x.value,tag:M.value},null,8,["tags","tag"])]),b(G,{materials:i.value.children,tag:M.value},null,8,["materials","tag"])])):(o(),d("div",mt,[e("div",{class:"main",ref_key:"mainRef",ref:c},[e("div",pt,[b(Ke,{material:i.value,onDocumentLoaded:p},null,8,["material"])],512),!i.value.locked&&i.value.sources.length?(o(),d("div",vt,[b(se,{sources:i.value.sources},null,8,["sources"])])):w("",!0),!i.value.locked&&((I=i.value.references)!=null&&I.length)?(o(),d("div",_t,[b(ae,{references:i.value.references},null,8,["references"])])):w("",!0),e("div",ht,[b(et,{material:i.value},null,8,["material"])])],512),s.contentLoaded?(o(),d("div",{key:0,class:"materials",ref_key:"materialsRef",ref:n},[b(G,{materials:E.value,onScrollable:u},null,8,["materials"])],512)):w("",!0)]))],64)):w("",!0)])])}}}),Mt=R(ft,[["__scopeId","data-v-486b0fea"]]);export{Mt as default};
