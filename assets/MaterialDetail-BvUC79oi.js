import{d as T,g as $,c as l,b as s,F as E,r as P,t as q,u as f,o as n,_ as A,n as X,i as Y,h as R,j as K,k as I,f as b,l as S,T as oe,m as Z,p as F,q as re,s as N,v as ee,w as le,x as ce,y as ie,z as B,A as ue,B as O,C as H,D as z,E as te}from"./index-BEwg3GO5.js";import{u as V,M as J}from"./material-BPHkdOjy.js";import{c as M}from"./commonLib-Co9BQnS0.js";import{C as de}from"./CryptoHelper-m6j8gmxG.js";import{_ as me,a as pe,b as _e}from"./common.arrow.left-TSorRx6s.js";import{r as ve}from"./routeLib-DhAZaWiT.js";import{A as fe}from"./Above-Drn3KU2d.js";import"./Panel-C8576ke2.js";const he={class:"common-sources"},ge={class:"items"},ye=["innerHTML"],ke=T({__name:"MaterialSources",props:{sources:{}},setup(h){const e=h,c=$(()=>{const _=new Map;return e.sources.forEach((o,m)=>{_.has(o)||_.set(o,[]),_.get(o).push(m+1)}),Array.from(_.entries()).map(([o,m])=>({indexes:m,src:o}))});return(_,o)=>(n(),l("div",he,[o[1]||(o[1]=s("div",{class:"subject"},"자료 출처",-1)),s("div",ge,[(n(!0),l(E,null,P(c.value,m=>(n(),l("div",{class:"item",key:m.src},[(n(!0),l(E,null,P(m.indexes,u=>(n(),l("span",null,"["+q(u)+"]",1))),256)),o[0]||(o[0]=s("span",null," ",-1)),s("span",{innerHTML:f(M).linkify(m.src)},null,8,ye)]))),128))])]))}}),se=A(ke,[["__scopeId","data-v-a34ac84b"]]),$e={class:"common-references"},be={class:"items"},we={class:"item"},xe=T({__name:"MaterialReferences",props:{references:{}},setup(h){const e=h;return(c,_)=>(n(),l("div",$e,[_[0]||(_[0]=s("div",{class:"subject"},"참고 자료",-1)),s("div",be,[(n(!0),l(E,null,P(e.references,o=>(n(),l("div",we,[s("span",null,q(o),1)]))),256))])]))}}),ne=A(xe,[["__scopeId","data-v-64c8b31c"]]),Me=["innerHTML"],Se=T({__name:"DocumentContent",props:{document:{},skeleton:{type:Boolean}},setup(h){const e=h;return(c,_)=>(n(),l("div",{class:X(["document-content",{skeleton:e.skeleton}])},[s("div",{innerHTML:e.document,ref:"contentRef"},null,8,Me)],2))}}),ae=A(Se,[["__scopeId","data-v-7a52ca4e"]]),Te="/assets/images/component.document.presentation.slide.first.svg",Le="/assets/images/component.material.presentation.finish.svg",U=T({__name:"DocumentPrompt",props:{content:{}},setup(h){const e=h;return Y(()=>{console.info(e.content.replace(/\n{3,}/g,`

`))}),(c,_)=>null}}),Ee={class:"presentation"},Ae={class:"slides"},Ce={key:0,class:"slide start"},De={class:"container"},Ie={class:"slide-item"},qe=["innerHTML"],He={key:1,class:"slide finish"},Pe={class:"container"},Re={key:0,class:"slide"},Ne={class:"container"},Q="no-overflow",je=T({__name:"MaterialPresentation",props:{material:{},document:{}},setup(h){const e={touchStartX:0,touchStartY:0},c=h,_=R(),o=Z(),m=`이렇게 해서 ${M.extractText(c.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,u=$(()=>c.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),i=$(()=>{const p=[c.material.desc];return a.value.length===0&&t.value.length===1&&p.push(t.value[0]),p.join("")}),a=$(()=>{const p=new DOMParser().parseFromString(c.document,"text/html");return Array.from(p.querySelectorAll(".slide-item")).map(v=>v.outerHTML)}),t=$(()=>{const p=[],v={},w=new DOMParser().parseFromString(c.document,"text/html");Array.from(w.querySelectorAll(".slide-text")).forEach(L=>{const D=L.getAttribute("data-slide-text-group");D&&(!v[D]&&(v[D]=[]),v[D].push(M.replaceAll(L.outerText,"  ","").trim()))});for(let L in v)p.push(v[L].join(`
`));return p}),r=$(()=>{var p;return window.Number.parseInt(((p=_.query.idx)==null?void 0:p.toString())||"0")}),g=$(()=>a.value.length+1),y=p=>{const v=M.renew(_.query);let w=r.value+p;w<0?w=0:w>g.value&&(w=g.value),r.value!==w&&(v.idx=w.toString(),o.push({query:v}))},d=(p,v)=>{switch(p){case"ArrowLeft":!v&&y(-1);break;case"ArrowRight":!v&&y(1);break;case"F9":case"Escape":o.push({query:void 0});break}},k=p=>{d(p.key,p.altKey)},x=p=>{const v=p.touches[0];e.touchStartX=v.clientX,e.touchStartY=v.clientY},C=p=>{const v=p.changedTouches[0],w=v.clientX,G=v.clientY,L=w-e.touchStartX,D=G-e.touchStartY;Math.abs(L)>Math.abs(D)&&Math.abs(L)>50&&(L>0?y(-1):y(1))},j=p=>{p.data.type==="keyup"&&d(p.data.key,p.data.altKey)};return Y(()=>{document.addEventListener("keyup",k),document.addEventListener("touchstart",x),document.addEventListener("touchend",C),window.addEventListener("message",j),document.body.classList.add(Q)}),K(()=>{document.removeEventListener("keyup",k),document.removeEventListener("touchstart",x),document.removeEventListener("touchend",C),window.removeEventListener("message",j),document.body.classList.remove(Q)}),(p,v)=>(n(),I(oe,{to:"body"},[s("div",Ee,[s("div",Ae,[r.value===0?(n(),l("div",Ce,[s("div",De,[s("figure",Ie,[v[0]||(v[0]=s("img",{src:Te,alt:"코딩",loading:"lazy"},null,-1)),s("figcaption",null,[s("span",{innerHTML:u.value},null,8,qe),b(U,{content:i.value},null,8,["content"])])])])])):r.value===g.value?(n(),l("div",He,[s("div",Pe,[v[1]||(v[1]=s("figure",{class:"slide-item"},[s("img",{src:Le,alt:"하이파이브",class:"mh-400",loading:"lazy"}),s("figcaption",null,[s("b",null,"이상 끝. "),s("span",null,"수고하셨습니다!")])],-1)),c.material.sources.length?(n(),I(se,{key:0,class:"w-100 mb-3",sources:c.material.sources},null,8,["sources"])):S("",!0),c.material.references.length?(n(),I(ne,{key:1,class:"w-100",references:c.material.references},null,8,["references"])):S("",!0),b(U,{content:m})])])):(n(!0),l(E,{key:2},P(a.value.length,w=>(n(),l(E,null,[r.value===w?(n(),l("div",Re,[s("div",Ne,[b(ae,{document:a.value[w-1]},null,8,["document"]),b(U,{content:t.value[w-1]||""},null,8,["content"])])])):S("",!0)],64))),256))])])]))}}),Fe=A(je,[["__scopeId","data-v-6bffa037"]]);function Be(){const h=F(null),e=F(null),c=F(!1);return{data:h,error:e,loading:c,request:async({url:o,method:m="GET",body:u,contentType:i="application/json",...a})=>{c.value=!0,e.value=null;try{const t={"Content-Type":i,...a.headers||{}},r={method:m,headers:t,...a};u&&(r.body=i==="application/json"?JSON.stringify(u):u);const g=await fetch(o,r);if(!g.ok)throw new Error(`HTTP error! status: ${g.status}`);const y=g.headers.get("Content-Type");return y!=null&&y.includes("application/json")?h.value=await g.json():h.value=await g.text(),h.value}catch(t){throw e.value=t.message||"Unknown error",t}finally{c.value=!1}}}}const Oe={key:0,class:"presentation"},Ue={class:"content"},Xe={key:1,class:"empty"},Ye=T({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(h){const e=R(),c=re(),_=N(),o=V(e),{data:m,loading:u,request:i}=Be(),a=h,t=ee({document:"<p>PLEASE WAIT A MOMENT</p>"}),r=()=>{if(!a.material.sources.length)return;const y=new DOMParser().parseFromString(t.document,"text/html");Array.from(y.querySelectorAll("[data-bs-toggle='popover']")).forEach((k,x)=>{if(!a.material.sources[x]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}k.setAttribute("title","자료 출처"),k.setAttribute("data-bs-content",M.linkify(a.material.sources[x])),k.innerText=`[${x+1}]`}),t.document=y.body.innerHTML},g=async()=>{if(a.material){const y=o.getUrlPath(a.material);await i({url:`/assets${y}/document.html?${Date.now()}`,contentType:"text/html"});const d=ie.get(B.unlockPasswordCookieName),k=window.location.hostname==="localhost";if(a.material.locked&&d&&!k){const x=new de(d,B.salt,B.iv);m.value=await x.decrypt(m.value).catch(C=>(console.error({err:C,message:"문서를 복호화 할 수 없습니다."}),null))}t.document=M.linkify(m.value),r()}ue(()=>{a.onDocumentLoaded()}),c.updateSiteTitle(M.extractText(a.material.title))};return le(()=>{g()}),K(()=>{c.updateSiteTitle()}),ce(()=>e.path,()=>{g()}),(y,d)=>(n(),l("div",{class:X(["material-core",{skeleton:f(u)}])},[f(e).query.mode==="presentation"&&!f(u)&&f(_).admin?(n(),l("div",Oe,[b(Fe,{material:a.material,document:t.document},null,8,["material","document"])])):S("",!0),s("div",Ue,[t.document?(n(),I(ae,{key:0,document:t.document,skeleton:f(u)},null,8,["document","skeleton"])):(n(),l("div",Xe,"조회 가능한 문서가 없습니다."))])],2))}}),Ke=A(Ye,[["__scopeId","data-v-8f542003"]]),ze={class:"wrapper"},Ve={class:"title"},Ge={class:"title"},Je=T({__name:"MaterialNavigation",props:{material:{}},setup(h){const e=h,c=R();N(),V(c);const _=O(()=>{var i,a;const u=[];if((a=(i=e.material)==null?void 0:i.parent)!=null&&a.children){const t=ve.getTag(c);e.material.parent.children.forEach(r=>{(!t||r.tags.includes(t))&&u.push(r)})}return u}),o=O(()=>{var a;let u=null;const i=_.value;for(let t=0;t<i.length;t++)if(i[t].id===((a=e.material)==null?void 0:a.id)&&i[t-1]){u=i[t-1];break}return u}),m=O(()=>{var a;let u=null;const i=_.value;for(let t=0;t<i.length;t++)if(i[t].id===((a=e.material)==null?void 0:a.id)&&i[t+1]){u=i[t+1];break}return u});return(u,i)=>{const a=z("router-link");return n(),l("div",{class:X(["material-navigation",{both:f(o)&&f(m)}])},[s("div",ze,[f(o)?(n(),I(a,{key:0,to:f(o).url||"",class:"item prev",title:f(o).title},{default:H(()=>[i[0]||(i[0]=s("div",{class:"label"},[s("img",{src:me,alt:"이전"}),s("span",null,"이전")],-1)),s("div",Ve,q(f(M).extractText(f(o).title)),1)]),_:1},8,["to","title"])):S("",!0),f(m)?(n(),I(a,{key:1,to:f(m).url,class:"item next",title:f(m).title},{default:H(()=>[i[1]||(i[1]=s("div",{class:"label"},[s("img",{src:pe,alt:"다음"}),s("span",null,"다음")],-1)),s("div",Ge,q(f(M).extractText(f(m).title)),1)]),_:1},8,["to","title"])):S("",!0)])],2)}}}),Qe=A(Je,[["__scopeId","data-v-edc97d56"]]),We={class:"material-above"},Ze={class:"back"},et={class:"wrapper"},tt={class:"dates"},st=["title"],W="?mode=presentation",nt=T({__name:"MaterialAbove",props:{material:{}},setup(h){const e=h,c=Z(),_=N(),o=r=>{r==="F9"&&_.admin&&c.push(W)},m=r=>{o(r.key)},u=$(()=>{const r={title:"강의 자료",url:"/materials"};return e.material.parent&&(r.title=e.material.parent.title,r.url=e.material.parent.url),r}),i=$(()=>e.material.created?e.material.updated?M.getHumanReadableDate(e.material.updated)+" 업데이트됨":M.getHumanReadableDate(e.material.created)+" 생성됨":"(N/A)"),a=$(()=>{if(e.material.created){const r=[`생성: ${e.material.created}`];return e.material.updated&&r.push(`업데이트: ${e.material.created}`),r.join(" | ")}}),t=r=>{r.data.type==="keyup"&&o(r.data.key)};return Y(()=>{document.addEventListener("keyup",m),window.addEventListener("message",t)}),K(()=>{document.removeEventListener("keyup",m),window.removeEventListener("message",t)}),(r,g)=>{const y=z("router-link");return n(),l("div",We,[s("div",Ze,[b(y,{to:u.value.url},{default:H(()=>[g[0]||(g[0]=s("img",{src:_e,alt:"뒤로가기",title:"뒤로가기"},null,-1)),s("span",null,q(u.value.title),1)]),_:1},8,["to"])]),s("div",et,[s("div",tt,[s("span",{title:a.value},q(i.value),9,st),e.material.presentation&&f(_).admin?(n(),l(E,{key:0},[g[2]||(g[2]=s("span",{class:"bar"},null,-1)),b(y,{to:W},{default:H(()=>g[1]||(g[1]=[te("발표(F9)")])),_:1})],64)):S("",!0)]),b(fe,{title:f(M).extractText(e.material.title),desc:e.material.desc},null,8,["title","desc"])])])}}}),at=A(nt,[["__scopeId","data-v-f7a291a7"]]),ot={class:"material"},rt={class:"container"},lt={class:"above",ref:"aboveRef"},ct={key:0,class:"list"},it={key:1,class:"detail"},ut={class:"main",ref:"mainRef"},dt={class:"core",ref:"coreRef"},mt={key:0,class:"sources"},pt={key:1,class:"references"},_t={key:1,class:"login"},vt={class:"navigation"},ft={key:0,class:"materials",ref:"materialsRef"},ht={key:1,class:"empty"},gt=T({__name:"MaterialDetail",setup(h){const e=R(),c=N(),_=V(e),o=ee({contentLoaded:!1}),m=$(()=>{var d;return!((d=t.value)!=null&&d.locked)||c.admin}),u=$(()=>{var d;return(d=e.params.id1)==null?void 0:d.toString()}),i=$(()=>{var d;return(d=e.params.id2)==null?void 0:d.toString()}),a=$(()=>{var d;return(d=e.params.id3)==null?void 0:d.toString()}),t=$(()=>_.get(u.value,i.value,a.value)),r=$(()=>{var d,k;return((k=(d=t.value)==null?void 0:d.parent)==null?void 0:k.children)||[]});$(()=>{var k;const d=new Set;return d.add(void 0),(k=_.get(u.value))==null||k.tags.forEach(x=>d.add(x)),d});const g=$(()=>{if(e.query.tag)return window.decodeURIComponent(e.query.tag.toString())}),y=()=>{o.contentLoaded=!0};return(d,k)=>{var C;const x=z("router-link");return n(),l("div",ot,[s("div",rt,[t.value?(n(),l(E,{key:0},[s("div",lt,[b(at,{material:t.value},null,8,["material"])],512),t.value.children.length?(n(),l("div",ct,[b(J,{materials:t.value.children,tag:g.value},null,8,["materials","tag"])])):(n(),l("div",it,[s("div",ut,[m.value?(n(),l(E,{key:0},[s("div",dt,[b(Ke,{material:t.value,onDocumentLoaded:y},null,8,["material"])],512),t.value.sources.length?(n(),l("div",mt,[b(se,{sources:t.value.sources},null,8,["sources"])])):S("",!0),(C=t.value.references)!=null&&C.length?(n(),l("div",pt,[b(ne,{references:t.value.references},null,8,["references"])])):S("",!0)],64)):(n(),l("div",_t,[b(x,{to:f(c).getLoginUrl(f(e),!0)},{default:H(()=>k[0]||(k[0]=[te("로그인")])),_:1},8,["to"]),k[1]||(k[1]=s("span",null,"이 필요합니다.",-1))])),s("div",vt,[b(Qe,{material:t.value},null,8,["material"])])],512),o.contentLoaded&&r.value.length?(n(),l("div",ft,[b(J,{materials:r.value},null,8,["materials"])],512)):S("",!0)]))],64)):(n(),l("div",ht,"접근 가능한 데이터가 없습니다."))])])}}}),Tt=A(gt,[["__scopeId","data-v-7a36ab08"]]);export{Tt as default};
