import{d as w,c,e as a,F as D,r as B,t as I,g as _,o as n,_ as E,n as O,h as V,b as $,u as H,i as X,j as C,f as b,k as M,T as se,l as J,m as R,p as ae,q as P,s as Q,v as oe,w as ne,x as re,y as N,z as le,A as j,B as q,C as W,D as ce}from"./index-DT7Zock-.js";import{u as Y,M as z}from"./Materials-DWtdhewe.js";import{T as ie}from"./Tags-Z807mDG0.js";import{c as T}from"./commonLib-B4LiHA7t.js";import{C as ue}from"./CryptoHelper-m6j8gmxG.js";import{_ as de,a as me,b as pe}from"./common.arrow.left-TSorRx6s.js";import{r as _e}from"./routeLib-DhAZaWiT.js";import{A as ve}from"./Above-CuaBtdmq.js";import"./Panel--pOY2m6u.js";const he={class:"common-sources"},fe={class:"items"},ge={class:"item"},ye=["innerHTML"],ke=w({__name:"MaterialSources",props:{sources:{}},setup(p){const t=p;return(r,i)=>(n(),c("div",he,[i[0]||(i[0]=a("div",{class:"subject"},"자료 출처",-1)),a("div",fe,[(n(!0),c(D,null,B(t.sources,(v,g)=>(n(),c("div",ge,[a("span",null,"["+I(g+1)+"] ",1),a("span",{innerHTML:_(T).linkify(v)},null,8,ye)]))),256))])]))}}),Z=E(ke,[["__scopeId","data-v-3b532ca9"]]),be={class:"common-references"},$e={class:"items"},xe={class:"item"},Se=w({__name:"MaterialReferences",props:{references:{}},setup(p){const t=p;return(r,i)=>(n(),c("div",be,[i[0]||(i[0]=a("div",{class:"subject"},"참고 자료",-1)),a("div",$e,[(n(!0),c(D,null,B(t.references,v=>(n(),c("div",xe,[a("span",null,I(v),1)]))),256))])]))}}),ee=E(Se,[["__scopeId","data-v-9a0696c5"]]),Te=["innerHTML"],Me=w({__name:"DocumentContent",props:{document:{},skeleton:{type:Boolean}},setup(p){const t=p;return(r,i)=>(n(),c("div",{class:O(["document-content",{skeleton:t.skeleton}])},[a("div",{innerHTML:t.document,ref:"contentRef"},null,8,Te)],2))}}),te=E(Me,[["__scopeId","data-v-ab08b7b9"]]),we="/assets/images/component.document.presentation.slide.first.svg",Le="/assets/images/component.material.presentation.finish.svg",F=w({__name:"DocumentPrompt",props:{content:{}},setup(p){const t=p;return V(()=>{console.info(t.content.replace(/\n{3,}/g,`

`))}),(r,i)=>null}}),Ee={class:"presentation"},Ae={class:"slides"},Ce={key:0,class:"slide start"},De={class:"container"},Ie={class:"slide-item"},qe=["innerHTML"],He={key:1,class:"slide finish"},Pe={class:"container"},Re={key:0,class:"slide"},Ne={class:"container"},K="no-overflow",je=w({__name:"MaterialPresentation",props:{material:{},document:{}},setup(p){const t={touchStartX:0,touchStartY:0},r=p,i=H(),v=J(),g=`이렇게 해서 ${T.extractText(r.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,h=$(()=>r.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),y=$(()=>{const d=[r.material.desc];return e.value.length===0&&s.value.length===1&&d.push(s.value[0]),d.join("")}),e=$(()=>{const d=new DOMParser().parseFromString(r.document,"text/html");return Array.from(d.querySelectorAll(".slide-item")).map(m=>m.outerHTML)}),s=$(()=>{const d=[],m={},S=new DOMParser().parseFromString(r.document,"text/html");Array.from(S.querySelectorAll(".slide-text")).forEach(L=>{const A=L.getAttribute("data-slide-text-group");A&&(!m[A]&&(m[A]=[]),m[A].push(T.replaceAll(L.outerText,"  ","").trim()))});for(let L in m)d.push(m[L].join(`
`));return d}),l=$(()=>{var d;return window.Number.parseInt(((d=i.query.idx)==null?void 0:d.toString())||"0")}),o=$(()=>e.value.length+1),f=d=>{const m=T.renew(i.query);let S=l.value+d;S<0?S=0:S>o.value&&(S=o.value),l.value!==S&&(m.idx=S.toString(),v.push({query:m}))},u=d=>{switch(d.key){case"ArrowLeft":!d.altKey&&f(-1);break;case"ArrowRight":!d.altKey&&f(1);break;case"F9":case"Escape":v.push({query:void 0});break}},k=d=>{const m=d.touches[0];t.touchStartX=m.clientX,t.touchStartY=m.clientY},x=d=>{const m=d.changedTouches[0],S=m.clientX,U=m.clientY,L=S-t.touchStartX,A=U-t.touchStartY;Math.abs(L)>Math.abs(A)&&Math.abs(L)>50&&(L>0?f(-1):f(1))};return V(()=>{document.addEventListener("keyup",u),document.addEventListener("touchstart",k),document.addEventListener("touchend",x),document.body.classList.add(K)}),X(()=>{document.removeEventListener("keyup",u),document.removeEventListener("touchstart",k),document.removeEventListener("touchend",x),document.body.classList.remove(K)}),(d,m)=>(n(),C(se,{to:"body"},[a("div",Ee,[a("div",Ae,[l.value===0?(n(),c("div",Ce,[a("div",De,[a("figure",Ie,[m[0]||(m[0]=a("img",{src:we,alt:"코딩",loading:"lazy"},null,-1)),a("figcaption",null,[a("span",{innerHTML:h.value},null,8,qe),b(F,{content:y.value},null,8,["content"])])])])])):l.value===o.value?(n(),c("div",He,[a("div",Pe,[m[1]||(m[1]=a("figure",{class:"slide-item"},[a("img",{src:Le,alt:"하이파이브",class:"mh-400",loading:"lazy"}),a("figcaption",null,[a("b",null,"이상 끝. "),a("span",null,"수고하셨습니다!")])],-1)),r.material.sources.length?(n(),C(Z,{key:0,class:"w-100 mb-3",sources:r.material.sources},null,8,["sources"])):M("",!0),r.material.references.length?(n(),C(ee,{key:1,class:"w-100",references:r.material.references},null,8,["references"])):M("",!0),b(F,{content:g})])])):(n(!0),c(D,{key:2},B(e.value.length,S=>(n(),c(D,null,[l.value===S?(n(),c("div",Re,[a("div",Ne,[b(te,{document:e.value[S-1]},null,8,["document"]),b(F,{content:s.value[S-1]||""},null,8,["content"])])])):M("",!0)],64))),256))])])]))}}),Fe=E(je,[["__scopeId","data-v-56f6ed8a"]]);function Be(){const p=R(null),t=R(null),r=R(!1);return{data:p,error:t,loading:r,request:async({url:v,method:g="GET",body:h,contentType:y="application/json",...e})=>{r.value=!0,t.value=null;try{const s={"Content-Type":y,...e.headers||{}},l={method:g,headers:s,...e};h&&(l.body=y==="application/json"?JSON.stringify(h):h);const o=await fetch(v,l);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const f=o.headers.get("Content-Type");return f!=null&&f.includes("application/json")?p.value=await o.json():p.value=await o.text(),p.value}catch(s){throw t.value=s.message||"Unknown error",s}finally{r.value=!1}}}}const Oe={key:0,class:"presentation"},Ve={class:"content"},Xe={key:1,class:"empty"},Ye=w({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(p){const t=H(),r=ae(),i=P(),v=Y(t),{data:g,loading:h,request:y}=Be(),e=p,s=Q({document:"<p>PLEASE WAIT A MOMENT</p>",accessible:!1}),l=()=>{if(!e.material.sources.length)return;const f=new DOMParser().parseFromString(s.document,"text/html");Array.from(f.querySelectorAll("[data-bs-toggle='popover']")).forEach((k,x)=>{if(!e.material.sources[x]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}k.setAttribute("title","자료 출처"),k.setAttribute("data-bs-content",T.linkify(e.material.sources[x])),k.innerText=`[${x+1}]`}),s.document=f.body.innerHTML},o=async()=>{const f=window.location.hostname==="localhost";if(s.accessible=e.material.locked?i.admin:!0,s.accessible){const u=v.getUrlPath(e.material);await y({url:`/assets${u}/document.html?${Date.now()}`,contentType:"text/html"});const k=re.get(N.unlockPasswordCookieName);if(e.material.locked&&k&&!f){const x=new ue(k,N.salt,N.iv);g.value=await x.decrypt(g.value).catch(d=>(console.error({err:d,message:"문서를 복호화 할 수 없습니다."}),null))}s.document=T.linkify(g.value),l()}le(()=>{e.onDocumentLoaded()}),r.updateSiteTitle(T.extractText(e.material.title))};return oe(()=>{o()}),X(()=>{r.updateSiteTitle()}),ne(()=>t.path,()=>{o()}),(f,u)=>(n(),c("div",{class:O(["material-core",{skeleton:_(h)}])},[_(t).query.mode==="presentation"&&!_(h)&&s.accessible&&_(i).admin?(n(),c("div",Oe,[b(Fe,{material:e.material,document:s.document},null,8,["material","document"])])):M("",!0),a("div",Ve,[s.accessible&&s.document?(n(),C(te,{key:0,document:s.document,skeleton:_(h)},null,8,["document","skeleton"])):(n(),c("div",Xe,"조회 가능한 문서가 없습니다."))])],2))}}),Ue=E(Ye,[["__scopeId","data-v-5f387f22"]]),ze={class:"wrapper"},Ke={class:"title"},Ge={class:"title"},Je=w({__name:"MaterialNavigation",props:{material:{}},setup(p){const t=p,r=H(),i=P(),v=Y(r),g=j(()=>{var s,l;const e=[];if((l=(s=t.material)==null?void 0:s.parent)!=null&&l.children){const o=_e.getTag(r);t.material.parent.children.forEach(f=>{(!o||f.tags.includes(o))&&e.push(f)})}return e}),h=j(()=>{var l;let e=null;const s=g.value;for(let o=0;o<s.length;o++)if(s[o].id===((l=t.material)==null?void 0:l.id)&&s[o-1]&&v.isVisible(s[o-1],i.admin)){e=s[o-1];break}return e}),y=j(()=>{var l;let e=null;const s=g.value;for(let o=0;o<s.length;o++)if(s[o].id===((l=t.material)==null?void 0:l.id)&&s[o+1]&&v.isVisible(s[o+1],i.admin)){e=s[o+1];break}return e});return(e,s)=>{const l=W("router-link");return n(),c("div",{class:O(["material-navigation",{both:_(h)&&_(y)}])},[a("div",ze,[_(h)?(n(),C(l,{key:0,to:_(h).url||"",class:"item prev",title:_(h).title},{default:q(()=>[s[0]||(s[0]=a("div",{class:"label"},[a("img",{src:de,alt:"이전"}),a("span",null,"이전")],-1)),a("div",Ke,I(_(T).extractText(_(h).title)),1)]),_:1},8,["to","title"])):M("",!0),_(y)?(n(),C(l,{key:1,to:_(y).url,class:"item next",title:_(y).title},{default:q(()=>[s[1]||(s[1]=a("div",{class:"label"},[a("img",{src:me,alt:"다음"}),a("span",null,"다음")],-1)),a("div",Ge,I(_(T).extractText(_(y).title)),1)]),_:1},8,["to","title"])):M("",!0)])],2)}}}),Qe=E(Je,[["__scopeId","data-v-a593699b"]]),We={class:"material-above"},Ze={class:"back"},et={class:"wrapper"},tt={class:"dates"},st=["title"],G="?mode=presentation",at=w({__name:"MaterialAbove",props:{material:{}},setup(p){const t=p,r=J(),i=P(),v=e=>{e.key==="F9"&&i.admin&&r.push(G)},g=$(()=>{const e={title:"강의 자료",url:"/materials"};return t.material.parent&&(e.title=t.material.parent.title,e.url=t.material.parent.url),e}),h=$(()=>t.material.updated&&t.material.created!==t.material.updated?T.getHumanReadableDate(t.material.updated)+" 수정":T.getHumanReadableDate(t.material.created)+" 생성"),y=$(()=>{const e=[`생성: ${t.material.created}`];return t.material.updated&&t.material.created!==t.material.updated&&e.push(`수정: ${t.material.created}`),e.join(" | ")});return V(()=>{document.addEventListener("keyup",v)}),X(()=>{document.removeEventListener("keyup",v)}),(e,s)=>{const l=W("router-link");return n(),c("div",We,[a("div",Ze,[b(l,{to:g.value.url},{default:q(()=>[s[0]||(s[0]=a("img",{src:pe,alt:"뒤로가기",title:"뒤로가기"},null,-1)),a("span",null,I(g.value.title),1)]),_:1},8,["to"])]),a("div",et,[a("div",tt,[a("span",{title:y.value},I(h.value),9,st),t.material.presentation&&_(i).admin?(n(),c(D,{key:0},[s[2]||(s[2]=a("span",{class:"bar"},null,-1)),b(l,{to:G},{default:q(()=>s[1]||(s[1]=[ce("발표(F9)")])),_:1})],64)):M("",!0)]),b(ve,{title:_(T).extractText(t.material.title),desc:t.material.desc},null,8,["title","desc"])])])}}}),ot=E(at,[["__scopeId","data-v-0edbb8a4"]]),nt={class:"material"},rt={class:"container"},lt={class:"above",ref:"aboveRef"},ct={key:0,class:"list"},it={class:"tags"},ut={key:1,class:"detail"},dt={class:"main",ref:"mainRef"},mt={class:"core",ref:"coreRef"},pt={key:0,class:"sources"},_t={key:1,class:"references"},vt={class:"navigation"},ht={key:0,class:"materials",ref:"materialsRef"},ft=w({__name:"MaterialDetail",setup(p){const t=H(),r=P(),i=Y(t),v=Q({contentLoaded:!1}),g=$(()=>{var u;return(u=t.params.id1)==null?void 0:u.toString()}),h=$(()=>{var u;return(u=t.params.id2)==null?void 0:u.toString()}),y=$(()=>{var u;return(u=t.params.id3)==null?void 0:u.toString()}),e=$(()=>i.get(g.value,h.value,y.value)),s=$(()=>{var u,k;return((k=(u=e.value)==null?void 0:u.parent)==null?void 0:k.children.filter(x=>i.isVisible(x,r.admin)))||[]}),l=$(()=>{var k;const u=new Set;return u.add(void 0),(k=i.get(g.value))==null||k.tags.forEach(x=>u.add(x)),u}),o=$(()=>{if(t.query.tag)return window.decodeURIComponent(t.query.tag.toString())}),f=()=>{v.contentLoaded=!0};return(u,k)=>{var x;return n(),c("div",nt,[a("div",rt,[e.value?(n(),c(D,{key:0},[a("div",lt,[b(ot,{material:e.value},null,8,["material"])],512),e.value.children.length?(n(),c("div",ct,[a("div",it,[b(ie,{tags:l.value,tag:o.value},null,8,["tags","tag"])]),b(z,{materials:e.value.children,tag:o.value},null,8,["materials","tag"])])):(n(),c("div",ut,[a("div",dt,[a("div",mt,[b(Ue,{material:e.value,onDocumentLoaded:f},null,8,["material"])],512),!e.value.locked&&e.value.sources.length?(n(),c("div",pt,[b(Z,{sources:e.value.sources},null,8,["sources"])])):M("",!0),!e.value.locked&&((x=e.value.references)!=null&&x.length)?(n(),c("div",_t,[b(ee,{references:e.value.references},null,8,["references"])])):M("",!0),a("div",vt,[b(Qe,{material:e.value},null,8,["material"])])],512),v.contentLoaded&&s.value.length?(n(),c("div",ht,[b(z,{materials:s.value},null,8,["materials"])],512)):M("",!0)]))],64)):M("",!0)])])}}}),wt=E(ft,[["__scopeId","data-v-33e868a5"]]);export{wt as default};
