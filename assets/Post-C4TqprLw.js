import{d as S,i as E,q as _,s as b,n as R,l as N,c as r,x as $,g,u as L,j as M,F as x,e as c,m as p,b as d,y as D,o as s,_ as P,A as U,v as A,B as W}from"./index-DuOr29h2.js";import{c as C}from"./commonLib-DZoi0k1s.js";import{D as B,a as O,b as w,c as F,C as V,d as q}from"./DocumentHeader-BtZmuTrA.js";import{p as I,P as H}from"./Posts-Dogjzj44.js";const z={key:0,class:"video"},j={class:"content"},G=S({__name:"PostCore",props:{id:{},onContentLoaded:{type:Function}},setup(v){const l=E(),f=M(),i=v,m=_(),e=b({loaded:!1,title:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),a=()=>{const t=new DOMParser().parseFromString(e.content,"text/html");Array.from(t.querySelectorAll("[data-bs-toggle='popover']")).forEach((o,u)=>{if(!e.sources[u]){console.warn("마크다운 파일에 입력한 출처와 차이가 있습니다.");return}o.setAttribute("title","출처"),o.setAttribute("data-bs-content",C.linkify(e.sources[u])),o.innerText=`[${u+1}]`}),e.content=t.body.innerHTML};return R(async()=>{const t=I.find(n=>n.id===i.id);if(t){const{html:n}=await t.read();e.title=t.title,e.videoUrl=t.videoUrl,e.content=C.linkify(n),e.created=t.created,e.updated=t.updated,e.sources=t.sources,e.references=t.references,a(),D(()=>{e.loaded=!0,i.onContentLoaded()}),l.updateSiteTitle(e.title)}}),N(()=>{l.updateSiteTitle()}),(t,n)=>(s(),r("div",{class:$(["post-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:m},[L(f).query.mode==="presentation"&&e.loaded?(s(),g(B,{key:0,title:e.title,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","content","sources","references","created","updated"])):(s(),r(x,{key:1},[c(O,{title:e.title,created:e.created,updated:e.updated,skeleton:!e.loaded},null,8,["title","created","updated","skeleton"]),e.videoUrl?(s(),r("div",z,[c(w,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):p("",!0),d("div",j,[c(F,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])],64))],2))}}),J=P(G,[["__scopeId","data-v-167f4d5a"]]),K={class:"post"},Q={class:"container"},X={class:"wrapper"},Y={class:"main"},Z={key:0,class:"sources"},ee={key:1,class:"references"},te=S({__name:"Post",setup(v){const l=U(),f=M(),i=_(),m=_(),e=b({contentLoaded:!1}),a=A(()=>{var o;return((o=f.params.id)==null?void 0:o.toString())??""}),t=A(()=>I.find(o=>o.id===a.value)),n=()=>{e.contentLoaded=!0};return(o,u)=>{var y,k,h,T;return s(),r("div",K,[d("div",Q,[d("div",X,[d("div",Y,[d("div",{class:"core",ref_key:"coreRef",ref:i},[(s(),g(J,{id:a.value,key:a.value,onContentLoaded:n},null,8,["id"]))],512),(k=(y=t.value)==null?void 0:y.sources)!=null&&k.length?(s(),r("div",Z,[c(V,{sources:t.value.sources},null,8,["sources"])])):p("",!0),(T=(h=t.value)==null?void 0:h.references)!=null&&T.length?(s(),r("div",ee,[c(q,{references:t.value.references},null,8,["references"])])):p("",!0)]),e.contentLoaded?(s(),r("div",{key:0,class:"posts",ref_key:"postsRef",ref:m,style:W({height:L(l).mainHeight})},[c(H,{id:a.value},null,8,["id"])],4)):p("",!0)])])])}}}),ae=P(te,[["__scopeId","data-v-05ac3b0d"]]);export{ae as default};
