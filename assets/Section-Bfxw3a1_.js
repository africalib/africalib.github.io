import{d as E,i as q,q as B,s as g,n as V,l as F,c as h,v as H,u as o,g as $,m as I,e as f,b as s,j as z,x as G,o as u,_ as N,y as A,w as x,f as P,t as M,z as j,A as U,B as J}from"./index-BKo4wQ53.js";import{c as b}from"./commonLib-B4LiHA7t.js";import{u as R}from"./useSection-UlcFxRvo.js";import{u as K,D as Q,a as X,b as Y,c as Z,_ as ee,d as te,C as oe,e as se}from"./common.angle.right-BH-k1OQf.js";import{C as ce}from"./Chapters-DJC_wX1T.js";import"./courses-CR0H_LnH.js";const ne="/assets/images/common.home.white.svg",re={key:1,class:"video"},ae={class:"content"},le=E({__name:"SectionCore",props:{courseId:{},chapterId:{},sectionId:{},onDocumentLoaded:{type:Function}},setup(C){const d=q(),S=z(),p=R(),{data:a,loading:r,request:c}=K(),t=C,e=B({title:"WAIT A MOMENT",desc:"WAIT A MOMENT",videoUrl:null,document:"<p>PLEASE WAIT A MOMENT</p>",presentation:!1,created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),m=g(()=>p.getSection(t.courseId,t.chapterId,t.sectionId)),l=()=>{if(!e.sources.length)return;const _=new DOMParser().parseFromString(e.document,"text/html");Array.from(_.querySelectorAll("[data-bs-toggle='popover']")).forEach((n,T)=>{if(!e.sources[T]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}n.setAttribute("title","자료 출처"),n.setAttribute("data-bs-content",b.linkify(e.sources[T])),n.innerText=`[${T+1}]`}),e.document=_.body.innerHTML};return V(async()=>{const _=p.getCourse(t.courseId);if(_){const v=p.getChapter(t.courseId,t.chapterId);if(v){const n=m.value;n&&(await c({url:`/assets/courses/${t.courseId}/${t.chapterId}/${t.sectionId}/document.html`,contentType:"text/html"}),e.title=n.title,e.desc=n.desc,e.videoUrl=n.videoUrl,e.sources=n.sources,e.references=n.references,e.document=b.linkify(a.value),e.presentation=n.presentation,e.created=n.created,e.updated=n.updated,e.courseTitle=_.title,e.chapterTitle=v.title,l(),G(()=>{t.onDocumentLoaded()}),d.updateSiteTitle(b.extractText(e.title)))}}}),F(()=>{d.updateSiteTitle()}),(_,v)=>(u(),h("div",{class:H(["section-core",{skeleton:o(r)}])},[o(S).query.mode==="presentation"&&!o(r)?(u(),$(Q,{key:0,title:e.title,desc:e.desc,document:e.document,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","desc","document","sources","references","created","updated"])):I("",!0),f(X,{title:o(b).extractText(e.title),desc:e.desc,presentation:e.presentation,created:e.created,updated:e.updated,skeleton:o(r)},null,8,["title","desc","presentation","created","updated","skeleton"]),e.videoUrl?(u(),h("div",re,[f(Y,{url:e.videoUrl,skeleton:o(r)},null,8,["url","skeleton"])])):I("",!0),s("div",ae,[f(Z,{document:e.document,skeleton:o(r)},null,8,["document","skeleton"])])],2))}}),ie=N(le,[["__scopeId","data-v-212e0a86"]]),ue={class:"wrapper"},de={class:"title"},pe={class:"title"},me=E({__name:"SectionNavigation",props:{courseId:{},chapterId:{},sectionId:{}},setup(C){const d=C,S=R(),p=A(()=>{var e;const c=[];return(((e=S.getCourse(d.courseId))==null?void 0:e.chapters)||[]).forEach(m=>{m.sections.forEach(l=>{c.push({id:l.id,title:b.extractText(l.title),url:`/courses/${d.courseId}/${m.id}/${l.id}`})})}),c}),a=A(()=>{let c=null;const t=p.value;for(let e=0;e<t.length;e++)if(t[e].id===d.sectionId){c=t[e-1];break}return c}),r=A(()=>{let c=null;const t=p.value;for(let e=0;e<t.length;e++)if(t[e].id===d.sectionId){c=t[e+1];break}return c});return(c,t)=>{const e=P("router-link");return u(),h("div",{class:H(["section-navigation",{both:o(a)&&o(r)}])},[s("div",ue,[o(a)?(u(),$(e,{key:0,to:o(a).url||"",class:"item prev",title:o(a).title},{default:x(()=>[t[0]||(t[0]=s("div",{class:"label"},[s("img",{src:ee,alt:"이전"}),s("span",null,"이전")],-1)),s("div",de,M(o(a).title),1)]),_:1},8,["to","title"])):I("",!0),o(r)?(u(),$(e,{key:1,to:o(r).url,class:"item next",title:o(r).title},{default:x(()=>[t[1]||(t[1]=s("div",{class:"label"},[s("img",{src:te,alt:"다음"}),s("span",null,"다음")],-1)),s("div",pe,M(o(r).title),1)]),_:1},8,["to","title"])):I("",!0)])],2)}}}),ve=N(me,[["__scopeId","data-v-086a2450"]]),_e={class:"section"},fe={class:"container"},he={class:"wrapper"},Ie={class:"main"},ge={class:"core",ref:"coreRef"},Se={key:0,class:"sources"},Te={key:1,class:"references"},ke={class:"navigation"},be=E({__name:"Section",setup(C){const d=q(),S=j(),p=R(),a=z(),r=U("chaptersTopRef"),c=U("chaptersRef"),t=B({contentLoaded:!1}),e=g(()=>{var i;return(i=a.params.courseId)==null?void 0:i.toString()}),m=g(()=>{var i;return(i=a.params.chapterId)==null?void 0:i.toString()}),l=g(()=>{var i;return(i=a.params.sectionId)==null?void 0:i.toString()}),_=g(()=>p.getCourse(e.value)),v=g(()=>p.getSection(e.value,m.value,l.value)),n=i=>{var k,y;d.windowSize.width<=1399||(y=c.value)==null||y.scrollTo({top:i-c.value.offsetTop-(((k=r.value)==null?void 0:k.offsetHeight)||0),behavior:"smooth"})},T=()=>{t.contentLoaded=!0};return(i,k)=>{var w,D,L,W;const y=P("router-link");return u(),h("div",_e,[s("div",fe,[s("div",he,[s("div",Ie,[s("div",ge,[(u(),$(ie,{courseId:e.value,chapterId:m.value,sectionId:l.value,key:l.value,onDocumentLoaded:T},null,8,["courseId","chapterId","sectionId"]))],512),(D=(w=v.value)==null?void 0:w.sources)!=null&&D.length?(u(),h("div",Se,[f(oe,{sources:v.value.sources},null,8,["sources"])])):I("",!0),(W=(L=v.value)==null?void 0:L.references)!=null&&W.length?(u(),h("div",Te,[f(se,{references:v.value.references},null,8,["references"])])):I("",!0),s("div",ke,[f(ve,{courseId:e.value,chapterId:m.value,sectionId:l.value},null,8,["courseId","chapterId","sectionId"])])]),t.contentLoaded?(u(),h("div",{key:0,class:"chapters",ref_key:"chaptersRef",ref:c,style:J({height:o(S).mainHeight})},[s("div",{class:"top",ref_key:"chaptersTopRef",ref:r},[f(y,{to:`/courses/${e.value}`,class:"btn"},{default:x(()=>{var O;return[k[0]||(k[0]=s("img",{src:ne},null,-1)),s("span",null,M((O=_.value)==null?void 0:O.title),1)]}),_:1},8,["to"])],512),f(ce,{courseId:e.value,chapterId:m.value,sectionId:l.value,theme:"light",onScrollable:n},null,8,["courseId","chapterId","sectionId"])],4)):I("",!0)])])])}}}),Ee=N(be,[["__scopeId","data-v-baa0bdab"]]);export{Ee as default};
