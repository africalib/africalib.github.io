import{d as T,c as u,b as s,F as D,r as O,t as I,g as m,o as r,_ as E,n as X,h as Y,f as $,u as P,i as U,j as C,e as b,k as S,T as ne,l as W,m as j,p as oe,q as R,s as Z,v as re,w as ie,x as le,y as F,z as ce,A as V,B as H,C as ee,D as ue}from"./index-XTOiYpN_.js";import{u as K,M as G}from"./Materials-BKAvuSg2.js";import{T as de}from"./Tags-Cxsq-O-M.js";import{c as M}from"./commonLib-B4LiHA7t.js";import{C as me}from"./CryptoHelper-m6j8gmxG.js";import{_ as pe,a as _e,b as ve}from"./common.arrow.left-TSorRx6s.js";import{r as he}from"./routeLib-DhAZaWiT.js";import{A as fe}from"./Above-D4wv2OC9.js";import"./Panel-DmIW6EAm.js";const ge={class:"common-sources"},ye={class:"items"},ke={class:"item"},be=["innerHTML"],$e=T({__name:"MaterialSources",props:{sources:{}},setup(v){const e=v;return(i,l)=>(r(),u("div",ge,[l[0]||(l[0]=s("div",{class:"subject"},"자료 출처",-1)),s("div",ye,[(r(!0),u(D,null,O(e.sources,(f,g)=>(r(),u("div",ke,[s("span",null,"["+I(g+1)+"] ",1),s("span",{innerHTML:m(M).linkify(f)},null,8,be)]))),256))])]))}}),te=E($e,[["__scopeId","data-v-e2850f27"]]),we={class:"common-references"},xe={class:"items"},Me={class:"item"},Se=T({__name:"MaterialReferences",props:{references:{}},setup(v){const e=v;return(i,l)=>(r(),u("div",we,[l[0]||(l[0]=s("div",{class:"subject"},"참고 자료",-1)),s("div",xe,[(r(!0),u(D,null,O(e.references,f=>(r(),u("div",Me,[s("span",null,I(f),1)]))),256))])]))}}),se=E(Se,[["__scopeId","data-v-64c8b31c"]]),Te=["innerHTML"],Le=T({__name:"DocumentContent",props:{document:{},skeleton:{type:Boolean}},setup(v){const e=v;return(i,l)=>(r(),u("div",{class:X(["document-content",{skeleton:e.skeleton}])},[s("div",{innerHTML:e.document,ref:"contentRef"},null,8,Te)],2))}}),ae=E(Le,[["__scopeId","data-v-7a52ca4e"]]),Ee="/assets/images/component.document.presentation.slide.first.svg",Ae="/assets/images/component.material.presentation.finish.svg",B=T({__name:"DocumentPrompt",props:{content:{}},setup(v){const e=v;return Y(()=>{console.info(e.content.replace(/\n{3,}/g,`

`))}),(i,l)=>null}}),Ce={class:"presentation"},De={class:"slides"},Ie={key:0,class:"slide start"},qe={class:"container"},He={class:"slide-item"},Pe=["innerHTML"],Re={key:1,class:"slide finish"},Ne={class:"container"},je={key:0,class:"slide"},Fe={class:"container"},J="no-overflow",Ve=T({__name:"MaterialPresentation",props:{material:{},document:{}},setup(v){const e={touchStartX:0,touchStartY:0},i=v,l=P(),f=W(),g=`이렇게 해서 ${M.extractText(i.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,h=$(()=>i.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),y=$(()=>{const c=[i.material.desc];return a.value.length===0&&t.value.length===1&&c.push(t.value[0]),c.join("")}),a=$(()=>{const c=new DOMParser().parseFromString(i.document,"text/html");return Array.from(c.querySelectorAll(".slide-item")).map(d=>d.outerHTML)}),t=$(()=>{const c=[],d={},x=new DOMParser().parseFromString(i.document,"text/html");Array.from(x.querySelectorAll(".slide-text")).forEach(L=>{const A=L.getAttribute("data-slide-text-group");A&&(!d[A]&&(d[A]=[]),d[A].push(M.replaceAll(L.outerText,"  ","").trim()))});for(let L in d)c.push(d[L].join(`
`));return c}),n=$(()=>{var c;return window.Number.parseInt(((c=l.query.idx)==null?void 0:c.toString())||"0")}),o=$(()=>a.value.length+1),_=c=>{const d=M.renew(l.query);let x=n.value+c;x<0?x=0:x>o.value&&(x=o.value),n.value!==x&&(d.idx=x.toString(),f.push({query:d}))},p=(c,d)=>{switch(c){case"ArrowLeft":!d&&_(-1);break;case"ArrowRight":!d&&_(1);break;case"F9":case"Escape":f.push({query:void 0});break}},k=c=>{p(c.key,c.altKey)},w=c=>{const d=c.touches[0];e.touchStartX=d.clientX,e.touchStartY=d.clientY},q=c=>{const d=c.changedTouches[0],x=d.clientX,z=d.clientY,L=x-e.touchStartX,A=z-e.touchStartY;Math.abs(L)>Math.abs(A)&&Math.abs(L)>50&&(L>0?_(-1):_(1))},N=c=>{c.data.type==="keyup"&&p(c.data.key,c.data.altKey)};return Y(()=>{document.addEventListener("keyup",k),document.addEventListener("touchstart",w),document.addEventListener("touchend",q),window.addEventListener("message",N),document.body.classList.add(J)}),U(()=>{document.removeEventListener("keyup",k),document.removeEventListener("touchstart",w),document.removeEventListener("touchend",q),window.removeEventListener("message",N),document.body.classList.remove(J)}),(c,d)=>(r(),C(ne,{to:"body"},[s("div",Ce,[s("div",De,[n.value===0?(r(),u("div",Ie,[s("div",qe,[s("figure",He,[d[0]||(d[0]=s("img",{src:Ee,alt:"코딩",loading:"lazy"},null,-1)),s("figcaption",null,[s("span",{innerHTML:h.value},null,8,Pe),b(B,{content:y.value},null,8,["content"])])])])])):n.value===o.value?(r(),u("div",Re,[s("div",Ne,[d[1]||(d[1]=s("figure",{class:"slide-item"},[s("img",{src:Ae,alt:"하이파이브",class:"mh-400",loading:"lazy"}),s("figcaption",null,[s("b",null,"이상 끝. "),s("span",null,"수고하셨습니다!")])],-1)),i.material.sources.length?(r(),C(te,{key:0,class:"w-100 mb-3",sources:i.material.sources},null,8,["sources"])):S("",!0),i.material.references.length?(r(),C(se,{key:1,class:"w-100",references:i.material.references},null,8,["references"])):S("",!0),b(B,{content:g})])])):(r(!0),u(D,{key:2},O(a.value.length,x=>(r(),u(D,null,[n.value===x?(r(),u("div",je,[s("div",Fe,[b(ae,{document:a.value[x-1]},null,8,["document"]),b(B,{content:t.value[x-1]||""},null,8,["content"])])])):S("",!0)],64))),256))])])]))}}),Be=E(Ve,[["__scopeId","data-v-6bffa037"]]);function Oe(){const v=j(null),e=j(null),i=j(!1);return{data:v,error:e,loading:i,request:async({url:f,method:g="GET",body:h,contentType:y="application/json",...a})=>{i.value=!0,e.value=null;try{const t={"Content-Type":y,...a.headers||{}},n={method:g,headers:t,...a};h&&(n.body=y==="application/json"?JSON.stringify(h):h);const o=await fetch(f,n);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const _=o.headers.get("Content-Type");return _!=null&&_.includes("application/json")?v.value=await o.json():v.value=await o.text(),v.value}catch(t){throw e.value=t.message||"Unknown error",t}finally{i.value=!1}}}}const Xe={key:0,class:"presentation"},Ye={class:"content"},Ue={key:1,class:"empty"},Ke=T({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(v){const e=P(),i=oe(),l=R(),f=K(e),{data:g,loading:h,request:y}=Oe(),a=v,t=Z({document:"<p>PLEASE WAIT A MOMENT</p>",accessible:!1}),n=()=>{if(!a.material.sources.length)return;const _=new DOMParser().parseFromString(t.document,"text/html");Array.from(_.querySelectorAll("[data-bs-toggle='popover']")).forEach((k,w)=>{if(!a.material.sources[w]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}k.setAttribute("title","자료 출처"),k.setAttribute("data-bs-content",M.linkify(a.material.sources[w])),k.innerText=`[${w+1}]`}),t.document=_.body.innerHTML},o=async()=>{const _=window.location.hostname==="localhost";if(t.accessible=a.material.locked?l.admin:!0,t.accessible){const p=f.getUrlPath(a.material);await y({url:`/assets${p}/document.html?${Date.now()}`,contentType:"text/html"});const k=le.get(F.unlockPasswordCookieName);if(a.material.locked&&k&&!_){const w=new me(k,F.salt,F.iv);g.value=await w.decrypt(g.value).catch(q=>(console.error({err:q,message:"문서를 복호화 할 수 없습니다."}),null))}t.document=M.linkify(g.value),n()}ce(()=>{a.onDocumentLoaded()}),i.updateSiteTitle(M.extractText(a.material.title))};return re(()=>{o()}),U(()=>{i.updateSiteTitle()}),ie(()=>e.path,()=>{o()}),(_,p)=>(r(),u("div",{class:X(["material-core",{skeleton:m(h)}])},[m(e).query.mode==="presentation"&&!m(h)&&t.accessible&&m(l).admin?(r(),u("div",Xe,[b(Be,{material:a.material,document:t.document},null,8,["material","document"])])):S("",!0),s("div",Ye,[t.accessible&&t.document?(r(),C(ae,{key:0,document:t.document,skeleton:m(h)},null,8,["document","skeleton"])):(r(),u("div",Ue,"조회 가능한 문서가 없습니다."))])],2))}}),ze=E(Ke,[["__scopeId","data-v-5f387f22"]]),Ge={class:"wrapper"},Je={class:"title"},Qe={class:"title"},We=T({__name:"MaterialNavigation",props:{material:{}},setup(v){const e=v,i=P(),l=R(),f=K(i),g=V(()=>{var t,n;const a=[];if((n=(t=e.material)==null?void 0:t.parent)!=null&&n.children){const o=he.getTag(i);e.material.parent.children.forEach(_=>{(!o||_.tags.includes(o))&&a.push(_)})}return a}),h=V(()=>{var n;let a=null;const t=g.value;for(let o=0;o<t.length;o++)if(t[o].id===((n=e.material)==null?void 0:n.id)&&t[o-1]&&f.isVisible(t[o-1],l.admin)){a=t[o-1];break}return a}),y=V(()=>{var n;let a=null;const t=g.value;for(let o=0;o<t.length;o++)if(t[o].id===((n=e.material)==null?void 0:n.id)&&t[o+1]&&f.isVisible(t[o+1],l.admin)){a=t[o+1];break}return a});return(a,t)=>{const n=ee("router-link");return r(),u("div",{class:X(["material-navigation",{both:m(h)&&m(y)}])},[s("div",Ge,[m(h)?(r(),C(n,{key:0,to:m(h).url||"",class:"item prev",title:m(h).title},{default:H(()=>[t[0]||(t[0]=s("div",{class:"label"},[s("img",{src:pe,alt:"이전"}),s("span",null,"이전")],-1)),s("div",Je,I(m(M).extractText(m(h).title)),1)]),_:1},8,["to","title"])):S("",!0),m(y)?(r(),C(n,{key:1,to:m(y).url,class:"item next",title:m(y).title},{default:H(()=>[t[1]||(t[1]=s("div",{class:"label"},[s("img",{src:_e,alt:"다음"}),s("span",null,"다음")],-1)),s("div",Qe,I(m(M).extractText(m(y).title)),1)]),_:1},8,["to","title"])):S("",!0)])],2)}}}),Ze=E(We,[["__scopeId","data-v-a6886743"]]),et={class:"material-above"},tt={class:"back"},st={class:"wrapper"},at={class:"dates"},nt=["title"],Q="?mode=presentation",ot=T({__name:"MaterialAbove",props:{material:{}},setup(v){const e=v,i=W(),l=R(),f=n=>{n==="F9"&&l.admin&&i.push(Q)},g=n=>{f(n.key)},h=$(()=>{const n={title:"강의 자료",url:"/materials"};return e.material.parent&&(n.title=e.material.parent.title,n.url=e.material.parent.url),n}),y=$(()=>e.material.created?e.material.updated?M.getHumanReadableDate(e.material.updated)+" 업데이트됨":M.getHumanReadableDate(e.material.created)+" 생성됨":"(N/A)"),a=$(()=>{if(e.material.created){const n=[`생성: ${e.material.created}`];return e.material.updated&&n.push(`업데이트: ${e.material.created}`),n.join(" | ")}}),t=n=>{n.data.type==="keyup"&&f(n.data.key)};return Y(()=>{document.addEventListener("keyup",g),window.addEventListener("message",t)}),U(()=>{document.removeEventListener("keyup",g),window.removeEventListener("message",t)}),(n,o)=>{const _=ee("router-link");return r(),u("div",et,[s("div",tt,[b(_,{to:h.value.url},{default:H(()=>[o[0]||(o[0]=s("img",{src:ve,alt:"뒤로가기",title:"뒤로가기"},null,-1)),s("span",null,I(h.value.title),1)]),_:1},8,["to"])]),s("div",st,[s("div",at,[s("span",{title:a.value},I(y.value),9,nt),e.material.presentation&&m(l).admin?(r(),u(D,{key:0},[o[2]||(o[2]=s("span",{class:"bar"},null,-1)),b(_,{to:Q},{default:H(()=>o[1]||(o[1]=[ue("발표(F9)")])),_:1})],64)):S("",!0)]),b(fe,{title:m(M).extractText(e.material.title),desc:e.material.desc},null,8,["title","desc"])])])}}}),rt=E(ot,[["__scopeId","data-v-f7a291a7"]]),it={class:"material"},lt={class:"container"},ct={class:"above",ref:"aboveRef"},ut={key:0,class:"list"},dt={class:"tags"},mt={key:1,class:"detail"},pt={class:"main",ref:"mainRef"},_t={class:"core",ref:"coreRef"},vt={key:0,class:"sources"},ht={key:1,class:"references"},ft={class:"navigation"},gt={key:0,class:"materials",ref:"materialsRef"},yt=T({__name:"MaterialDetail",setup(v){const e=P(),i=R(),l=K(e),f=Z({contentLoaded:!1}),g=$(()=>{var p;return(p=e.params.id1)==null?void 0:p.toString()}),h=$(()=>{var p;return(p=e.params.id2)==null?void 0:p.toString()}),y=$(()=>{var p;return(p=e.params.id3)==null?void 0:p.toString()}),a=$(()=>l.get(g.value,h.value,y.value)),t=$(()=>{var p,k;return((k=(p=a.value)==null?void 0:p.parent)==null?void 0:k.children.filter(w=>l.isVisible(w,i.admin)))||[]}),n=$(()=>{var k;const p=new Set;return p.add(void 0),(k=l.get(g.value))==null||k.tags.forEach(w=>p.add(w)),p}),o=$(()=>{if(e.query.tag)return window.decodeURIComponent(e.query.tag.toString())}),_=()=>{f.contentLoaded=!0};return(p,k)=>{var w;return r(),u("div",it,[s("div",lt,[a.value?(r(),u(D,{key:0},[s("div",ct,[b(rt,{material:a.value},null,8,["material"])],512),a.value.children.length?(r(),u("div",ut,[s("div",dt,[b(de,{tags:n.value,tag:o.value},null,8,["tags","tag"])]),b(G,{materials:a.value.children,tag:o.value},null,8,["materials","tag"])])):(r(),u("div",mt,[s("div",pt,[s("div",_t,[b(ze,{material:a.value,onDocumentLoaded:_},null,8,["material"])],512),m(l).isVisible(a.value,m(i).admin)&&a.value.sources.length?(r(),u("div",vt,[b(te,{sources:a.value.sources},null,8,["sources"])])):S("",!0),m(l).isVisible(a.value,m(i).admin)&&((w=a.value.references)!=null&&w.length)?(r(),u("div",ht,[b(se,{references:a.value.references},null,8,["references"])])):S("",!0),s("div",ft,[b(Ze,{material:a.value},null,8,["material"])])],512),f.contentLoaded&&t.value.length?(r(),u("div",gt,[b(G,{materials:t.value},null,8,["materials"])],512)):S("",!0)]))],64)):S("",!0)])])}}}),Et=E(yt,[["__scopeId","data-v-312a7eab"]]);export{Et as default};
