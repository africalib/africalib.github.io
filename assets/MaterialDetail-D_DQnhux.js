import{d as M,g as $,c as o,b as s,F as L,r as q,t as H,u as g,o as a,_ as S,n as N,i as O,j as R,k as U,l as I,f as k,m as w,T as ne,p as W,q as oe,s as X,v as Z,w as re,x as le,h as Y,y as ie,z as j,A as ce,B as F,C as P,D as K,E as ee}from"./index-B_BRzoSS.js";import{u as z,M as G}from"./material-DchN6Kpw.js";import{c as x}from"./commonLib-Co9BQnS0.js";import{C as ue}from"./CryptoHelper-m6j8gmxG.js";import{_ as de,a as me,b as pe}from"./common.arrow.left-TSorRx6s.js";import{r as _e}from"./routeLib-DhAZaWiT.js";import{A as ve}from"./Above-SJ0qwtzU.js";import"./Panel-BzJd-MA2.js";const he={class:"common-sources"},fe={class:"items"},ge=["innerHTML"],ye=M({__name:"MaterialSources",props:{sources:{}},setup(h){const t=h,l=$(()=>{const p=new Map;return t.sources.forEach((r,i)=>{p.has(r)||p.set(r,[]),p.get(r).push(i+1)}),Array.from(p.entries()).map(([r,i])=>({indexes:i,src:r}))});return(p,r)=>(a(),o("div",he,[r[1]||(r[1]=s("div",{class:"subject"},"자료 출처",-1)),s("div",fe,[(a(!0),o(L,null,q(l.value,i=>(a(),o("div",{class:"item",key:i.src},[(a(!0),o(L,null,q(i.indexes,_=>(a(),o("span",null,"["+H(_)+"]",1))),256)),r[0]||(r[0]=s("span",null," ",-1)),s("span",{innerHTML:g(x).linkify(i.src)},null,8,ge)]))),128))])]))}}),te=S(ye,[["__scopeId","data-v-a34ac84b"]]),ke={class:"common-references"},$e={class:"items"},be={class:"item"},xe=M({__name:"MaterialReferences",props:{references:{}},setup(h){const t=h;return(l,p)=>(a(),o("div",ke,[p[0]||(p[0]=s("div",{class:"subject"},"참고 자료",-1)),s("div",$e,[(a(!0),o(L,null,q(t.references,r=>(a(),o("div",be,[s("span",null,H(r),1)]))),256))])]))}}),se=S(xe,[["__scopeId","data-v-64c8b31c"]]),we={key:0},Me=["innerHTML"],Te=M({__name:"DocumentContent",props:{document:{},loading:{type:Boolean}},setup(h){const t=h;return(l,p)=>(a(),o("div",{class:N(["document-content",{skeleton:t.loading}])},[l.loading?(a(),o("div",we)):(a(),o("div",{key:1,innerHTML:t.document,ref:"contentRef"},null,8,Me))],2))}}),ae=S(Te,[["__scopeId","data-v-53b0c110"]]),Le="/assets/images/component.document.presentation.slide.first.svg",Se="/assets/images/component.material.presentation.finish.svg",B=M({__name:"DocumentPrompt",props:{content:{}},setup(h){const t=h;return O(()=>{console.info(t.content.replace(/\n{3,}/g,`

`))}),(l,p)=>null}}),Ee={class:"slides"},Ae={key:0,class:"slide start"},Ce={class:"container"},De={class:"slide-item"},Ie=["innerHTML"],He={key:1,class:"slide finish"},Pe={class:"container"},Re={key:0,class:"slide"},qe={class:"container"},J="no-overflow",Ne=M({__name:"MaterialPresentation",props:{material:{},document:{},loading:{type:Boolean}},setup(h){const t={touchStartX:0,touchStartY:0},l=h,p=W(),r=`이렇게 해서 ${x.extractText(l.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,i=R(0),_=$(()=>l.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),n=$(()=>{const v=[l.material.desc];return c.value.length===0&&e.value.length===1&&v.push(e.value[0]),v.join("")}),c=$(()=>{const v=new DOMParser().parseFromString(l.document,"text/html");return Array.from(v.querySelectorAll(".slide-item")).map(u=>u.outerHTML)}),e=$(()=>{const v=[],u={},E=new DOMParser().parseFromString(l.document,"text/html");Array.from(E.querySelectorAll(".slide-text")).forEach(T=>{const D=T.getAttribute("data-slide-text-group");D&&(!u[D]&&(u[D]=[]),u[D].push(x.replaceAll(T.outerText,"  ","").trim()))});for(let T in u)v.push(u[T].join(`
`));return v}),d=$(()=>c.value.length+1),f=v=>{let u=i.value+v;u<0?u=0:u>d.value&&(u=d.value),i.value!==u&&(i.value=u)},b=(v,u)=>{switch(v){case"ArrowLeft":!u&&f(-1);break;case"ArrowRight":!u&&f(1);break;case"F9":case"Escape":!u&&p.push({query:void 0});break}},m=v=>{b(v.key,v.altKey)},y=v=>{const u=v.touches[0];t.touchStartX=u.clientX,t.touchStartY=u.clientY},A=v=>{const u=v.changedTouches[0],E=u.clientX,V=u.clientY,T=E-t.touchStartX,D=V-t.touchStartY;Math.abs(T)>Math.abs(D)&&Math.abs(T)>50&&(T>0?f(-1):f(1))},C=v=>{v.data.type==="keyup"&&b(v.data.key,v.data.altKey)};return O(()=>{document.addEventListener("keyup",m),document.addEventListener("touchstart",y),document.addEventListener("touchend",A),window.addEventListener("message",C),document.body.classList.add(J)}),U(()=>{document.removeEventListener("keyup",m),document.removeEventListener("touchstart",y),document.removeEventListener("touchend",A),window.removeEventListener("message",C),document.body.classList.remove(J)}),(v,u)=>(a(),I(ne,{to:"body"},[s("div",{class:N(["presentation",{skeleton:l.loading}])},[s("div",Ee,[i.value===0?(a(),o("div",Ae,[s("div",Ce,[s("figure",De,[u[0]||(u[0]=s("img",{src:Le,alt:"코딩",loading:"lazy"},null,-1)),s("figcaption",null,[s("span",{innerHTML:_.value},null,8,Ie),k(B,{content:n.value},null,8,["content"])])])])])):i.value===d.value?(a(),o("div",He,[s("div",Pe,[u[1]||(u[1]=s("figure",{class:"slide-item"},[s("img",{src:Se,alt:"하이파이브",class:"mh-400",loading:"lazy"}),s("figcaption",null,[s("b",null,"이상 끝. "),s("span",null,"수고하셨습니다!")])],-1)),l.material.sources.length?(a(),I(te,{key:0,class:"w-100 mb-3",sources:l.material.sources},null,8,["sources"])):w("",!0),l.material.references.length?(a(),I(se,{key:1,class:"w-100",references:l.material.references},null,8,["references"])):w("",!0),k(B,{content:r})])])):(a(!0),o(L,{key:2},q(c.value.length,E=>(a(),o(L,null,[i.value===E?(a(),o("div",Re,[s("div",qe,[k(ae,{document:c.value[E-1]},null,8,["document"]),k(B,{content:e.value[E-1]||""},null,8,["content"])])])):w("",!0)],64))),256))])],2)]))}}),je=S(Ne,[["__scopeId","data-v-bf88c7ed"]]);function Fe(){const h=R(null),t=R(null),l=R(!1);return{data:h,error:t,loading:l,request:async({url:r,method:i="GET",body:_,contentType:n="application/json",...c})=>{l.value=!0,t.value=null;try{const e={"Content-Type":n,...c.headers||{}},d={method:i,headers:e,...c};_&&(d.body=n==="application/json"?JSON.stringify(_):_);const f=await fetch(r,d);if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);const b=f.headers.get("Content-Type");return b!=null&&b.includes("application/json")?h.value=await f.json():h.value=await f.text(),h.value}catch(e){throw t.value=e.message||"Unknown error",e}finally{l.value=!1}}}}const Be={key:0,class:"presentation"},Oe={key:1,class:"content"},Ue={key:1,class:"empty"},Xe=M({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(h){const t=Y(),l=oe();X();const p=z(t),{data:r,loading:i,request:_}=Fe(),n=h,c=Z({document:"<p>PLEASE WAIT A MOMENT</p>"}),e=()=>{if(!n.material.sources.length)return;const f=new DOMParser().parseFromString(c.document,"text/html");Array.from(f.querySelectorAll("[data-bs-toggle='popover']")).forEach((m,y)=>{if(!n.material.sources[y]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}m.setAttribute("title","자료 출처"),m.setAttribute("data-bs-content",x.linkify(n.material.sources[y])),m.innerText=`[${y+1}]`}),c.document=f.body.innerHTML},d=async()=>{if(n.material){const f=p.getUrlPath(n.material);await _({url:`/assets${f}/document.html?${Date.now()}`,contentType:"text/html"});const b=ie.get(j.unlockPasswordCookieName),m=window.location.hostname==="localhost";if(n.material.locked&&b&&!m){const y=new ue(b,j.salt,j.iv);r.value=await y.decrypt(r.value).catch(A=>(console.error({err:A,message:"문서를 복호화 할 수 없습니다."}),null))}c.document=x.linkify(r.value),e()}ce(()=>{n.onDocumentLoaded()}),l.updateSiteTitle(x.extractText(n.material.title))};return re(()=>{d()}),U(()=>{l.updateSiteTitle()}),le(()=>t.path,()=>{d()}),(f,b)=>(a(),o("div",{class:N(["material-core",{skeleton:g(i)}])},[g(t).query.mode==="presentation"?(a(),o("div",Be,[k(je,{material:n.material,document:c.document,loading:g(i)},null,8,["material","document","loading"])])):(a(),o("div",Oe,[c.document?(a(),I(ae,{key:0,document:c.document,loading:g(i)},null,8,["document","loading"])):(a(),o("div",Ue,"이 문서에는 내용이 없습니다."))]))],2))}}),Ye=S(Xe,[["__scopeId","data-v-ae3cb381"]]),Ke={class:"wrapper"},ze={class:"title"},Ve={class:"title"},Ge=M({__name:"MaterialNavigation",props:{material:{}},setup(h){const t=h,l=Y();X(),z(l);const p=F(()=>{var n,c;const _=[];if((c=(n=t.material)==null?void 0:n.parent)!=null&&c.children){const e=_e.getTag(l);t.material.parent.children.forEach(d=>{(!e||d.tags.includes(e))&&_.push(d)})}return _}),r=F(()=>{var c;let _=null;const n=p.value;for(let e=0;e<n.length;e++)if(n[e].id===((c=t.material)==null?void 0:c.id)&&n[e-1]){_=n[e-1];break}return _}),i=F(()=>{var c;let _=null;const n=p.value;for(let e=0;e<n.length;e++)if(n[e].id===((c=t.material)==null?void 0:c.id)&&n[e+1]){_=n[e+1];break}return _});return(_,n)=>{const c=K("router-link");return a(),o("div",{class:N(["material-navigation",{both:g(r)&&g(i)}])},[s("div",Ke,[g(r)?(a(),I(c,{key:0,to:g(r).url||"",class:"item prev",title:g(r).title},{default:P(()=>[n[0]||(n[0]=s("div",{class:"label"},[s("img",{src:de,alt:"이전"}),s("span",null,"이전")],-1)),s("div",ze,H(g(x).extractText(g(r).title)),1)]),_:1},8,["to","title"])):w("",!0),g(i)?(a(),I(c,{key:1,to:g(i).url,class:"item next",title:g(i).title},{default:P(()=>[n[1]||(n[1]=s("div",{class:"label"},[s("img",{src:me,alt:"다음"}),s("span",null,"다음")],-1)),s("div",Ve,H(g(x).extractText(g(i).title)),1)]),_:1},8,["to","title"])):w("",!0)])],2)}}}),Je=S(Ge,[["__scopeId","data-v-edc97d56"]]),Qe={class:"material-above"},We={class:"back"},Ze={class:"wrapper"},et={class:"dates"},tt=["title"],Q="?mode=presentation",st=M({__name:"MaterialAbove",props:{material:{}},setup(h){const t=h,l=W(),p=(e,d)=>{e==="F9"&&!d&&t.material.presentation&&l.push(Q)},r=e=>{p(e.key,e.altKey)},i=$(()=>{const e={title:"강의 자료",url:"/materials"};return t.material.parent&&(e.title=t.material.parent.title,e.url=t.material.parent.url),e}),_=$(()=>t.material.created?t.material.updated?x.getHumanReadableDate(t.material.updated)+" 업데이트됨":x.getHumanReadableDate(t.material.created)+" 생성됨":"(N/A)"),n=$(()=>{if(t.material.created){const e=[`생성: ${t.material.created}`];return t.material.updated&&e.push(`업데이트: ${t.material.created}`),e.join(" | ")}}),c=e=>{e.data.type==="keyup"&&p(e.data.key,e.data.altKey)};return O(()=>{document.addEventListener("keyup",r),window.addEventListener("message",c)}),U(()=>{document.removeEventListener("keyup",r),window.removeEventListener("message",c)}),(e,d)=>{const f=K("router-link");return a(),o("div",Qe,[s("div",We,[k(f,{to:i.value.url},{default:P(()=>[d[0]||(d[0]=s("img",{src:pe,alt:"뒤로가기",title:"뒤로가기"},null,-1)),s("span",null,H(i.value.title),1)]),_:1},8,["to"])]),s("div",Ze,[s("div",et,[s("span",{title:n.value},H(_.value),9,tt),t.material.presentation?(a(),o(L,{key:0},[d[2]||(d[2]=s("span",{class:"bar"},null,-1)),k(f,{to:Q},{default:P(()=>d[1]||(d[1]=[ee("발표(F9)")])),_:1})],64)):w("",!0)]),k(ve,{title:g(x).extractText(t.material.title),desc:t.material.desc},null,8,["title","desc"])])])}}}),at=S(st,[["__scopeId","data-v-1b63178d"]]),nt={class:"material"},ot={class:"container"},rt={class:"above",ref:"aboveRef"},lt={key:0,class:"list"},it={key:1,class:"detail"},ct={class:"main",ref:"mainRef"},ut={class:"core",ref:"coreRef"},dt={key:0,class:"sources"},mt={key:1,class:"references"},pt={key:1,class:"empty"},_t={key:2,class:"login"},vt={class:"navigation"},ht={key:0,class:"materials",ref:"materialsRef"},ft={key:1,class:"empty"},gt=M({__name:"MaterialDetail",setup(h){const t=Y(),l=X(),p=z(t),r=Z({contentLoaded:!1}),i=$(()=>{var m;return!((m=e.value)!=null&&m.locked)||l.admin}),_=$(()=>{var m;return(m=t.params.id1)==null?void 0:m.toString()}),n=$(()=>{var m;return(m=t.params.id2)==null?void 0:m.toString()}),c=$(()=>{var m;return(m=t.params.id3)==null?void 0:m.toString()}),e=$(()=>p.get(_.value,n.value,c.value)),d=$(()=>{var m,y;return((y=(m=e.value)==null?void 0:m.parent)==null?void 0:y.children)||[]}),f=$(()=>{if(t.query.tag)return window.decodeURIComponent(t.query.tag.toString())}),b=()=>{r.contentLoaded=!0};return(m,y)=>{var C;const A=K("router-link");return a(),o("div",nt,[s("div",ot,[e.value?(a(),o(L,{key:0},[s("div",rt,[k(at,{material:e.value},null,8,["material"])],512),e.value.children.length?(a(),o("div",lt,[k(G,{materials:e.value.children,tag:f.value},null,8,["materials","tag"])])):(a(),o("div",it,[s("div",ct,[i.value?(a(),o(L,{key:0},[s("div",ut,[k(Ye,{material:e.value,onDocumentLoaded:b},null,8,["material"])],512),e.value.sources.length?(a(),o("div",dt,[k(te,{sources:e.value.sources},null,8,["sources"])])):w("",!0),(C=e.value.references)!=null&&C.length?(a(),o("div",mt,[k(se,{references:e.value.references},null,8,["references"])])):w("",!0)],64)):e.value.children.length?(a(),o("div",_t,[k(A,{to:g(l).getLoginUrl(g(t),!0)},{default:P(()=>y[0]||(y[0]=[ee("로그인")])),_:1},8,["to"]),y[1]||(y[1]=s("span",null,"이 필요합니다.",-1))])):(a(),o("div",pt," 세부 강의가 없습니다. ")),s("div",vt,[k(Je,{material:e.value},null,8,["material"])])],512),r.contentLoaded&&d.value.length?(a(),o("div",ht,[k(G,{materials:d.value},null,8,["materials"])],512)):w("",!0)]))],64)):(a(),o("div",ft,"접근 가능한 데이터가 없습니다."))])])}}}),Lt=S(gt,[["__scopeId","data-v-21a6c093"]]);export{Lt as default};
