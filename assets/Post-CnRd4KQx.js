import{d as g,i as M,q as y,s as P,n as w,l as W,c as n,x as $,g as I,u as L,j as E,F as x,e as c,m as l,y as D,o as s,_ as N,A as O,v as b,b as f,B as U}from"./index-BMBiNQBt.js";import{c as C}from"./commonLib-DGe6iNju.js";import{D as B,a as F,b as V,c as q,C as z,d as H}from"./DocumentHeader-gnu-fAvc.js";import{p as R,P as j}from"./Posts-B_nElHFI.js";const G={key:0,class:"video"},J={key:1,class:"content"},K=g({__name:"PostCore",props:{id:{},onContentLoaded:{type:Function}},setup(k){const i=M(),m=E(),u=k,_=y(),e=P({loaded:!1,title:"WAIT A MOMENT",desc:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",presentation:!1,created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),p=()=>{const t=new DOMParser().parseFromString(e.content,"text/html");Array.from(t.querySelectorAll("[data-bs-toggle='popover']")).forEach((a,d)=>{if(!e.sources[d]){console.warn("마크다운 파일에 입력한 출처와 차이가 있습니다.");return}a.setAttribute("title","출처"),a.setAttribute("data-bs-content",C.linkify(e.sources[d])),a.innerText=`[${d+1}]`}),e.content=t.body.innerHTML};return w(async()=>{const t=R.find(o=>o.id===u.id);if(t){const{html:o}=await t.read();e.title=t.title,e.desc=t.desc,e.videoUrl=t.videoUrl,e.content=C.linkify(o),e.presentation=t.presentation,e.created=t.created,e.updated=t.updated,e.sources=t.sources,e.references=t.references,p(),D(()=>{e.loaded=!0,u.onContentLoaded()}),i.updateSiteTitle(e.title)}}),W(()=>{i.updateSiteTitle()}),(t,o)=>(s(),n("div",{class:$(["post-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:_},[L(m).query.mode==="presentation"&&e.loaded?(s(),I(B,{key:0,title:e.title,desc:e.desc,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","desc","content","sources","references","created","updated"])):(s(),n(x,{key:1},[c(F,{title:e.title,desc:e.desc,presentation:e.presentation,created:e.created,updated:e.updated,skeleton:!e.loaded},null,8,["title","desc","presentation","created","updated","skeleton"]),e.videoUrl?(s(),n("div",G,[c(V,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):l("",!0),e.content?(s(),n("div",J,[c(q,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])):l("",!0)],64))],2))}}),Q=N(K,[["__scopeId","data-v-548c2c35"]]),X={class:"post"},Y={class:"container"},Z={class:"wrapper"},ee={class:"main"},te={key:0,class:"sources"},oe={key:1,class:"references"},se=g({__name:"Post",setup(k){const i=M(),m=O(),u=E(),_=y(),e=y(),p=P({contentLoaded:!1}),t=b(()=>{var r;return((r=u.params.id)==null?void 0:r.toString())??""}),o=b(()=>R.find(r=>r.id===t.value)),a=()=>{p.contentLoaded=!0},d=r=>{var v;i.windowSize.width<=1399||(v=e.value)==null||v.scrollTo({top:r-1,behavior:"smooth"})};return(r,v)=>{var h,T,A,S;return s(),n("div",X,[f("div",Y,[f("div",Z,[f("div",ee,[f("div",{class:"core",ref_key:"coreRef",ref:_},[(s(),I(Q,{id:t.value,key:t.value,onContentLoaded:a},null,8,["id"]))],512),(T=(h=o.value)==null?void 0:h.sources)!=null&&T.length?(s(),n("div",te,[c(z,{sources:o.value.sources},null,8,["sources"])])):l("",!0),(S=(A=o.value)==null?void 0:A.references)!=null&&S.length?(s(),n("div",oe,[c(H,{references:o.value.references},null,8,["references"])])):l("",!0)]),p.contentLoaded?(s(),n("div",{key:0,class:"posts",ref_key:"postsRef",ref:e,style:U({height:L(m).mainHeight})},[c(j,{id:t.value,onScrollable:d},null,8,["id"])],4)):l("",!0)])])])}}}),de=N(se,[["__scopeId","data-v-55a4327b"]]);export{de as default};
