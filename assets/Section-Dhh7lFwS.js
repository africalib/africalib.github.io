import{d as $,i as O,q as U,s as h,n as q,l as F,c as _,v as B,g as y,m as f,e as m,b as n,u as a,j as z,x as G,o as d,_ as M,y as b,w as A,f as H,t as x,z as j,A as W,B as J}from"./index-OWtPmFFj.js";import{c as g}from"./commonLib-B4LiHA7t.js";import{u as E}from"./useSection-C5Qp03yB.js";import{D as K,a as Q,b as X,c as Y,_ as Z,d as ee,C as te,e as oe}from"./common.angle.right-D5Lw6DRE.js";import{C as se}from"./Chapters-BFqyyCu2.js";import"./courses-DJyXLL1u.js";const ne="/assets/images/common.home.white.svg",ce={key:1,class:"video"},re={class:"content"},ae=$({__name:"SectionCore",props:{courseId:{},chapterId:{},sectionId:{},onContentLoaded:{type:Function}},setup(T){const u=O(),I=z(),p=E(),c=T,e=U({loaded:!1,title:"WAIT A MOMENT",desc:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",presentation:!1,created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),r=h(()=>p.getSection(c.courseId,c.chapterId,c.sectionId)),s=()=>{if(!e.sources.length)return;const t=new DOMParser().parseFromString(e.content,"text/html");Array.from(t.querySelectorAll("[data-bs-toggle='popover']")).forEach((o,v)=>{if(!e.sources[v]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}o.setAttribute("title","자료 출처"),o.setAttribute("data-bs-content",g.linkify(e.sources[v])),o.innerText=`[${v+1}]`}),e.content=t.body.innerHTML};return q(async()=>{const t=p.getCourse(c.courseId);if(t){const l=p.getChapter(c.courseId,c.chapterId);if(l){const o=r.value;if(o){const{html:v}=await o.read();e.title=o.title,e.desc=o.desc,e.videoUrl=o.videoUrl,e.sources=o.sources,e.references=o.references,e.content=g.linkify(v),e.presentation=o.presentation,e.created=o.created,e.updated=o.updated,e.courseTitle=t.title,e.chapterTitle=l.title,s(),G(()=>{e.loaded=!0,c.onContentLoaded()}),u.updateSiteTitle(g.extractText(e.title))}}}}),F(()=>{u.updateSiteTitle()}),(t,l)=>(d(),_("div",{class:B(["section-core",{skeleton:!e.loaded}])},[a(I).query.mode==="presentation"&&e.loaded?(d(),y(K,{key:0,title:e.title,desc:e.desc,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","desc","content","sources","references","created","updated"])):f("",!0),m(Q,{title:a(g).extractText(e.title),desc:e.desc,presentation:e.presentation,created:e.created,updated:e.updated,skeleton:!e.loaded},null,8,["title","desc","presentation","created","updated","skeleton"]),e.videoUrl?(d(),_("div",ce,[m(X,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):f("",!0),n("div",re,[m(Y,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])],2))}}),le=M(ae,[["__scopeId","data-v-72532146"]]),ie={class:"wrapper"},de={class:"title"},ue={class:"title"},pe=$({__name:"SectionNavigation",props:{courseId:{},chapterId:{},sectionId:{}},setup(T){const u=T,I=E(),p=b(()=>{var t;const r=[];return(((t=I.getCourse(u.courseId))==null?void 0:t.chapters)||[]).forEach(l=>{l.sections.forEach(o=>{r.push({id:o.id,title:g.extractText(o.title),url:`/courses/${u.courseId}/${l.id}/${o.id}`})})}),r}),c=b(()=>{let r=null;const s=p.value;for(let t=0;t<s.length;t++)if(s[t].id===u.sectionId){r=s[t-1];break}return r}),e=b(()=>{let r=null;const s=p.value;for(let t=0;t<s.length;t++)if(s[t].id===u.sectionId){r=s[t+1];break}return r});return(r,s)=>{const t=H("router-link");return d(),_("div",{class:B(["section-navigation",{both:a(c)&&a(e)}])},[n("div",ie,[a(c)?(d(),y(t,{key:0,to:a(c).url||"",class:"item prev",title:a(c).title},{default:A(()=>[s[0]||(s[0]=n("div",{class:"label"},[n("img",{src:Z,alt:"이전"}),n("span",null,"이전")],-1)),n("div",de,x(a(c).title),1)]),_:1},8,["to","title"])):f("",!0),a(e)?(d(),y(t,{key:1,to:a(e).url,class:"item next",title:a(e).title},{default:A(()=>[s[1]||(s[1]=n("div",{class:"label"},[n("img",{src:ee,alt:"다음"}),n("span",null,"다음")],-1)),n("div",ue,x(a(e).title),1)]),_:1},8,["to","title"])):f("",!0)])],2)}}}),me=M(pe,[["__scopeId","data-v-086a2450"]]),ve={class:"section"},_e={class:"container"},fe={class:"wrapper"},he={class:"main"},Ie={class:"core",ref:"coreRef"},Se={key:0,class:"sources"},ge={key:1,class:"references"},Te={class:"navigation"},ke=$({__name:"Section",setup(T){const u=O(),I=j(),p=E(),c=z(),e=W("chaptersTopRef"),r=W("chaptersRef"),s=U({contentLoaded:!1}),t=h(()=>{var i;return(i=c.params.courseId)==null?void 0:i.toString()}),l=h(()=>{var i;return(i=c.params.chapterId)==null?void 0:i.toString()}),o=h(()=>{var i;return(i=c.params.sectionId)==null?void 0:i.toString()}),v=h(()=>p.getCourse(t.value)),k=h(()=>p.getSection(t.value,l.value,o.value)),P=i=>{var S,C;u.windowSize.width<=1399||(C=r.value)==null||C.scrollTo({top:i-r.value.offsetTop-(((S=e.value)==null?void 0:S.offsetHeight)||0),behavior:"smooth"})},V=()=>{s.contentLoaded=!0};return(i,S)=>{var N,w,R,L;const C=H("router-link");return d(),_("div",ve,[n("div",_e,[n("div",fe,[n("div",he,[n("div",Ie,[(d(),y(le,{courseId:t.value,chapterId:l.value,sectionId:o.value,key:o.value,onContentLoaded:V},null,8,["courseId","chapterId","sectionId"]))],512),(w=(N=k.value)==null?void 0:N.sources)!=null&&w.length?(d(),_("div",Se,[m(te,{sources:k.value.sources},null,8,["sources"])])):f("",!0),(L=(R=k.value)==null?void 0:R.references)!=null&&L.length?(d(),_("div",ge,[m(oe,{references:k.value.references},null,8,["references"])])):f("",!0),n("div",Te,[m(me,{courseId:t.value,chapterId:l.value,sectionId:o.value},null,8,["courseId","chapterId","sectionId"])])]),s.contentLoaded?(d(),_("div",{key:0,class:"chapters",ref_key:"chaptersRef",ref:r,style:J({height:a(I).mainHeight})},[n("div",{class:"top",ref_key:"chaptersTopRef",ref:e},[m(C,{to:`/courses/${t.value}`,class:"btn"},{default:A(()=>{var D;return[S[0]||(S[0]=n("img",{src:ne},null,-1)),n("span",null,x((D=v.value)==null?void 0:D.title),1)]}),_:1},8,["to"])],512),m(se,{courseId:t.value,chapterId:l.value,sectionId:o.value,theme:"light",onScrollable:P},null,8,["courseId","chapterId","sectionId"])],4)):f("",!0)])])])}}}),Me=M(ke,[["__scopeId","data-v-a4f3041f"]]);export{Me as default};
