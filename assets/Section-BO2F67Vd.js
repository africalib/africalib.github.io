import{d as w,i as B,q as T,s as O,v as h,n as q,l as j,c as v,x as z,g as b,u as l,j as F,F as G,e as f,m as I,b as n,y as J,o as i,_ as E,z as A,w as $,f as H,t as x,A as K,B as Q}from"./index-B7KP6yNo.js";import{c as W}from"./commonLib-DZoi0k1s.js";import{u as L}from"./useSection-C9pAdipq.js";import{D as X,a as Y,b as Z,c as ee,C as te,d as oe}from"./DocumentHeader-ydIl0z8c.js";import{C as se}from"./Chapters-BnSz6RNE.js";import"./courses-Dartb5mQ.js";const ne="/assets/images/common.home.white.svg",ce={key:0,class:"video"},re={class:"content"},ae=w({__name:"SectionCore",props:{courseId:{},chapterId:{},sectionId:{},onContentLoaded:{type:Function}},setup(k){const u=B(),g=F(),p=L(),c=k,m=T(),e=O({loaded:!1,title:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",presentation:!1,created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),o=h(()=>p.getSection(c.courseId,c.chapterId,c.sectionId)),t=()=>{const r=new DOMParser().parseFromString(e.content,"text/html");Array.from(r.querySelectorAll("[data-bs-toggle='popover']")).forEach((s,_)=>{s.setAttribute("title","출처"),s.setAttribute("data-bs-content",W.linkify(e.sources[_])),s.innerText=`[${_+1}]`}),e.content=r.body.innerHTML};return q(async()=>{const r=p.getCourse(c.courseId);if(r){const a=p.getChapter(c.courseId,c.chapterId);if(a){const s=o.value;if(s){const{html:_}=await s.read();e.title=s.title,e.videoUrl=s.videoUrl,e.sources=s.sources,e.references=s.references,e.content=W.linkify(_),e.presentation=s.presentation,e.created=s.created,e.updated=s.updated,e.courseTitle=r.title,e.chapterTitle=a.title,t(),J(()=>{e.loaded=!0,c.onContentLoaded()}),u.updateSiteTitle(e.title)}}}}),j(()=>{u.updateSiteTitle()}),(r,a)=>(i(),v("div",{class:z(["section-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:m},[l(g).query.mode==="presentation"&&e.loaded?(i(),b(X,{key:0,title:e.title,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","content","sources","references","created","updated"])):(i(),v(G,{key:1},[f(Y,{title:e.title,presentation:e.presentation,created:e.created,updated:e.updated,skeleton:!e.loaded},null,8,["title","presentation","created","updated","skeleton"]),e.videoUrl?(i(),v("div",ce,[f(Z,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):I("",!0),n("div",re,[f(ee,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])],64))],2))}}),le=E(ae,[["__scopeId","data-v-c0041fff"]]),ie="/assets/images/common.angle.left.svg",de="/assets/images/common.angle.right.svg",ue={class:"wrapper"},pe={class:"title"},me={class:"title"},fe=w({__name:"SectionNavigation",props:{courseId:{},chapterId:{},sectionId:{}},setup(k){const u=k,g=L(),p=A(()=>{var t;const e=[];return(((t=g.getCourse(u.courseId))==null?void 0:t.chapters)||[]).forEach(r=>{r.sections.forEach(a=>{e.push({id:a.id,title:a.title,url:`/courses/${u.courseId}/${r.id}/${a.id}`})})}),e}),c=A(()=>{let e=null;const o=p.value;for(let t=0;t<o.length;t++)o[t].id===u.sectionId&&(e=o[t-1]);return e}),m=A(()=>{let e=null;const o=p.value;for(let t=0;t<o.length;t++)o[t].id===u.sectionId&&(e=o[t+1]);return e});return(e,o)=>{const t=H("router-link");return i(),v("div",{class:z(["section-navigation",{both:l(c)&&l(m)}])},[n("div",ue,[l(c)?(i(),b(t,{key:0,to:l(c).url||"",class:"item prev",title:l(c).title},{default:$(()=>[o[0]||(o[0]=n("div",{class:"label"},[n("img",{src:ie,alt:"이전"}),n("span",null,"이전")],-1)),n("div",pe,x(l(c).title),1)]),_:1},8,["to","title"])):I("",!0),l(m)?(i(),b(t,{key:1,to:l(m).url,class:"item next",title:l(m).title},{default:$(()=>[o[1]||(o[1]=n("div",{class:"label"},[n("img",{src:de,alt:"다음"}),n("span",null,"다음")],-1)),n("div",me,x(l(m).title),1)]),_:1},8,["to","title"])):I("",!0)])],2)}}}),ve=E(fe,[["__scopeId","data-v-91ef5a4d"]]),_e={class:"section"},he={class:"container"},Ie={class:"wrapper"},ge={class:"main"},Se={key:0,class:"sources"},ke={key:1,class:"references"},ye={class:"navigation"},Ce=w({__name:"Section",setup(k){const u=B(),g=K(),p=L(),c=F(),m=T(),e=T(),o=T(),t=O({contentLoaded:!1}),r=h(()=>{var d;return(d=c.params.courseId)==null?void 0:d.toString()}),a=h(()=>{var d;return(d=c.params.chapterId)==null?void 0:d.toString()}),s=h(()=>{var d;return(d=c.params.sectionId)==null?void 0:d.toString()}),_=h(()=>p.getCourse(r.value)),y=h(()=>p.getSection(r.value,a.value,s.value)),P=d=>{var S,C;u.windowSize.width<=1399||(C=o.value)==null||C.scrollTo({top:d-o.value.offsetTop-(((S=e.value)==null?void 0:S.offsetHeight)||0),behavior:"smooth"})},V=()=>{t.contentLoaded=!0};return(d,S)=>{var M,N,R,D;const C=H("router-link");return i(),v("div",_e,[n("div",he,[n("div",Ie,[n("div",ge,[n("div",{class:"core",ref_key:"coreRef",ref:m},[(i(),b(le,{courseId:r.value,chapterId:a.value,sectionId:s.value,key:s.value,onContentLoaded:V},null,8,["courseId","chapterId","sectionId"]))],512),(N=(M=y.value)==null?void 0:M.sources)!=null&&N.length?(i(),v("div",Se,[f(te,{sources:y.value.sources},null,8,["sources"])])):I("",!0),(D=(R=y.value)==null?void 0:R.references)!=null&&D.length?(i(),v("div",ke,[f(oe,{references:y.value.references},null,8,["references"])])):I("",!0),n("div",ye,[f(ve,{courseId:r.value,chapterId:a.value,sectionId:s.value},null,8,["courseId","chapterId","sectionId"])])]),t.contentLoaded?(i(),v("div",{key:0,class:"chapters",ref_key:"chaptersRef",ref:o,style:Q({height:l(g).mainHeight})},[n("div",{class:"top",ref_key:"chaptersTopRef",ref:e},[f(C,{to:`/courses/${r.value}`,class:"btn"},{default:$(()=>{var U;return[S[0]||(S[0]=n("img",{src:ne},null,-1)),n("span",null,x((U=_.value)==null?void 0:U.title),1)]}),_:1},8,["to"])],512),f(se,{courseId:r.value,chapterId:a.value,sectionId:s.value,theme:"light",onScrollable:P},null,8,["courseId","chapterId","sectionId"])],4)):I("",!0)])])])}}}),Ee=E(Ce,[["__scopeId","data-v-a98f26a6"]]);export{Ee as default};
