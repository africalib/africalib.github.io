import{d as L,c as m,e,F as H,r as Y,t as C,g as y,o,_ as R,n as U,h as q,b as $,u as N,i as j,j as A,T as ne,f as b,k as w,l as Q,m as B,p as W,q as re,s as Z,v as le,w as ie,x as ce,y as F,z as ue,A as z,B as P,C as ee,D as de,E as me,G as O}from"./index-C1Q4PEOi.js";import{u as V,M as G}from"./material-Bdyyq9Md.js";import{T as pe}from"./Tags-CnbCqUhf.js";import{c as T}from"./commonLib-B4LiHA7t.js";import{C as ve}from"./CryptoHelper-m6j8gmxG.js";import{_ as _e,a as he,b as fe}from"./common.arrow.left-TSorRx6s.js";import{A as ge}from"./Above-D3CTfTCq.js";import"./Panel-D657m1GS.js";const ye={class:"common-sources"},ke={class:"items"},be={class:"item"},Se=["innerHTML"],$e=L({__name:"MaterialSources",props:{sources:{}},setup(_){const t=_;return(r,h)=>(o(),m("div",ye,[h[0]||(h[0]=e("div",{class:"subject"},"자료 출처",-1)),e("div",ke,[(o(!0),m(H,null,Y(t.sources,(f,c)=>(o(),m("div",be,[e("span",null,"["+C(c+1)+"] ",1),e("span",{innerHTML:y(T).linkify(f)},null,8,Se)]))),256))])]))}}),te=R($e,[["__scopeId","data-v-3b532ca9"]]),we={class:"common-references"},xe={class:"items"},Me={class:"item"},Te=L({__name:"MaterialReferences",props:{references:{}},setup(_){const t=_;return(r,h)=>(o(),m("div",we,[h[0]||(h[0]=e("div",{class:"subject"},"참고 자료",-1)),e("div",xe,[(o(!0),m(H,null,Y(t.references,f=>(o(),m("div",Me,[e("span",null,C(f),1)]))),256))])]))}}),se=R(Te,[["__scopeId","data-v-9a0696c5"]]),Le=["innerHTML"],Ee=L({__name:"DocumentContent",props:{document:{},skeleton:{type:Boolean}},setup(_){const t=_;return(r,h)=>(o(),m("div",{class:U(["document-content",{skeleton:t.skeleton}])},[e("div",{innerHTML:t.document,ref:"contentRef"},null,8,Le)],2))}}),ae=R(Ee,[["__scopeId","data-v-af73dc37"]]),Re="/assets/images/component.document.presentation.slide.first.svg",Ce="/assets/images/component.material.presentation.finish.svg",X=L({__name:"DocumentPrompt",props:{content:{}},setup(_){const t=_;return q(()=>{console.info(t.content.replace(/\n{3,}/g,`

`))}),(r,h)=>null}}),Ae={class:"presentation"},He={class:"slides"},Ie={key:0,class:"slide start"},De={class:"container"},Pe={class:"slide-item"},qe=["innerHTML"],Ne={key:1,class:"slide finish"},je={class:"container"},Be={key:0,class:"slide"},Fe={class:"container"},K="no-overflow",ze=L({__name:"MaterialPresentation",props:{material:{},document:{}},setup(_){const t={touchStartX:0,touchStartY:0},r=_,h=N(),f=Q(),c=`이렇게 해서 ${T.extractText(r.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,l=$(()=>r.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),u=$(()=>{const d=[r.material.desc];return s.value.length===0&&a.value.length===1&&d.push(a.value[0]),d.join("")}),s=$(()=>{const d=new DOMParser().parseFromString(r.document,"text/html");return Array.from(d.querySelectorAll(".slide-item")).map(v=>v.outerHTML)}),a=$(()=>{const d=[],v={},k=new DOMParser().parseFromString(r.document,"text/html");Array.from(k.querySelectorAll(".slide-text")).forEach(n=>{const g=n.getAttribute("data-slide-text-group");g&&(!v[g]&&(v[g]=[]),v[g].push(T.replaceAll(n.outerText,"  ","").trim()))});for(let n in v)d.push(v[n].join(`
`));return d}),p=$(()=>{var d;return window.Number.parseInt(((d=h.query.idx)==null?void 0:d.toString())||"0")}),S=$(()=>s.value.length+1),i=d=>{const v=T.renew(h.query);let k=p.value+d;k<0?k=0:k>S.value&&(k=S.value),p.value!==k&&(v.idx=k.toString(),f.push({query:v}))},E=d=>{switch(d.key){case"ArrowLeft":!d.altKey&&i(-1);break;case"ArrowRight":!d.altKey&&i(1);break;case"F9":case"Escape":f.push({query:void 0});break}},x=d=>{const v=d.touches[0];t.touchStartX=v.clientX,t.touchStartY=v.clientY},M=d=>{const v=d.changedTouches[0],k=v.clientX,D=v.clientY,n=k-t.touchStartX,g=D-t.touchStartY;Math.abs(n)>Math.abs(g)&&Math.abs(n)>50&&(n>0?i(-1):i(1))};return q(()=>{document.addEventListener("keyup",E),document.addEventListener("touchstart",x),document.addEventListener("touchend",M),document.body.classList.add(K)}),j(()=>{document.removeEventListener("keyup",E),document.removeEventListener("touchstart",x),document.removeEventListener("touchend",M),document.body.classList.remove(K)}),(d,v)=>(o(),A(ne,{to:"body"},[e("div",Ae,[e("div",He,[p.value===0?(o(),m("div",Ie,[e("div",De,[e("figure",Pe,[v[0]||(v[0]=e("img",{src:Re,alt:"코딩",loading:"lazy"},null,-1)),e("figcaption",null,[e("span",{innerHTML:l.value},null,8,qe),b(X,{content:u.value},null,8,["content"])])])])])):p.value===S.value?(o(),m("div",Ne,[e("div",je,[v[1]||(v[1]=e("figure",{class:"slide-item"},[e("img",{src:Ce,alt:"하이파이브",class:"mh-400",loading:"lazy"}),e("figcaption",null,[e("b",null,"이상 끝. "),e("span",null,"수고하셨습니다!")])],-1)),r.material.sources.length?(o(),A(te,{key:0,class:"w-100 mb-3",sources:r.material.sources},null,8,["sources"])):w("",!0),r.material.references.length?(o(),A(se,{key:1,class:"w-100",references:r.material.references},null,8,["references"])):w("",!0),b(X,{content:c})])])):(o(!0),m(H,{key:2},Y(s.value.length,k=>(o(),m(H,null,[p.value===k?(o(),m("div",Be,[e("div",Fe,[b(ae,{document:s.value[k-1]},null,8,["document"]),b(X,{content:a.value[k-1]||""},null,8,["content"])])])):w("",!0)],64))),256))])])]))}}),Oe=R(ze,[["__scopeId","data-v-56f6ed8a"]]);function Xe(){const _=B(null),t=B(null),r=B(!1);return{data:_,error:t,loading:r,request:async({url:f,method:c="GET",body:l,contentType:u="application/json",...s})=>{r.value=!0,t.value=null;try{const a={"Content-Type":u,...s.headers||{}},p={method:c,headers:a,...s};l&&(p.body=u==="application/json"?JSON.stringify(l):l);const S=await fetch(f,p);if(!S.ok)throw new Error(`HTTP error! status: ${S.status}`);const i=S.headers.get("Content-Type");return i!=null&&i.includes("application/json")?_.value=await S.json():_.value=await S.text(),_.value}catch(a){throw t.value=a.message||"Unknown error",a}finally{r.value=!1}}}}const Ye={class:"presentation"},Ue={class:"content"},Ve={key:1},Ge=L({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(_){const t=N(),r=W(),h=re(),f=V(t),{data:c,loading:l,request:u}=Xe(),s=_,a=Z({document:"<p>PLEASE WAIT A MOMENT</p>",accessible:!1}),p=()=>{if(!s.material.sources.length)return;const i=new DOMParser().parseFromString(a.document,"text/html");Array.from(i.querySelectorAll("[data-bs-toggle='popover']")).forEach((x,M)=>{if(!s.material.sources[M]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}x.setAttribute("title","자료 출처"),x.setAttribute("data-bs-content",T.linkify(s.material.sources[M])),x.innerText=`[${M+1}]`}),a.document=i.body.innerHTML},S=async()=>{const i=window.location.hostname==="localhost";if(a.accessible=s.material.locked?h.admin:!0,a.accessible){const E=f.getUrlPath(s.material);await u({url:`/assets${E}/document.html?${Date.now()}`,contentType:"text/html"});const x=ce.get(F.unlockPasswordCookieName);if(s.material.locked&&x&&!i){const M=new ve(x,F.salt,F.iv);c.value=await M.decrypt(c.value).catch(d=>(console.error({err:d,message:"문서를 복호화 할 수 없습니다."}),null))}a.document=T.linkify(c.value),p()}ue(()=>{s.onDocumentLoaded()}),r.updateSiteTitle(T.extractText(s.material.title))};return le(()=>{S()}),j(()=>{r.updateSiteTitle()}),ie(()=>t.path,()=>{S()}),(i,E)=>(o(),m("div",{class:U(["material-core",{skeleton:y(l)}])},[e("div",Ye,[y(t).query.mode==="presentation"&&!y(l)&&a.accessible?(o(),A(Oe,{key:0,material:s.material,document:a.document},null,8,["material","document"])):w("",!0)]),e("div",Ue,[a.accessible?(o(),A(ae,{key:0,document:a.document,skeleton:y(l)},null,8,["document","skeleton"])):(o(),m("div",Ve,"조회 가능한 문서가 없습니다."))])],2))}}),Ke=R(Ge,[["__scopeId","data-v-62f8a174"]]),Je={class:"wrapper"},Qe={class:"title"},We={class:"title"},Ze=L({__name:"MaterialNavigation",props:{material:{}},setup(_){const t=_,r=N(),h=V(r),f=z(()=>{var s;const u=[];return t.material&&((s=t.material.parent)==null||s.children.forEach(a=>{const p=h.getUrlPath(a);u.push({id:a.id,title:T.extractText(a.title),url:p})})),u}),c=z(()=>{var a;let u=null;const s=f.value;for(let p=0;p<s.length;p++)if(s[p].id===((a=t.material)==null?void 0:a.id)){u=s[p-1];break}return u}),l=z(()=>{var a;let u=null;const s=f.value;for(let p=0;p<s.length;p++)if(s[p].id===((a=t.material)==null?void 0:a.id)){u=s[p+1];break}return u});return(u,s)=>{const a=ee("router-link");return o(),m("div",{class:U(["material-navigation",{both:y(c)&&y(l)}])},[e("div",Je,[y(c)?(o(),A(a,{key:0,to:y(c).url||"",class:"item prev",title:y(c).title},{default:P(()=>[s[0]||(s[0]=e("div",{class:"label"},[e("img",{src:_e,alt:"이전"}),e("span",null,"이전")],-1)),e("div",Qe,C(y(c).title),1)]),_:1},8,["to","title"])):w("",!0),y(l)?(o(),A(a,{key:1,to:y(l).url,class:"item next",title:y(l).title},{default:P(()=>[s[1]||(s[1]=e("div",{class:"label"},[e("img",{src:he,alt:"다음"}),e("span",null,"다음")],-1)),e("div",We,C(y(l).title),1)]),_:1},8,["to","title"])):w("",!0)])],2)}}}),et=R(Ze,[["__scopeId","data-v-1831093f"]]),tt={class:"material-above"},st={class:"back"},at={class:"bottom"},ot=["title"],nt=["title"],J="?mode=presentation",rt=L({__name:"MaterialAbove",props:{material:{}},setup(_){const t=_,r=Q(),h=c=>{c.key==="F9"&&r.push(J)},f=$(()=>{const c={title:"강의 자료",url:"/materials"};return t.material.parent&&(c.title=t.material.parent.title,c.url=t.material.parent.url),c});return q(()=>{document.addEventListener("keyup",h)}),j(()=>{document.removeEventListener("keyup",h)}),(c,l)=>{const u=ee("router-link");return o(),m("div",tt,[e("div",st,[b(u,{to:f.value.url},{default:P(()=>[l[0]||(l[0]=e("img",{src:fe,alt:"뒤로가기",title:"뒤로가기"},null,-1)),e("span",null,C(f.value.title),1)]),_:1},8,["to"])]),b(ge,{title:y(T).extractText(t.material.title),desc:t.material.desc},null,8,["title","desc"]),e("div",at,[e("span",{title:t.material.created}," 생성: "+C(y(T).getHumanReadableDate(t.material.created)),9,ot),t.material.created!==t.material.updated?(o(),m(H,{key:0},[l[1]||(l[1]=e("span",{class:"bar"},null,-1)),e("span",{title:t.material.updated}," 수정: "+C(y(T).getHumanReadableDate(t.material.updated)),9,nt)],64)):w("",!0),t.material.presentation?(o(),m(H,{key:1},[l[3]||(l[3]=e("span",{class:"bar"},null,-1)),b(u,{to:J},{default:P(()=>l[2]||(l[2]=[de("발표(F9)")])),_:1})],64)):w("",!0)])])}}}),lt=R(rt,[["__scopeId","data-v-056f4539"]]),it={class:"material"},ct={class:"container"},ut={key:0,class:"list"},dt={class:"tags"},mt={key:1,class:"detail"},pt={class:"core",ref:"coreRef"},vt={key:0,class:"sources"},_t={key:1,class:"references"},ht={class:"navigation"},ft=L({__name:"MaterialDetail",setup(_){const t=N(),r=W(),h=me(),f=V(t),c=O("aboveRef"),l=O("mainRef"),u=O("materialsRef"),s=Z({contentLoaded:!1}),a=$(()=>{var n;return(n=t.params.id1)==null?void 0:n.toString()}),p=$(()=>{var n;return(n=t.params.id2)==null?void 0:n.toString()}),S=$(()=>{var n;return(n=t.params.id3)==null?void 0:n.toString()}),i=$(()=>f.get(a.value,p.value,S.value)),E=$(()=>{var n,g;return((g=(n=i.value)==null?void 0:n.parent)==null?void 0:g.children)||[]}),x=$(()=>{var g;const n=new Set;return n.add(void 0),(g=f.get(a.value))==null||g.tags.forEach(I=>n.add(I)),n}),M=$(()=>{if(t.query.tag)return window.decodeURIComponent(t.query.tag.toString())}),d=n=>{var g;r.windowSize.width<=1399||(k(),(g=u.value)==null||g.scrollTo({top:n-u.value.offsetTop,behavior:"smooth"}))},v=()=>{s.contentLoaded=!0},k=()=>{if(!c.value||!l.value||!u.value||r.windowSize.width<=1399)return;const n=c.value.getBoundingClientRect(),g=l.value.getBoundingClientRect(),I=Math.max(Math.min(n.bottom,r.windowSize.height)-Math.max(n.top,0),0),oe=h.mainHeight-I;u.value.style.maxHeight=Math.min(g.height,oe)+"px"},D=()=>{k()};return q(()=>{window.addEventListener("scroll",D)}),j(()=>{window.removeEventListener("scroll",D)}),(n,g)=>{var I;return o(),m("div",it,[e("div",ct,[i.value?(o(),m(H,{key:0},[e("div",{class:"above",ref_key:"aboveRef",ref:c},[b(lt,{material:i.value},null,8,["material"])],512),i.value.children.length?(o(),m("div",ut,[e("div",dt,[b(pe,{tags:x.value,tag:M.value},null,8,["tags","tag"])]),b(G,{materials:i.value.children,tag:M.value},null,8,["materials","tag"])])):(o(),m("div",mt,[e("div",{class:"main",ref_key:"mainRef",ref:l},[e("div",pt,[b(Ke,{material:i.value,onDocumentLoaded:v},null,8,["material"])],512),!i.value.locked&&i.value.sources.length?(o(),m("div",vt,[b(te,{sources:i.value.sources},null,8,["sources"])])):w("",!0),!i.value.locked&&((I=i.value.references)!=null&&I.length)?(o(),m("div",_t,[b(se,{references:i.value.references},null,8,["references"])])):w("",!0),e("div",ht,[b(et,{material:i.value},null,8,["material"])])],512),s.contentLoaded?(o(),m("div",{key:0,class:"materials",ref_key:"materialsRef",ref:u},[b(G,{materials:E.value,onScrollable:d},null,8,["materials"])],512)):w("",!0)]))],64)):w("",!0)])])}}}),Mt=R(ft,[["__scopeId","data-v-486b0fea"]]);export{Mt as default};
