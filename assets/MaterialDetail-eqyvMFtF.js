import{d as S,g as $,c as l,b as s,F as A,r as R,t as H,u as f,o as a,_ as C,n as X,i as Y,h as N,j as K,k as q,f as b,l as M,T as oe,m as Z,p as F,q as re,s as j,v as ee,w as le,x as ce,y as ie,z as B,A as ue,B as O,C as P,D as z,E as te}from"./index-BI9E_9Zi.js";import{u as V,M as J}from"./Materials-DrvCd-qv.js";import{T as de}from"./Tags-BgGldzr7.js";import{c as x}from"./commonLib-Co9BQnS0.js";import{C as me}from"./CryptoHelper-m6j8gmxG.js";import{_ as pe,a as _e,b as ve}from"./common.arrow.left-TSorRx6s.js";import{r as fe}from"./routeLib-DhAZaWiT.js";import{A as he}from"./Above-vWXKYl3t.js";import"./Panel-C6nXD1da.js";const ge={class:"common-sources"},ye={class:"items"},ke=["innerHTML"],$e=S({__name:"MaterialSources",props:{sources:{}},setup(h){const e=h,c=$(()=>{const _=new Map;return e.sources.forEach((o,m)=>{_.has(o)||_.set(o,[]),_.get(o).push(m+1)}),Array.from(_.entries()).map(([o,m])=>({indexes:m,src:o}))});return(_,o)=>(a(),l("div",ge,[o[1]||(o[1]=s("div",{class:"subject"},"자료 출처",-1)),s("div",ye,[(a(!0),l(A,null,R(c.value,m=>(a(),l("div",{class:"item",key:m.src},[(a(!0),l(A,null,R(m.indexes,d=>(a(),l("span",null,"["+H(d)+"]",1))),256)),o[0]||(o[0]=s("span",null," ",-1)),s("span",{innerHTML:f(x).linkify(m.src)},null,8,ke)]))),128))])]))}}),se=C($e,[["__scopeId","data-v-a34ac84b"]]),be={class:"common-references"},we={class:"items"},xe={class:"item"},Me=S({__name:"MaterialReferences",props:{references:{}},setup(h){const e=h;return(c,_)=>(a(),l("div",be,[_[0]||(_[0]=s("div",{class:"subject"},"참고 자료",-1)),s("div",we,[(a(!0),l(A,null,R(e.references,o=>(a(),l("div",xe,[s("span",null,H(o),1)]))),256))])]))}}),ae=C(Me,[["__scopeId","data-v-64c8b31c"]]),Te=["innerHTML"],Se=S({__name:"DocumentContent",props:{document:{},skeleton:{type:Boolean}},setup(h){const e=h;return(c,_)=>(a(),l("div",{class:X(["document-content",{skeleton:e.skeleton}])},[s("div",{innerHTML:e.document,ref:"contentRef"},null,8,Te)],2))}}),ne=C(Se,[["__scopeId","data-v-7a52ca4e"]]),Le="/assets/images/component.document.presentation.slide.first.svg",Ee="/assets/images/component.material.presentation.finish.svg",U=S({__name:"DocumentPrompt",props:{content:{}},setup(h){const e=h;return Y(()=>{console.info(e.content.replace(/\n{3,}/g,`

`))}),(c,_)=>null}}),Ae={class:"presentation"},Ce={class:"slides"},De={key:0,class:"slide start"},Ie={class:"container"},qe={class:"slide-item"},He=["innerHTML"],Pe={key:1,class:"slide finish"},Re={class:"container"},Ne={key:0,class:"slide"},je={class:"container"},Q="no-overflow",Fe=S({__name:"MaterialPresentation",props:{material:{},document:{}},setup(h){const e={touchStartX:0,touchStartY:0},c=h,_=N(),o=Z(),m=`이렇게 해서 ${x.extractText(c.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,d=$(()=>c.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),i=$(()=>{const p=[c.material.desc];return n.value.length===0&&t.value.length===1&&p.push(t.value[0]),p.join("")}),n=$(()=>{const p=new DOMParser().parseFromString(c.document,"text/html");return Array.from(p.querySelectorAll(".slide-item")).map(v=>v.outerHTML)}),t=$(()=>{const p=[],v={},w=new DOMParser().parseFromString(c.document,"text/html");Array.from(w.querySelectorAll(".slide-text")).forEach(E=>{const I=E.getAttribute("data-slide-text-group");I&&(!v[I]&&(v[I]=[]),v[I].push(x.replaceAll(E.outerText,"  ","").trim()))});for(let E in v)p.push(v[E].join(`
`));return p}),r=$(()=>{var p;return window.Number.parseInt(((p=_.query.idx)==null?void 0:p.toString())||"0")}),g=$(()=>n.value.length+1),y=p=>{const v=x.renew(_.query);let w=r.value+p;w<0?w=0:w>g.value&&(w=g.value),r.value!==w&&(v.idx=w.toString(),o.push({query:v}))},T=(p,v)=>{switch(p){case"ArrowLeft":!v&&y(-1);break;case"ArrowRight":!v&&y(1);break;case"F9":case"Escape":o.push({query:void 0});break}},u=p=>{T(p.key,p.altKey)},k=p=>{const v=p.touches[0];e.touchStartX=v.clientX,e.touchStartY=v.clientY},L=p=>{const v=p.changedTouches[0],w=v.clientX,G=v.clientY,E=w-e.touchStartX,I=G-e.touchStartY;Math.abs(E)>Math.abs(I)&&Math.abs(E)>50&&(E>0?y(-1):y(1))},D=p=>{p.data.type==="keyup"&&T(p.data.key,p.data.altKey)};return Y(()=>{document.addEventListener("keyup",u),document.addEventListener("touchstart",k),document.addEventListener("touchend",L),window.addEventListener("message",D),document.body.classList.add(Q)}),K(()=>{document.removeEventListener("keyup",u),document.removeEventListener("touchstart",k),document.removeEventListener("touchend",L),window.removeEventListener("message",D),document.body.classList.remove(Q)}),(p,v)=>(a(),q(oe,{to:"body"},[s("div",Ae,[s("div",Ce,[r.value===0?(a(),l("div",De,[s("div",Ie,[s("figure",qe,[v[0]||(v[0]=s("img",{src:Le,alt:"코딩",loading:"lazy"},null,-1)),s("figcaption",null,[s("span",{innerHTML:d.value},null,8,He),b(U,{content:i.value},null,8,["content"])])])])])):r.value===g.value?(a(),l("div",Pe,[s("div",Re,[v[1]||(v[1]=s("figure",{class:"slide-item"},[s("img",{src:Ee,alt:"하이파이브",class:"mh-400",loading:"lazy"}),s("figcaption",null,[s("b",null,"이상 끝. "),s("span",null,"수고하셨습니다!")])],-1)),c.material.sources.length?(a(),q(se,{key:0,class:"w-100 mb-3",sources:c.material.sources},null,8,["sources"])):M("",!0),c.material.references.length?(a(),q(ae,{key:1,class:"w-100",references:c.material.references},null,8,["references"])):M("",!0),b(U,{content:m})])])):(a(!0),l(A,{key:2},R(n.value.length,w=>(a(),l(A,null,[r.value===w?(a(),l("div",Ne,[s("div",je,[b(ne,{document:n.value[w-1]},null,8,["document"]),b(U,{content:t.value[w-1]||""},null,8,["content"])])])):M("",!0)],64))),256))])])]))}}),Be=C(Fe,[["__scopeId","data-v-6bffa037"]]);function Oe(){const h=F(null),e=F(null),c=F(!1);return{data:h,error:e,loading:c,request:async({url:o,method:m="GET",body:d,contentType:i="application/json",...n})=>{c.value=!0,e.value=null;try{const t={"Content-Type":i,...n.headers||{}},r={method:m,headers:t,...n};d&&(r.body=i==="application/json"?JSON.stringify(d):d);const g=await fetch(o,r);if(!g.ok)throw new Error(`HTTP error! status: ${g.status}`);const y=g.headers.get("Content-Type");return y!=null&&y.includes("application/json")?h.value=await g.json():h.value=await g.text(),h.value}catch(t){throw e.value=t.message||"Unknown error",t}finally{c.value=!1}}}}const Ue={key:0,class:"presentation"},Xe={class:"content"},Ye={key:1,class:"empty"},Ke=S({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(h){const e=N(),c=re(),_=j(),o=V(e),{data:m,loading:d,request:i}=Oe(),n=h,t=ee({document:"<p>PLEASE WAIT A MOMENT</p>"}),r=()=>{if(!n.material.sources.length)return;const y=new DOMParser().parseFromString(t.document,"text/html");Array.from(y.querySelectorAll("[data-bs-toggle='popover']")).forEach((u,k)=>{if(!n.material.sources[k]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}u.setAttribute("title","자료 출처"),u.setAttribute("data-bs-content",x.linkify(n.material.sources[k])),u.innerText=`[${k+1}]`}),t.document=y.body.innerHTML},g=async()=>{if(n.material){const y=o.getUrlPath(n.material);await i({url:`/assets${y}/document.html?${Date.now()}`,contentType:"text/html"});const T=ie.get(B.unlockPasswordCookieName),u=window.location.hostname==="localhost";if(n.material.locked&&T&&!u){const k=new me(T,B.salt,B.iv);m.value=await k.decrypt(m.value).catch(L=>(console.error({err:L,message:"문서를 복호화 할 수 없습니다."}),null))}t.document=x.linkify(m.value),r()}ue(()=>{n.onDocumentLoaded()}),c.updateSiteTitle(x.extractText(n.material.title))};return le(()=>{g()}),K(()=>{c.updateSiteTitle()}),ce(()=>e.path,()=>{g()}),(y,T)=>(a(),l("div",{class:X(["material-core",{skeleton:f(d)}])},[f(e).query.mode==="presentation"&&!f(d)&&f(_).admin?(a(),l("div",Ue,[b(Be,{material:n.material,document:t.document},null,8,["material","document"])])):M("",!0),s("div",Xe,[t.document?(a(),q(ne,{key:0,document:t.document,skeleton:f(d)},null,8,["document","skeleton"])):(a(),l("div",Ye,"조회 가능한 문서가 없습니다."))])],2))}}),ze=C(Ke,[["__scopeId","data-v-8f542003"]]),Ve={class:"wrapper"},Ge={class:"title"},Je={class:"title"},Qe=S({__name:"MaterialNavigation",props:{material:{}},setup(h){const e=h,c=N();j(),V(c);const _=O(()=>{var i,n;const d=[];if((n=(i=e.material)==null?void 0:i.parent)!=null&&n.children){const t=fe.getTag(c);e.material.parent.children.forEach(r=>{(!t||r.tags.includes(t))&&d.push(r)})}return d}),o=O(()=>{var n;let d=null;const i=_.value;for(let t=0;t<i.length;t++)if(i[t].id===((n=e.material)==null?void 0:n.id)&&i[t-1]){d=i[t-1];break}return d}),m=O(()=>{var n;let d=null;const i=_.value;for(let t=0;t<i.length;t++)if(i[t].id===((n=e.material)==null?void 0:n.id)&&i[t+1]){d=i[t+1];break}return d});return(d,i)=>{const n=z("router-link");return a(),l("div",{class:X(["material-navigation",{both:f(o)&&f(m)}])},[s("div",Ve,[f(o)?(a(),q(n,{key:0,to:f(o).url||"",class:"item prev",title:f(o).title},{default:P(()=>[i[0]||(i[0]=s("div",{class:"label"},[s("img",{src:pe,alt:"이전"}),s("span",null,"이전")],-1)),s("div",Ge,H(f(x).extractText(f(o).title)),1)]),_:1},8,["to","title"])):M("",!0),f(m)?(a(),q(n,{key:1,to:f(m).url,class:"item next",title:f(m).title},{default:P(()=>[i[1]||(i[1]=s("div",{class:"label"},[s("img",{src:_e,alt:"다음"}),s("span",null,"다음")],-1)),s("div",Je,H(f(x).extractText(f(m).title)),1)]),_:1},8,["to","title"])):M("",!0)])],2)}}}),We=C(Qe,[["__scopeId","data-v-e31a069d"]]),Ze={class:"material-above"},et={class:"back"},tt={class:"wrapper"},st={class:"dates"},at=["title"],W="?mode=presentation",nt=S({__name:"MaterialAbove",props:{material:{}},setup(h){const e=h,c=Z(),_=j(),o=r=>{r==="F9"&&_.admin&&c.push(W)},m=r=>{o(r.key)},d=$(()=>{const r={title:"강의 자료",url:"/materials"};return e.material.parent&&(r.title=e.material.parent.title,r.url=e.material.parent.url),r}),i=$(()=>e.material.created?e.material.updated?x.getHumanReadableDate(e.material.updated)+" 업데이트됨":x.getHumanReadableDate(e.material.created)+" 생성됨":"(N/A)"),n=$(()=>{if(e.material.created){const r=[`생성: ${e.material.created}`];return e.material.updated&&r.push(`업데이트: ${e.material.created}`),r.join(" | ")}}),t=r=>{r.data.type==="keyup"&&o(r.data.key)};return Y(()=>{document.addEventListener("keyup",m),window.addEventListener("message",t)}),K(()=>{document.removeEventListener("keyup",m),window.removeEventListener("message",t)}),(r,g)=>{const y=z("router-link");return a(),l("div",Ze,[s("div",et,[b(y,{to:d.value.url},{default:P(()=>[g[0]||(g[0]=s("img",{src:ve,alt:"뒤로가기",title:"뒤로가기"},null,-1)),s("span",null,H(d.value.title),1)]),_:1},8,["to"])]),s("div",tt,[s("div",st,[s("span",{title:n.value},H(i.value),9,at),e.material.presentation&&f(_).admin?(a(),l(A,{key:0},[g[2]||(g[2]=s("span",{class:"bar"},null,-1)),b(y,{to:W},{default:P(()=>g[1]||(g[1]=[te("발표(F9)")])),_:1})],64)):M("",!0)]),b(he,{title:f(x).extractText(e.material.title),desc:e.material.desc},null,8,["title","desc"])])])}}}),ot=C(nt,[["__scopeId","data-v-f7a291a7"]]),rt={class:"material"},lt={class:"container"},ct={class:"above",ref:"aboveRef"},it={key:0,class:"list"},ut={class:"tags"},dt={key:1,class:"detail"},mt={class:"main",ref:"mainRef"},pt={class:"core",ref:"coreRef"},_t={key:0,class:"sources"},vt={key:1,class:"references"},ft={key:1,class:"login"},ht={class:"navigation"},gt={key:0,class:"materials",ref:"materialsRef"},yt={key:1,class:"empty"},kt=S({__name:"MaterialDetail",setup(h){const e=N(),c=j(),_=V(e),o=ee({contentLoaded:!1}),m=$(()=>{var u;return!((u=t.value)!=null&&u.locked)||c.admin}),d=$(()=>{var u;return(u=e.params.id1)==null?void 0:u.toString()}),i=$(()=>{var u;return(u=e.params.id2)==null?void 0:u.toString()}),n=$(()=>{var u;return(u=e.params.id3)==null?void 0:u.toString()}),t=$(()=>_.get(d.value,i.value,n.value)),r=$(()=>{var u,k;return((k=(u=t.value)==null?void 0:u.parent)==null?void 0:k.children)||[]}),g=$(()=>{var k;const u=new Set;return u.add(void 0),(k=_.get(d.value))==null||k.tags.forEach(L=>u.add(L)),u}),y=$(()=>{if(e.query.tag)return window.decodeURIComponent(e.query.tag.toString())}),T=()=>{o.contentLoaded=!0};return(u,k)=>{var D;const L=z("router-link");return a(),l("div",rt,[s("div",lt,[t.value?(a(),l(A,{key:0},[s("div",ct,[b(ot,{material:t.value},null,8,["material"])],512),t.value.children.length?(a(),l("div",it,[s("div",ut,[b(de,{tags:g.value,tag:y.value},null,8,["tags","tag"])]),b(J,{materials:t.value.children,tag:y.value},null,8,["materials","tag"])])):(a(),l("div",dt,[s("div",mt,[m.value?(a(),l(A,{key:0},[s("div",pt,[b(ze,{material:t.value,onDocumentLoaded:T},null,8,["material"])],512),t.value.sources.length?(a(),l("div",_t,[b(se,{sources:t.value.sources},null,8,["sources"])])):M("",!0),(D=t.value.references)!=null&&D.length?(a(),l("div",vt,[b(ae,{references:t.value.references},null,8,["references"])])):M("",!0)],64)):(a(),l("div",ft,[b(L,{to:f(c).getLoginUrl(f(e),!0)},{default:P(()=>k[0]||(k[0]=[te("로그인")])),_:1},8,["to"]),k[1]||(k[1]=s("span",null,"이 필요합니다.",-1))])),s("div",ht,[b(We,{material:t.value},null,8,["material"])])],512),o.contentLoaded&&r.value.length?(a(),l("div",gt,[b(J,{materials:r.value},null,8,["materials"])],512)):M("",!0)]))],64)):(a(),l("div",yt,"접근 가능한 데이터가 없습니다."))])])}}}),At=C(kt,[["__scopeId","data-v-f42c8a91"]]);export{At as default};
