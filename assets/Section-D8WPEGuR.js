import{f as w,q as L,c as _,s as E,b as t,o as a,_ as T,F as R,g as P,t as $,u as k,m as I,v as te,k as q,x as b,j as O,l as J,h as C,T as oe,d as S,w as x,p as se,r as D,i as G,y as X,n as ne,z as re,A as ce,B as H,C as ae,D as le}from"./index-BTcSdAml.js";import{u as U}from"./useSection-C08xZLPI.js";import{C as ie}from"./Chapters-D6ym37No.js";import"./courses-DmFPEroD.js";const de="/assets/images/common.home.white.svg",ue="/assets/images/component.section.core.presentation.open.svg",M={renew(r){return JSON.parse(JSON.stringify(r))},linkify(r){const o=/(\bhttps?:\/\/[^\s<>"')\]]+)/g;return r.replace(o,(m,s)=>r.includes(`<a href="${s}"`)||r.includes(`<a href='${s}'`)?m:`<a href="${s}" target="_blank" rel="noopener noreferrer">${s}</a>`)},replaceAll(r,o,m){return r.split(o).join(m)},isNumeric(r){return!isNaN(Number(r))},generateDomId(){return window.crypto.randomUUID()},getHumanReadableDate(r){const o=new Date(r.replace(" ","T")),s=new Date().getTime()-o.getTime(),i=Math.floor(s/1e3),v=Math.floor(i/60),d=Math.floor(v/60),e=Math.floor(d/24),c=Math.floor(e/30),h=Math.floor(e/365);return isNaN(o.getTime())?"(N/A)":i<60?"방금 전":v<60?`${v}분 전`:d<24?`${d}시간 전`:e<30?`${e}일 전`:c<12?`${c}개월 전`:`${h}년 전`}},pe=["innerHTML"],_e=w({__name:"SectionContent",props:{content:{},skeleton:{type:Boolean}},setup(r){const o=r,m=L();return(s,i)=>(a(),_("div",{class:E(["section-core-content",{skeleton:o.skeleton}]),ref_key:"rootRef",ref:m},[t("div",{innerHTML:o.content},null,8,pe)],2))}}),Y=T(_e,[["__scopeId","data-v-7741b346"]]),me=w({__name:"SectionVideo",props:{url:{},skeleton:{type:Boolean}},setup(r){const o=r;return(m,s)=>(a(),_("div",{class:E(["section-core-video",{skeleton:o.skeleton}])},s[0]||(s[0]=[t("div",{class:"wrapper"},[t("div",{class:"inner"})],-1)]),2))}}),fe=T(me,[["__scopeId","data-v-eea266e5"]]),ve="/assets/images/component.section.core.presentation.position.svg",he="/assets/images/component.section.core.presentation.close.svg",ge="/assets/images/component.section.core.presentation.finish.svg",ke={class:"section-sources"},Se={class:"items"},ye={class:"item"},Ie=["innerHTML"],$e=w({__name:"SectionSources",props:{sources:{}},setup(r){const o=r;return(m,s)=>(a(),_("div",ke,[s[0]||(s[0]=t("div",{class:"subject"},"자료 출처",-1)),t("div",Se,[(a(!0),_(R,null,P(o.sources,(i,v)=>(a(),_("div",ye,[t("span",null,"["+$(v+1)+"] ",1),t("span",{innerHTML:k(M).linkify(i)},null,8,Ie)]))),256))])]))}}),Q=T($e,[["__scopeId","data-v-788a8476"]]),be={class:"section-references"},we={class:"items"},Te={class:"item"},Ce=w({__name:"SectionReferences",props:{references:{}},setup(r){const o=r;return(m,s)=>(a(),_("div",be,[s[0]||(s[0]=t("div",{class:"subject"},"참고 자료",-1)),t("div",we,[(a(!0),_(R,null,P(o.references,i=>(a(),_("div",Te,[t("span",null,$(i),1)]))),256))])]))}}),Z=T(Ce,[["__scopeId","data-v-032f39d2"]]),xe={class:"wrapper"},Me={class:"title"},Ae={class:"date"},Le=["title"],Re=["title"],Ne={class:"side"},Ee=w({__name:"SectionHeader",props:{title:{},created:{},updated:{},skeleton:{type:Boolean}},setup(r){const o=r;return(m,s)=>(a(),_("div",{class:E(["section-header",{skeleton:o.skeleton}])},[t("div",xe,[t("div",Me,[t("span",null,$(o.title),1)]),t("div",Ae,[t("span",{title:o.created}," 생성: "+$(k(M).getHumanReadableDate(o.created)),9,Le),o.created!==o.updated?(a(),_(R,{key:0},[s[0]||(s[0]=t("span",{class:"bar"},null,-1)),t("span",{title:o.updated}," 수정: "+$(k(M).getHumanReadableDate(o.updated)),9,Re)],64)):I("",!0)])]),t("div",Ne,[te(m.$slots,"default",{},void 0)])],2))}}),ee=T(Ee,[["__scopeId","data-v-5a67f70b"]]),V=w({__name:"SectionPrompt",props:{content:{}},setup(r){const o=r;return q(()=>{console.info(o.content)}),(m,s)=>null}}),De={class:"hide-sm",title:"슬라이드 번호"},He={class:"container"},Pe={key:0,class:"slide"},qe={key:0,class:"slide finish"},Oe="이상 끝. 수고하셨습니다!",K="no-overflow",Ue=w({__name:"SectionPresentation",props:{title:{},created:{},updated:{},content:{},sources:{},references:{}},setup(r){const o=r,m=O(),s=se(),i=L(null),v=`이렇게 해서 ${o.title}에 대해 알아봤습니다. 수고하셨습니다!`,d=b(()=>{const l=new DOMParser().parseFromString(o.content,"text/html");return Array.from(l.querySelectorAll(".slide-item")).map(f=>f.outerHTML)}),e=b(()=>{const l=new DOMParser().parseFromString(o.content,"text/html");return Array.from(l.querySelectorAll(".slide-text")).map(f=>M.replaceAll(f.outerText,"  ","").trim())}),c=b(()=>{var l;return window.Number.parseInt(((l=m.query.idx)==null?void 0:l.toString())||"0")}),h=()=>{const l=[];return d.value.length<e.value.length?l.unshift(e.value[e.value.length-1]):l.push(v),l.join(" ")},g=l=>{const f=M.renew(m.query);let n=c.value+l;n<0?n=0:n>d.value.length&&(n=d.value.length),c.value!==n&&(f.idx=n.toString(),s.push({query:f}))},y=l=>{switch(l.key){case"ArrowLeft":!l.altKey&&g(-1);break;case"ArrowRight":!l.altKey&&g(1);break;case"Escape":s.push({query:void 0});break}},N=l=>{const f=window.innerWidth,n=l.target;n.closest("[data-bs-toggle]")||n.closest("[href]")||(l.clientX<f/2?g(-1):g(1))};return q(()=>{document.addEventListener("keyup",y),document.body.classList.add(K)}),J(()=>{document.removeEventListener("keyup",y),document.body.classList.remove(K)}),(l,f)=>{const n=D("router-link");return a(),C(oe,{to:"body"},[t("div",{class:"presentation",ref_key:"rootRef",ref:i},[S(ee,{title:o.title,created:o.created,updated:o.updated,skeleton:!1},{default:x(()=>[t("div",De,[f[0]||(f[0]=t("img",{src:ve,alt:"슬라이드 번호"},null,-1)),t("div",null,$(c.value+1)+" / "+$(d.value.length+1),1)]),S(n,{to:"?"},{default:x(()=>f[1]||(f[1]=[t("img",{src:he,alt:"닫기"},null,-1),t("div",null,"닫기",-1)])),_:1})]),_:1},8,["title","created","updated"]),t("div",{class:"slides",onClick:N},[t("div",He,[(a(!0),_(R,null,P(d.value,(p,u)=>(a(),_(R,null,[c.value===u?(a(),_("div",Pe,[S(Y,{content:p},null,8,["content"]),S(V,{content:e.value[u]||""},null,8,["content"])])):I("",!0)],64))),256)),c.value===d.value.length?(a(),_("div",qe,[f[2]||(f[2]=t("img",{src:ge,loading:"lazy"},null,-1)),t("div",{class:"text"},$(Oe)),o.sources.length?(a(),C(Q,{key:0,class:"w-100",sources:o.sources},null,8,["sources"])):I("",!0),o.references.length?(a(),C(Z,{key:1,class:"w-100",references:o.references},null,8,["references"])):I("",!0),S(V,{content:h()},null,8,["content"])])):I("",!0)])])],512)])}}}),Be=T(Ue,[["__scopeId","data-v-d8ba0868"]]),We={key:0,class:"video"},Fe={class:"content"},je=w({__name:"SectionCore",props:{courseId:{},chapterId:{},sectionId:{},onContentLoaded:{type:Function}},setup(r){const o=G(),m=O(),s=U(),i=r,v=L(),d=window.bootstrap,e=X({loaded:!1,title:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),c=b(()=>s.getSection(i.courseId,i.chapterId,i.sectionId)),h=b(()=>m.query.mode||"post"),g=()=>{const n=new DOMParser().parseFromString(e.content,"text/html");Array.from(n.querySelectorAll("[data-bs-toggle='popover']")).forEach((u,A)=>{u.setAttribute("title","출처"),u.setAttribute("data-bs-content",M.linkify(e.sources[A])),u.innerText=`[${A+1}]`}),e.content=n.body.innerHTML},y=n=>{n!=null&&n.closest(".popover")||document.querySelectorAll('[data-bs-toggle="popover"]').forEach(p=>{const u=d.Popover.getInstance(p);u&&u.dispose()})},N=n=>{n.getAttribute("data-bs-toggle")&&new d.Popover(n,{html:!0}).show()},l=n=>{N(n.target)},f=n=>{y(n.target)};return ne(async()=>{const n=s.getCourse(i.courseId);if(n){const p=s.getChapter(i.courseId,i.chapterId);if(p){const u=c.value;if(u){const{html:A}=await u.read();e.title=u.title,e.videoUrl=u.videoUrl,e.content=M.linkify(A),e.created=u.created,e.updated=u.updated,e.courseTitle=n.title,e.chapterTitle=p.title,e.sources=u.sources,e.references=u.references,g(),ce(()=>{e.loaded=!0,i.onContentLoaded()}),o.updateSiteTitle(e.title)}}}}),q(()=>{y(),document.addEventListener("click",l),document.addEventListener("mousedown",f)}),re(()=>{y()}),J(()=>{o.updateSiteTitle(),document.removeEventListener("click",l),document.removeEventListener("mousedown",f)}),(n,p)=>{const u=D("router-link");return a(),_("div",{class:E(["section-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:v},[h.value==="presentation"&&e.loaded?(a(),C(Be,{key:0,title:e.title,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","content","sources","references","created","updated"])):(a(),_(R,{key:1},[S(ee,{title:e.title,created:e.created,updated:e.updated,skeleton:!e.loaded},{default:x(()=>[S(u,{to:"?mode=presentation"},{default:x(()=>p[0]||(p[0]=[t("img",{src:ue,alt:"발표"},null,-1),t("div",null,"발표",-1)])),_:1})]),_:1},8,["title","created","updated","skeleton"]),e.videoUrl!==null?(a(),_("div",We,[S(fe,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):I("",!0),t("div",Fe,[S(Y,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])],64))],2)}}}),ze=T(je,[["__scopeId","data-v-cfb9b88f"]]),Ve="/assets/images/common.angle.left.svg",Ke="/assets/images/common.angle.right.svg",Je={class:"wrapper"},Ge={class:"title"},Xe={class:"title"},Ye=w({__name:"SectionNavigation",props:{courseId:{},chapterId:{},sectionId:{}},setup(r){const o=r,m=U(),s=H(()=>{var c;const d=[];return(((c=m.getCourse(o.courseId))==null?void 0:c.chapters)||[]).forEach(h=>{h.sections.forEach(g=>{d.push({id:g.id,title:g.title,url:`/courses/${o.courseId}/${h.id}/${g.id}`})})}),d}),i=H(()=>{let d=null;const e=s.value;for(let c=0;c<e.length;c++)e[c].id===o.sectionId&&(d=e[c-1]);return d}),v=H(()=>{let d=null;const e=s.value;for(let c=0;c<e.length;c++)e[c].id===o.sectionId&&(d=e[c+1]);return d});return(d,e)=>{const c=D("router-link");return a(),_("div",{class:E(["section-navigation",{both:k(i)&&k(v)}])},[t("div",Je,[k(i)?(a(),C(c,{key:0,to:k(i).url||"",class:"item prev",title:k(i).title},{default:x(()=>[e[0]||(e[0]=t("div",{class:"label"},[t("img",{src:Ve,alt:"이전"}),t("span",null,"이전")],-1)),t("div",Ge,$(k(i).title),1)]),_:1},8,["to","title"])):I("",!0),k(v)?(a(),C(c,{key:1,to:k(v).url,class:"item next",title:k(v).title},{default:x(()=>[e[1]||(e[1]=t("div",{class:"label"},[t("img",{src:Ke,alt:"다음"}),t("span",null,"다음")],-1)),t("div",Xe,$(k(v).title),1)]),_:1},8,["to","title"])):I("",!0)])],2)}}}),Qe=T(Ye,[["__scopeId","data-v-40bf161a"]]),Ze={class:"section"},et={class:"container"},tt={class:"wrapper"},ot={class:"main"},st={key:0,class:"sources"},nt={key:1,class:"references"},rt={class:"navigation"},ct=w({__name:"Section",setup(r){const o=G(),m=ae(),s=U(),i=O(),v=L(),d=L(),e=L(),c=X({contentLoaded:!1}),h=b(()=>{var p;return(p=i.params.courseId)==null?void 0:p.toString()}),g=b(()=>{var p;return(p=i.params.chapterId)==null?void 0:p.toString()}),y=b(()=>{var p;return(p=i.params.sectionId)==null?void 0:p.toString()}),N=b(()=>s.getCourse(h.value)),l=b(()=>s.getSection(h.value,g.value,y.value)),f=p=>{var u;o.windowSize.width<=1399||e.value&&e.value.scrollTo({top:p-e.value.offsetTop-(((u=d.value)==null?void 0:u.offsetHeight)||0),behavior:"smooth"})},n=()=>{c.contentLoaded=!0};return(p,u)=>{var B,W,F,j;const A=D("router-link");return a(),_("div",Ze,[t("div",et,[t("div",tt,[t("div",ot,[t("div",{class:"core",ref_key:"coreRef",ref:v},[(a(),C(ze,{courseId:h.value,chapterId:g.value,sectionId:y.value,key:y.value,onContentLoaded:n},null,8,["courseId","chapterId","sectionId"]))],512),(W=(B=l.value)==null?void 0:B.sources)!=null&&W.length?(a(),_("div",st,[S(Q,{sources:l.value.sources},null,8,["sources"])])):I("",!0),(j=(F=l.value)==null?void 0:F.references)!=null&&j.length?(a(),_("div",nt,[S(Z,{references:l.value.references},null,8,["references"])])):I("",!0),t("div",rt,[S(Qe,{courseId:h.value,chapterId:g.value,sectionId:y.value},null,8,["courseId","chapterId","sectionId"])])]),c.contentLoaded?(a(),_("div",{key:0,class:"chapters",ref_key:"chaptersRef",ref:e,style:le({height:k(m).mainHeight})},[t("div",{class:"top",ref_key:"chaptersTopRef",ref:d},[S(A,{to:`/courses/${h.value}`,class:"btn"},{default:x(()=>{var z;return[u[0]||(u[0]=t("img",{src:de},null,-1)),t("span",null,$((z=N.value)==null?void 0:z.title),1)]}),_:1},8,["to"])],512),S(ie,{courseId:h.value,chapterId:g.value,sectionId:y.value,theme:"light",onScrollable:f},null,8,["courseId","chapterId","sectionId"])],4)):I("",!0)])])])}}}),ut=T(ct,[["__scopeId","data-v-df1f0cf0"]]);export{ut as default};
