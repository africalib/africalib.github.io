import{d as x,i as W,q as C,s as B,v as h,n as q,l as j,c as _,x as O,g as T,u as l,j as z,F as G,e as v,m as I,b as n,y as J,o as i,_ as w,z as b,w as A,f as F,t as $,A as K,B as Q}from"./index-DzEKIjhu.js";import{c as U}from"./commonLib-DZoi0k1s.js";import{u as E}from"./useSection-taQ2TSXh.js";import{D as X,a as Y,b as Z,c as ee,C as te,d as oe}from"./DocumentHeader-D0GPO_Jf.js";import{C as se}from"./Chapters-R1Rc4mzT.js";import"./courses-B8h4dfEd.js";const ne="/assets/images/common.home.white.svg",ce={key:0,class:"video"},re={class:"content"},ae=x({__name:"SectionCore",props:{courseId:{},chapterId:{},sectionId:{},onContentLoaded:{type:Function}},setup(k){const u=W(),g=z(),p=E(),c=k,m=C(),e=B({loaded:!1,title:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),t=h(()=>p.getSection(c.courseId,c.chapterId,c.sectionId)),o=()=>{const r=new DOMParser().parseFromString(e.content,"text/html");Array.from(r.querySelectorAll("[data-bs-toggle='popover']")).forEach((s,f)=>{s.setAttribute("title","출처"),s.setAttribute("data-bs-content",U.linkify(e.sources[f])),s.innerText=`[${f+1}]`}),e.content=r.body.innerHTML};return q(async()=>{const r=p.getCourse(c.courseId);if(r){const a=p.getChapter(c.courseId,c.chapterId);if(a){const s=t.value;if(s){const{html:f}=await s.read();e.title=s.title,e.videoUrl=s.videoUrl,e.content=U.linkify(f),e.created=s.created,e.updated=s.updated,e.courseTitle=r.title,e.chapterTitle=a.title,e.sources=s.sources,e.references=s.references,o(),J(()=>{e.loaded=!0,c.onContentLoaded()}),u.updateSiteTitle(e.title)}}}}),j(()=>{u.updateSiteTitle()}),(r,a)=>(i(),_("div",{class:O(["section-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:m},[l(g).query.mode==="presentation"&&e.loaded?(i(),T(X,{key:0,title:e.title,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","content","sources","references","created","updated"])):(i(),_(G,{key:1},[v(Y,{title:e.title,created:e.created,updated:e.updated,skeleton:!e.loaded},null,8,["title","created","updated","skeleton"]),e.videoUrl?(i(),_("div",ce,[v(Z,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):I("",!0),n("div",re,[v(ee,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])],64))],2))}}),le=w(ae,[["__scopeId","data-v-00dc69e7"]]),ie="/assets/images/common.angle.left.svg",de="/assets/images/common.angle.right.svg",ue={class:"wrapper"},pe={class:"title"},me={class:"title"},ve=x({__name:"SectionNavigation",props:{courseId:{},chapterId:{},sectionId:{}},setup(k){const u=k,g=E(),p=b(()=>{var o;const e=[];return(((o=g.getCourse(u.courseId))==null?void 0:o.chapters)||[]).forEach(r=>{r.sections.forEach(a=>{e.push({id:a.id,title:a.title,url:`/courses/${u.courseId}/${r.id}/${a.id}`})})}),e}),c=b(()=>{let e=null;const t=p.value;for(let o=0;o<t.length;o++)t[o].id===u.sectionId&&(e=t[o-1]);return e}),m=b(()=>{let e=null;const t=p.value;for(let o=0;o<t.length;o++)t[o].id===u.sectionId&&(e=t[o+1]);return e});return(e,t)=>{const o=F("router-link");return i(),_("div",{class:O(["section-navigation",{both:l(c)&&l(m)}])},[n("div",ue,[l(c)?(i(),T(o,{key:0,to:l(c).url||"",class:"item prev",title:l(c).title},{default:A(()=>[t[0]||(t[0]=n("div",{class:"label"},[n("img",{src:ie,alt:"이전"}),n("span",null,"이전")],-1)),n("div",pe,$(l(c).title),1)]),_:1},8,["to","title"])):I("",!0),l(m)?(i(),T(o,{key:1,to:l(m).url,class:"item next",title:l(m).title},{default:A(()=>[t[1]||(t[1]=n("div",{class:"label"},[n("img",{src:de,alt:"다음"}),n("span",null,"다음")],-1)),n("div",me,$(l(m).title),1)]),_:1},8,["to","title"])):I("",!0)])],2)}}}),_e=w(ve,[["__scopeId","data-v-40bf161a"]]),fe={class:"section"},he={class:"container"},Ie={class:"wrapper"},ge={class:"main"},Se={key:0,class:"sources"},ke={key:1,class:"references"},ye={class:"navigation"},Ce=x({__name:"Section",setup(k){const u=W(),g=K(),p=E(),c=z(),m=C(),e=C(),t=C(),o=B({contentLoaded:!1}),r=h(()=>{var d;return(d=c.params.courseId)==null?void 0:d.toString()}),a=h(()=>{var d;return(d=c.params.chapterId)==null?void 0:d.toString()}),s=h(()=>{var d;return(d=c.params.sectionId)==null?void 0:d.toString()}),f=h(()=>p.getCourse(r.value)),y=h(()=>p.getSection(r.value,a.value,s.value)),H=d=>{var S;u.windowSize.width<=1399||t.value&&t.value.scrollTo({top:d-t.value.offsetTop-(((S=e.value)==null?void 0:S.offsetHeight)||0),behavior:"smooth"})},P=()=>{o.contentLoaded=!0};return(d,S)=>{var L,M,N,R;const V=F("router-link");return i(),_("div",fe,[n("div",he,[n("div",Ie,[n("div",ge,[n("div",{class:"core",ref_key:"coreRef",ref:m},[(i(),T(le,{courseId:r.value,chapterId:a.value,sectionId:s.value,key:s.value,onContentLoaded:P},null,8,["courseId","chapterId","sectionId"]))],512),(M=(L=y.value)==null?void 0:L.sources)!=null&&M.length?(i(),_("div",Se,[v(te,{sources:y.value.sources},null,8,["sources"])])):I("",!0),(R=(N=y.value)==null?void 0:N.references)!=null&&R.length?(i(),_("div",ke,[v(oe,{references:y.value.references},null,8,["references"])])):I("",!0),n("div",ye,[v(_e,{courseId:r.value,chapterId:a.value,sectionId:s.value},null,8,["courseId","chapterId","sectionId"])])]),o.contentLoaded?(i(),_("div",{key:0,class:"chapters",ref_key:"chaptersRef",ref:t,style:Q({height:l(g).mainHeight})},[n("div",{class:"top",ref_key:"chaptersTopRef",ref:e},[v(V,{to:`/courses/${r.value}`,class:"btn"},{default:A(()=>{var D;return[S[0]||(S[0]=n("img",{src:ne},null,-1)),n("span",null,$((D=f.value)==null?void 0:D.title),1)]}),_:1},8,["to"])],512),v(se,{courseId:r.value,chapterId:a.value,sectionId:s.value,theme:"light",onScrollable:H},null,8,["courseId","chapterId","sectionId"])],4)):I("",!0)])])])}}}),Ee=w(Ce,[["__scopeId","data-v-3cad4800"]]);export{Ee as default};
