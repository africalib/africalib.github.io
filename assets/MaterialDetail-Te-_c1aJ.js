import{d as T,g as y,c as o,b as s,F as S,r as P,t as q,u as g,o as n,_ as E,n as R,i as U,h as N,j as X,k as I,f as $,l as M,T as oe,m as Z,p as j,q as re,s as Y,v as ee,w as le,x as ie,y as ce,z as F,A as ue,B,C as H,D as K,E as te}from"./index-Cmu8zeTT.js";import{u as z,M as J}from"./material--0tvTVu7.js";import{c as x}from"./commonLib-Co9BQnS0.js";import{C as de}from"./CryptoHelper-m6j8gmxG.js";import{_ as me,a as pe,b as _e}from"./common.arrow.left-TSorRx6s.js";import{r as ve}from"./routeLib-DhAZaWiT.js";import{A as he}from"./Above-DspHttgq.js";import"./Panel-BXLZv4O6.js";const fe={class:"common-sources"},ge={class:"items"},ye=["innerHTML"],ke=T({__name:"MaterialSources",props:{sources:{}},setup(h){const t=h,i=y(()=>{const p=new Map;return t.sources.forEach((r,c)=>{p.has(r)||p.set(r,[]),p.get(r).push(c+1)}),Array.from(p.entries()).map(([r,c])=>({indexes:c,src:r}))});return(p,r)=>(n(),o("div",fe,[r[1]||(r[1]=s("div",{class:"subject"},"자료 출처",-1)),s("div",ge,[(n(!0),o(S,null,P(i.value,c=>(n(),o("div",{class:"item",key:c.src},[(n(!0),o(S,null,P(c.indexes,v=>(n(),o("span",null,"["+q(v)+"]",1))),256)),r[0]||(r[0]=s("span",null," ",-1)),s("span",{innerHTML:g(x).linkify(c.src)},null,8,ye)]))),128))])]))}}),se=E(ke,[["__scopeId","data-v-a34ac84b"]]),$e={class:"common-references"},be={class:"items"},we={class:"item"},xe=T({__name:"MaterialReferences",props:{references:{}},setup(h){const t=h;return(i,p)=>(n(),o("div",$e,[p[0]||(p[0]=s("div",{class:"subject"},"참고 자료",-1)),s("div",be,[(n(!0),o(S,null,P(t.references,r=>(n(),o("div",we,[s("span",null,q(r),1)]))),256))])]))}}),ne=E(xe,[["__scopeId","data-v-64c8b31c"]]),Me={key:0},Te=["innerHTML"],Le=T({__name:"DocumentContent",props:{document:{},loading:{type:Boolean}},setup(h){const t=h;return(i,p)=>(n(),o("div",{class:R(["document-content",{skeleton:t.loading}])},[i.loading?(n(),o("div",Me)):(n(),o("div",{key:1,innerHTML:t.document,ref:"contentRef"},null,8,Te))],2))}}),ae=E(Le,[["__scopeId","data-v-53b0c110"]]),Se="/assets/images/component.document.presentation.slide.first.svg",Ee="/assets/images/component.material.presentation.finish.svg",O=T({__name:"DocumentPrompt",props:{content:{}},setup(h){const t=h;return U(()=>{console.info(t.content.replace(/\n{3,}/g,`

`))}),(i,p)=>null}}),Ae={class:"slides"},Ce={key:0,class:"slide start"},De={class:"container"},Ie={class:"slide-item"},qe=["innerHTML"],He={key:1,class:"slide finish"},Pe={class:"container"},Re={key:0,class:"slide"},Ne={class:"container"},Q="no-overflow",je=T({__name:"MaterialPresentation",props:{material:{},document:{},loading:{type:Boolean}},setup(h){const t={touchStartX:0,touchStartY:0},i=h,p=N(),r=Z(),c=`이렇게 해서 ${x.extractText(i.material.title)}에 대해 알아봤습니다. 수고하셨습니다!`,v=y(()=>i.material.title.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>")),a=y(()=>{const d=[i.material.desc];return l.value.length===0&&e.value.length===1&&d.push(e.value[0]),d.join("")}),l=y(()=>{const d=new DOMParser().parseFromString(i.document,"text/html");return Array.from(d.querySelectorAll(".slide-item")).map(m=>m.outerHTML)}),e=y(()=>{const d=[],m={},w=new DOMParser().parseFromString(i.document,"text/html");Array.from(w.querySelectorAll(".slide-text")).forEach(L=>{const D=L.getAttribute("data-slide-text-group");D&&(!m[D]&&(m[D]=[]),m[D].push(x.replaceAll(L.outerText,"  ","").trim()))});for(let L in m)d.push(m[L].join(`
`));return d}),u=y(()=>{var d;return window.Number.parseInt(((d=p.query.idx)==null?void 0:d.toString())||"0")}),f=y(()=>l.value.length+1),b=d=>{const m=x.renew(p.query);let w=u.value+d;w<0?w=0:w>f.value&&(w=f.value),u.value!==w&&(m.idx=w.toString(),r.push({query:m}))},_=(d,m)=>{switch(d){case"ArrowLeft":!m&&b(-1);break;case"ArrowRight":!m&&b(1);break;case"F9":case"Escape":!m&&r.push({query:void 0});break}},k=d=>{_(d.key,d.altKey)},A=d=>{const m=d.touches[0];t.touchStartX=m.clientX,t.touchStartY=m.clientY},C=d=>{const m=d.changedTouches[0],w=m.clientX,G=m.clientY,L=w-t.touchStartX,D=G-t.touchStartY;Math.abs(L)>Math.abs(D)&&Math.abs(L)>50&&(L>0?b(-1):b(1))},V=d=>{d.data.type==="keyup"&&_(d.data.key,d.data.altKey)};return U(()=>{document.addEventListener("keyup",k),document.addEventListener("touchstart",A),document.addEventListener("touchend",C),window.addEventListener("message",V),document.body.classList.add(Q)}),X(()=>{document.removeEventListener("keyup",k),document.removeEventListener("touchstart",A),document.removeEventListener("touchend",C),window.removeEventListener("message",V),document.body.classList.remove(Q)}),(d,m)=>(n(),I(oe,{to:"body"},[s("div",{class:R(["presentation",{skeleton:i.loading}])},[s("div",Ae,[u.value===0?(n(),o("div",Ce,[s("div",De,[s("figure",Ie,[m[0]||(m[0]=s("img",{src:Se,alt:"코딩",loading:"lazy"},null,-1)),s("figcaption",null,[s("span",{innerHTML:v.value},null,8,qe),$(O,{content:a.value},null,8,["content"])])])])])):l.value.length&&u.value===f.value?(n(),o("div",He,[s("div",Pe,[m[1]||(m[1]=s("figure",{class:"slide-item"},[s("img",{src:Ee,alt:"하이파이브",class:"mh-400",loading:"lazy"}),s("figcaption",null,[s("b",null,"이상 끝. "),s("span",null,"수고하셨습니다!")])],-1)),i.material.sources.length?(n(),I(se,{key:0,class:"w-100 mb-3",sources:i.material.sources},null,8,["sources"])):M("",!0),i.material.references.length?(n(),I(ne,{key:1,class:"w-100",references:i.material.references},null,8,["references"])):M("",!0),$(O,{content:c})])])):(n(!0),o(S,{key:2},P(l.value.length,w=>(n(),o(S,null,[u.value===w?(n(),o("div",Re,[s("div",Ne,[$(ae,{document:l.value[w-1]},null,8,["document"]),$(O,{content:e.value[w-1]||""},null,8,["content"])])])):M("",!0)],64))),256))])],2)]))}}),Fe=E(je,[["__scopeId","data-v-47b3d26e"]]);function Be(){const h=j(null),t=j(null),i=j(!1);return{data:h,error:t,loading:i,request:async({url:r,method:c="GET",body:v,contentType:a="application/json",...l})=>{i.value=!0,t.value=null;try{const e={"Content-Type":a,...l.headers||{}},u={method:c,headers:e,...l};v&&(u.body=a==="application/json"?JSON.stringify(v):v);const f=await fetch(r,u);if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);const b=f.headers.get("Content-Type");return b!=null&&b.includes("application/json")?h.value=await f.json():h.value=await f.text(),h.value}catch(e){throw t.value=e.message||"Unknown error",e}finally{i.value=!1}}}}const Oe={key:0,class:"presentation"},Ue={key:1,class:"content"},Xe={key:1,class:"empty"},Ye=T({__name:"MaterialCore",props:{material:{},onDocumentLoaded:{type:Function}},setup(h){const t=N(),i=re();Y();const p=z(t),{data:r,loading:c,request:v}=Be(),a=h,l=ee({document:"<p>PLEASE WAIT A MOMENT</p>"}),e=()=>{if(!a.material.sources.length)return;const f=new DOMParser().parseFromString(l.document,"text/html");Array.from(f.querySelectorAll("[data-bs-toggle='popover']")).forEach((_,k)=>{if(!a.material.sources[k]){console.error("본문 속 팝오버의 개수와 출처 배열의 개수가 다릅니다.");return}_.setAttribute("title","자료 출처"),_.setAttribute("data-bs-content",x.linkify(a.material.sources[k])),_.innerText=`[${k+1}]`}),l.document=f.body.innerHTML},u=async()=>{if(a.material){const f=p.getUrlPath(a.material);await v({url:`/assets${f}/document.html?${Date.now()}`,contentType:"text/html"});const b=ce.get(F.unlockPasswordCookieName),_=window.location.hostname==="localhost";if(a.material.locked&&b&&!_){const k=new de(b,F.salt,F.iv);r.value=await k.decrypt(r.value).catch(A=>(console.error({err:A,message:"문서를 복호화 할 수 없습니다."}),null))}l.document=x.linkify(r.value),e()}ue(()=>{a.onDocumentLoaded()}),i.updateSiteTitle(x.extractText(a.material.title))};return le(()=>{u()}),X(()=>{i.updateSiteTitle()}),ie(()=>t.path,()=>{u()}),(f,b)=>(n(),o("div",{class:R(["material-core",{skeleton:g(c)}])},[g(t).query.mode==="presentation"?(n(),o("div",Oe,[$(Fe,{material:a.material,document:l.document,loading:g(c)},null,8,["material","document","loading"])])):(n(),o("div",Ue,[l.document?(n(),I(ae,{key:0,document:l.document,loading:g(c)},null,8,["document","loading"])):(n(),o("div",Xe,"이 문서에는 내용이 없습니다."))]))],2))}}),Ke=E(Ye,[["__scopeId","data-v-ae3cb381"]]),ze={class:"wrapper"},Ve={class:"title"},Ge={class:"title"},Je=T({__name:"MaterialNavigation",props:{material:{}},setup(h){const t=h,i=N();Y(),z(i);const p=B(()=>{var a,l;const v=[];if((l=(a=t.material)==null?void 0:a.parent)!=null&&l.children){const e=ve.getTag(i);t.material.parent.children.forEach(u=>{(!e||u.tags.includes(e))&&v.push(u)})}return v}),r=B(()=>{var l;let v=null;const a=p.value;for(let e=0;e<a.length;e++)if(a[e].id===((l=t.material)==null?void 0:l.id)&&a[e-1]){v=a[e-1];break}return v}),c=B(()=>{var l;let v=null;const a=p.value;for(let e=0;e<a.length;e++)if(a[e].id===((l=t.material)==null?void 0:l.id)&&a[e+1]){v=a[e+1];break}return v});return(v,a)=>{const l=K("router-link");return n(),o("div",{class:R(["material-navigation",{both:g(r)&&g(c)}])},[s("div",ze,[g(r)?(n(),I(l,{key:0,to:g(r).url||"",class:"item prev",title:g(r).title},{default:H(()=>[a[0]||(a[0]=s("div",{class:"label"},[s("img",{src:me,alt:"이전"}),s("span",null,"이전")],-1)),s("div",Ve,q(g(x).extractText(g(r).title)),1)]),_:1},8,["to","title"])):M("",!0),g(c)?(n(),I(l,{key:1,to:g(c).url,class:"item next",title:g(c).title},{default:H(()=>[a[1]||(a[1]=s("div",{class:"label"},[s("img",{src:pe,alt:"다음"}),s("span",null,"다음")],-1)),s("div",Ge,q(g(x).extractText(g(c).title)),1)]),_:1},8,["to","title"])):M("",!0)])],2)}}}),Qe=E(Je,[["__scopeId","data-v-edc97d56"]]),We={class:"material-above"},Ze={class:"back"},et={class:"wrapper"},tt={class:"dates"},st=["title"],W="?mode=presentation",nt=T({__name:"MaterialAbove",props:{material:{}},setup(h){const t=h,i=Z(),p=(e,u)=>{e==="F9"&&!u&&i.push(W)},r=e=>{p(e.key,e.altKey)},c=y(()=>{const e={title:"강의 자료",url:"/materials"};return t.material.parent&&(e.title=t.material.parent.title,e.url=t.material.parent.url),e}),v=y(()=>t.material.created?t.material.updated?x.getHumanReadableDate(t.material.updated)+" 업데이트됨":x.getHumanReadableDate(t.material.created)+" 생성됨":"(N/A)"),a=y(()=>{if(t.material.created){const e=[`생성: ${t.material.created}`];return t.material.updated&&e.push(`업데이트: ${t.material.created}`),e.join(" | ")}}),l=e=>{e.data.type==="keyup"&&p(e.data.key,e.data.altKey)};return U(()=>{document.addEventListener("keyup",r),window.addEventListener("message",l)}),X(()=>{document.removeEventListener("keyup",r),window.removeEventListener("message",l)}),(e,u)=>{const f=K("router-link");return n(),o("div",We,[s("div",Ze,[$(f,{to:c.value.url},{default:H(()=>[u[0]||(u[0]=s("img",{src:_e,alt:"뒤로가기",title:"뒤로가기"},null,-1)),s("span",null,q(c.value.title),1)]),_:1},8,["to"])]),s("div",et,[s("div",tt,[s("span",{title:a.value},q(v.value),9,st),t.material.presentation?(n(),o(S,{key:0},[u[2]||(u[2]=s("span",{class:"bar"},null,-1)),$(f,{to:W},{default:H(()=>u[1]||(u[1]=[te("발표(F9)")])),_:1})],64)):M("",!0)]),$(he,{title:g(x).extractText(t.material.title),desc:t.material.desc},null,8,["title","desc"])])])}}}),at=E(nt,[["__scopeId","data-v-fc9f20d5"]]),ot={class:"material"},rt={class:"container"},lt={class:"above",ref:"aboveRef"},it={key:0,class:"list"},ct={key:1,class:"detail"},ut={class:"main",ref:"mainRef"},dt={class:"core",ref:"coreRef"},mt={key:0,class:"sources"},pt={key:1,class:"references"},_t={key:1,class:"empty"},vt={key:2,class:"login"},ht={class:"navigation"},ft={key:0,class:"materials",ref:"materialsRef"},gt={key:1,class:"empty"},yt=T({__name:"MaterialDetail",setup(h){const t=N(),i=Y(),p=z(t),r=ee({contentLoaded:!1}),c=y(()=>{var _;return!((_=e.value)!=null&&_.locked)||i.admin}),v=y(()=>{var _;return(_=t.params.id1)==null?void 0:_.toString()}),a=y(()=>{var _;return(_=t.params.id2)==null?void 0:_.toString()}),l=y(()=>{var _;return(_=t.params.id3)==null?void 0:_.toString()}),e=y(()=>p.get(v.value,a.value,l.value)),u=y(()=>{var _,k;return((k=(_=e.value)==null?void 0:_.parent)==null?void 0:k.children)||[]}),f=y(()=>{if(t.query.tag)return window.decodeURIComponent(t.query.tag.toString())}),b=()=>{r.contentLoaded=!0};return(_,k)=>{var C;const A=K("router-link");return n(),o("div",ot,[s("div",rt,[e.value?(n(),o(S,{key:0},[s("div",lt,[$(at,{material:e.value},null,8,["material"])],512),e.value.children.length?(n(),o("div",it,[$(J,{materials:e.value.children,tag:f.value},null,8,["materials","tag"])])):(n(),o("div",ct,[s("div",ut,[c.value?(n(),o(S,{key:0},[s("div",dt,[$(Ke,{material:e.value,onDocumentLoaded:b},null,8,["material"])],512),e.value.sources.length?(n(),o("div",mt,[$(se,{sources:e.value.sources},null,8,["sources"])])):M("",!0),(C=e.value.references)!=null&&C.length?(n(),o("div",pt,[$(ne,{references:e.value.references},null,8,["references"])])):M("",!0)],64)):e.value.children.length?(n(),o("div",vt,[$(A,{to:g(i).getLoginUrl(g(t),!0)},{default:H(()=>k[0]||(k[0]=[te("로그인")])),_:1},8,["to"]),k[1]||(k[1]=s("span",null,"이 필요합니다.",-1))])):(n(),o("div",_t," 세부 강의가 없습니다. ")),s("div",ht,[$(Qe,{material:e.value},null,8,["material"])])],512),r.contentLoaded&&u.value.length?(n(),o("div",ft,[$(J,{materials:u.value},null,8,["materials"])],512)):M("",!0)]))],64)):(n(),o("div",gt,"접근 가능한 데이터가 없습니다."))])])}}}),St=E(yt,[["__scopeId","data-v-21a6c093"]]);export{St as default};
