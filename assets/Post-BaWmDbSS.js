import{d as g,i as P,q as y,s as L,n as N,l as $,c as n,x,g as M,u as I,j as E,F as D,e as a,m as l,y as U,o as s,_ as R,A as W,v as b,b as f,B}from"./index-CO7PN3lc.js";import{c as C}from"./commonLib-DZoi0k1s.js";import{D as O,a as F,b as V,c as q,C as z,d as H}from"./DocumentHeader-CVTsZOLE.js";import{p as w,P as j}from"./Posts-DNbV2KTB.js";const G={key:0,class:"video"},J={key:1,class:"content"},K=g({__name:"PostCore",props:{id:{},onContentLoaded:{type:Function}},setup(k){const i=P(),m=E(),u=k,_=y(),e=L({loaded:!1,title:"WAIT A MOMENT",videoUrl:null,content:"<p>PLEASE WAIT A MOMENT</p>",presentation:!1,created:"WAIT A MOMENT",updated:"WAIT A MOMENT",courseTitle:"WAIT",chapterTitle:"WAIT",sources:[],references:[]}),p=()=>{const t=new DOMParser().parseFromString(e.content,"text/html");Array.from(t.querySelectorAll("[data-bs-toggle='popover']")).forEach((c,d)=>{if(!e.sources[d]){console.warn("마크다운 파일에 입력한 출처와 차이가 있습니다.");return}c.setAttribute("title","출처"),c.setAttribute("data-bs-content",C.linkify(e.sources[d])),c.innerText=`[${d+1}]`}),e.content=t.body.innerHTML};return N(async()=>{const t=w.find(o=>o.id===u.id);if(t){const{html:o}=await t.read();e.title=t.title,e.videoUrl=t.videoUrl,e.content=C.linkify(o),e.presentation=t.presentation,e.created=t.created,e.updated=t.updated,e.sources=t.sources,e.references=t.references,p(),U(()=>{e.loaded=!0,u.onContentLoaded()}),i.updateSiteTitle(e.title)}}),$(()=>{i.updateSiteTitle()}),(t,o)=>(s(),n("div",{class:x(["post-core",{skeleton:!e.loaded}]),ref_key:"rootRef",ref:_},[I(m).query.mode==="presentation"&&e.loaded?(s(),M(O,{key:0,title:e.title,content:e.content,sources:e.sources,references:e.references,created:e.created,updated:e.updated},null,8,["title","content","sources","references","created","updated"])):(s(),n(D,{key:1},[a(F,{title:e.title,presentation:e.presentation,created:e.created,updated:e.updated,skeleton:!e.loaded},null,8,["title","presentation","created","updated","skeleton"]),e.videoUrl?(s(),n("div",G,[a(V,{url:e.videoUrl,skeleton:!e.loaded},null,8,["url","skeleton"])])):l("",!0),e.content?(s(),n("div",J,[a(q,{content:e.content,skeleton:!e.loaded},null,8,["content","skeleton"])])):l("",!0)],64))],2))}}),Q=R(K,[["__scopeId","data-v-c2a45aa2"]]),X={class:"post"},Y={class:"container"},Z={class:"wrapper"},ee={class:"main"},te={key:0,class:"sources"},oe={key:1,class:"references"},se=g({__name:"Post",setup(k){const i=P(),m=W(),u=E(),_=y(),e=y(),p=L({contentLoaded:!1}),t=b(()=>{var r;return((r=u.params.id)==null?void 0:r.toString())??""}),o=b(()=>w.find(r=>r.id===t.value)),c=()=>{p.contentLoaded=!0},d=r=>{var v;i.windowSize.width<=1399||(v=e.value)==null||v.scrollTo({top:r-1,behavior:"smooth"})};return(r,v)=>{var h,T,S,A;return s(),n("div",X,[f("div",Y,[f("div",Z,[f("div",ee,[f("div",{class:"core",ref_key:"coreRef",ref:_},[(s(),M(Q,{id:t.value,key:t.value,onContentLoaded:c},null,8,["id"]))],512),(T=(h=o.value)==null?void 0:h.sources)!=null&&T.length?(s(),n("div",te,[a(z,{sources:o.value.sources},null,8,["sources"])])):l("",!0),(A=(S=o.value)==null?void 0:S.references)!=null&&A.length?(s(),n("div",oe,[a(H,{references:o.value.references},null,8,["references"])])):l("",!0)]),p.contentLoaded?(s(),n("div",{key:0,class:"posts",ref_key:"postsRef",ref:e,style:B({height:I(m).mainHeight})},[a(j,{id:t.value,onScrollable:d},null,8,["id"])],4)):l("",!0)])])])}}}),de=R(se,[["__scopeId","data-v-55a4327b"]]);export{de as default};
